<!DOCTYPE html>
<meta charset="utf-8">
<link rel='shortcut icon' type='image/ico' href='favicon.ico'>

<title>The Wheel Maker &amp; Spoke Length Calculator</title>

<!--//========================================-->
<script>var VERSION = "v2.28 2019-06-22"</script>
<!--//========================================-->

<template id=SC2_LICENSE>
Copyright Â© 2017-2018 https://github.com/Self-Evident

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</template>



<style>
* { margin: 0; padding: 0; box-sizing: border-box; font-family: arial; }
body { overflow-y: scroll; }


/*** The prefix "SC2_" simply means "Spoke Calculator 2" ***/

ul.SC2 { padding-left: 1rem; }

p.SC2 { margin: .4rem 0; }

pre { font-family: courier; text-align: left; }

.SC2_indents { margin-left: 1.5rem; }

hr.SC2 {margin: .5rem 0; }
.SC2_hr2 {margin: .4rem 1rem;; }

a.SC2 { outline: 0; text-decoration: none; display: inline-block; background-color: #EEE; border: solid 1px white; }

a.SC2:focus, a.SC2:hover { background-color: #ccc; text-decoration: none; }

button.SC2 {
	border: solid 1px #444;
	padding: 0px 5px 1px 4px;
	background:
	linear-gradient(to bottom, #CCC, #FFF, #FFF, #CCC);
	border-radius: 4px;
	height: 22px; 	
}
p.SC2 > button.SC2, div.SC2 > button.SC2 { padding: 1px 5px 1px 4px; }

button.SC2:focus  { background: linear-gradient(to bottom, #CCC, #FFF, #FFF, #CCC); }
button.SC2:hover  { background: linear-gradient(to bottom, #eee, #FFF, #FFF, #eee); }
button.SC2:active { background: linear-gradient(to bottom, #EEE, #ddd, #ddd, #EEE); padding: 0px 6px 1px 3px; }

button.SC2::-moz-focus-inner { border: 0 }

.SC2_reset_button { font-size: .8rem; float: right; margin: 0 0 .0 -2rem; }

button.SC2_ndo_buttons {
	display: inline-block;
	min-width: 11rem;
	width: 100%;
	height: 2rem;
	margin: 1rem auto .1rem auto;
	padding: 3px .5rem;
	text-align: center;
	font: normal 1.2rem arial;
	border-radius: 8px;
}

input.SC2:focus, select.SC2:focus, button.SC2:focus { box-shadow: 0 0 3pt 1pt #006060 }
input[type=text].SC2   { width: 3.3rem; text-align: center; font: 1rem courier; }

input[type=checkbox]:hover { box-shadow: 0 0 0pt 1pt black; }

select.SC2:hover { border-color: black; }

input[readonly].SC2 {
	border: solid .05rem #077;
	border-radius: 4px;
	background-color: rgba(255,255,255, .8);
	
}

input[disabled].SC2, select.SC2:disabled {
	color			: #555;
	background-color: rgba(255,255,255, .4);
	border: solid 1px #7a7a7a;
}

select.SC2 {
	display: inline-block;
	vertical-align: middle;
	padding: 0 0 0 .3rem;
	width: 3.3rem;
	font-size: .9rem;
	height: 1.4rem;
	border: solid 1px #7a7a7a;
}
select.SC2 option { padding-left: .5rem }


/* Removes that annoying dotted onfocus outline of FF selects */
select.SC2:-moz-focusring {
	color: transparent;
	text-shadow: 0 0 0 #000;
}



#SC2_disable_page {
    position: fixed;
    z-index: 998;
    background: #EEE;
    display: none;
    opacity: .3;
    width: 100%;
    height: 100%;
}


#SC2_CONTAINER {
	position: relative;
	border: 0;
	margin: auto;
	text-align: left;
	padding: 1rem 0 0 0;
	visibility: hidden;  /* visibility & opacity changed at end of onload. */
	display: block;
	width: 930px;
}


button.SC2_X_imex_windows {
	height	: 1.5rem;
	width	: 1.5rem;
	float   : right;
	margin  : -.4rem -.35rem 0 0;
	padding	: 0;
	font    : normal .9rem arial;
	text-align	: center;
	border        : solid 1px #444;
	border-radius : 4px;
	background-color: #F9F9F9;
}

.SC2_imex_containers {
	position: absolute;
	top: 2.5rem;
	border: solid 1px teal;
	box-shadow: 0 0 10pt 4pt teal;
	background-color: white;
	display: none;
	margin: 0 0 0 1rem;
	padding: .5rem;
	min-width: 200px;
	max-width: 700px;
	text-align: left;
	z-index : 998;
	font-family: arial;
	border-radius: 4px;
}

.SC2_imex_btns { font-size: 1rem; padding: .2rem 1rem; border-radius: 6px; margin: .5rem 0 0 1rem; }

.SC2_IMEX_DATA { border: solid 1px black; padding: .3rem; margin-top: .5rem; font-family: courier; word-break: break-all;}

#SC2_EXPORT_OUTPUT { }

#SC2_IMPORT_INPUT  {
	width: 100%;
	height: 107px;  /* The 107 should match the new_height minimum value in $IMPORT_INPUT.addEventListener.  */
	resize: none;
	overflow: hidden; /* Not really, its vertical size is adjusted to fit its content on input, by Auto_Size_Input(). */
}	                  /* But, if overflow is not set to hidden or scroll, extra space can end up at the bottom of the */
                      /* input.  The extra space doesn't seem to affect functionality, I just don't like it. */


#SC2_import_index_label { display: inline-block; margin: 0 0 0 1rem; padding: 0; border:0; }

.SC2_disabled { color: #777; }

#SC2_IMPORT_INDEX:disabled { border: solid 1px #ccc; color: #ccc; }

#SC2_WHEEL_TYPE { margin: 0 0 .3rem .2rem; padding-left: .1rem; width: 11rem; }

#SC1_flange_to_opts { text-align: right }

button.SC2_mini_button { width: 16px; padding: 0 0 0 0; line-height: 1rem; }

#SC2_FL_to_LN { background-color: rgba(255,255,255,.4); }

.SC2_theta { display: inline-block; width: .5rem; }

table.SC2 tr td input.SC2_ph_inputs { margin: 0 0 0 0; width: 3.5rem; }

select.SC2_auto_angles { padding: 0; width: 8.8rem; margin: 0 0 .2rem 0; }

.SC2_rot_labels { font-size: .92rem; text-align: center; }

#SC2_LACE_OPT   { margin: .5rem 0 .5rem 0; }

#SC2_left_side  {
	display: inline-block;
	vertical-align: top;
	position: relative;
	border: 0;
	width: 16rem;
	margin: 0 0 1rem 0;
}

#SC2_right_side {
	width: 667px;	/* see SC2_wheel_container */
	display: inline-block;
	padding: 0;
	text-align: left;
	border: 0;
	position: relative;
}

#SC2_header_opts {
	display: inline-block;
	height: 2rem;
	vertical-align: middle;
	padding: 0;
	text-align: right;
	border: solid 1px #444;
	border-radius : 8px;
}

#SC2_select_wheel_opts {
	display: inline-block;
	vertical-align: middle;
	height: 100%;
	padding: 2px 0 0 0;
	margin: 0 0 0 .4rem;
	border: solid 1px transparent;
	float: left;
}

SC2_rename_wheel {}

#SC2_rename_box {
	position: relative;
	display: inline-block;
	margin: 0 0 0 0;
	padding: 0 0 0 0;
	border: solid 1px transparent;
}
#SC2_CURRENT_WHEEL {
	width  : 11.5rem;
	margin : 0;
	padding: 1px 0 0 0;
	font-family: arial;
}
#SC2_CURRENT_WHEEL option { text-align: left; padding-left: .2rem;}

#SC2_WHEEL_NAME {
	position: absolute;
	top     : .75px;
	left    : 2.2rem;
	margin  : 0;
	padding : 2px 0 1px .05rem;
	width   : 9.25rem;
	height  : 21px;
	border     : solid 1px transparent;
	text-align : left;
	font-size  : .9rem;
	font-family: arial;  /** Set to same as CURRENT_WHEEL. **/
	visibility : hidden; /** Visible during rename only. **/
}


#SC2_wheel_opts {
	display: inline-block;
	vertical-align: middle;
	margin: 0 0 0 0;
	padding: 2px 0 0 0;
	border: solid 1px transparent;
	height: 100%;
 }


#SC2_show_wheel_opts {
	height: 100%;
	width: 20px;
	min-width: 1rem;
	padding: 0 0 0 0;
	margin: 0 0 0 .3rem;
	vertical-align: middle;
	font: normal 1rem arial;
	border-top-left-radius:0;
	border-bottom-left-radius:0;
	border: transparent;
}


#SC2_auto_copy_container { font-size: .9rem; padding: 2px .6rem 0 .2rem; border: 0; }
#SC2_auto_copy { margin: 0 0 0 2px; }

#SC2_max_wheels { width: 2rem; height: 1.2rem; display: inline-block; margin: 0; font-size: .9rem; padding: 2px 0 0 0; }
#SC2_max_wheels_label {display: inline-block;  margin: 0 0 0 .5rem; border: solid 1px transparent; padding: 0 0 0 0; font-size: .9rem; }

#SC2_undo_sample_clear { margin: 2px .1rem 0 .1rem }


#SC2_list_container {
	text-align: center;
	position: absolute;
	left: 15.3rem;
	top: .3rem;
	display: inline-block;
	border: solid 1px #444;
	width: 14rem;
	border-radius: 8px;
	padding: 0;
	overflow: hidden;
	background-color: white;
	font: bold 1.1rem arial;
	z-index : 998;
}

#SC2_sample_list_hdr {
	font-size: 1rem; 
	display: inline-block; 
	padding: .2rem 0 2px 0; 
	margin: 0 0 .1rem 0; 
	border-bottom: solid 1px;
	float: left;
	width: 100%;
}

#SC2_X_close_load_sample {
	float:right;
	height: 1.3rem;
	margin: -.1rem .15rem 0 0;
	padding: 1px 3px 0 3px;
}

#SC2_sample_wheel_list {
	margin: 0;
	display: inline-block;
	border: solid 2px transparent;
	border-bottom-left-radius: 8px;
	width: 100%;
	font-size: 1rem; 
	height: 100%;
}

#SC2_sample_wheel_list:focus { border: solid 2px teal; box-shadow: 0 0 3pt 1pt #006060 }


table.SC2 {
	display: inline-table;
	width: 100%;
	font-family: arial;
	text-align: center;
	border			: solid 1px #444;
	border-collapse	: separate;
	border-radius	: 8px;
	border-spacing	: 3px;
	vertical-align: top;
	margin: 0 0 .2rem 0;
}

table.SC2 td { padding: 0 0 0 0; }
table.SC2 th { height: 1.8rem; font-size: 1.1rem; border-bottom: solid 2px #333}

table.SC2 .SC2_thv { text-align: right; padding: 0 0 0 3px; width: 7.8rem; font-weight: bold; }

.SC2_separator { padding: 0; height: .3rem; }

.SC2_containers { display: inline-block; vertical-align: top; margin: 0; border: 0; }

.SC2_rotate_scale_containers label { display: inline-block; vertical-align: middle; font-weight: bold; }

/* So we can apply border-radius to SC2_wheel_container within it that has scroll bars. */
#SC2_wheel_container_container {
	padding: 0;
	margin : 3px 0;
	overflow: hidden;
	border: solid 1px #AAA;
	border-radius: 8px;
	position: relative;
}

#SC2_wheel_container {
	display: inline-block;
	padding: 0;
	margin : 0;
	border: 0;
	text-align: center;
	vertical-align: top;
	width : 665px;		/* see SC2_right_side */
	height: 665px;
	overflow-x: scroll;
	overflow-y: scroll;
}

#SC2_svg_wheel  { display: block; padding: 0; margin: auto; border: 0; }

#SC2_scale_rotate_container {
	display: inline-block;
	height: 2rem;
	padding: 0;
	margin: 0;
	border			: solid 1px #444;
	border-radius : 8px;
}

#SC2_show_hide_scale.SC2_scale_rotate_open {
	border-right: 0;
	border-top-right-radius: 0;
	border-bottom-right-radius: 0;
}

#SC2_show_hide_scale {
	height: 100%;
	width: 24px;
	min-width: 1rem;
	padding: 0;
	margin : 0;
	vertical-align: middle;
	font: normal 1rem arial;
	border: transparent;
}


#SC2_CONTAINER .SC2_plus_minus_buttons { width: .9rem; padding: 0px 0px 1px 0px; }

#SC2_scale_rotate_options {
	display: inline-block;
	padding: 2px 0 0 .2rem;
	margin: 0;
	font-family: arial;
	text-align: left;
	border: solid 1px transparent;
	border-radius : 8px;
	vertical-align: middle;
	height: 100%;
	width: 636px;
}

.SC2_rotate_scale_containers {
	display: inline-block;
	padding: 0;
	margin : 0;
	text-align: center;
	vertical-align: bottom;
	border: solid 1px transparent;
}


#SC2_reset_scale_rotate { margin: 0 .6rem; }

#SC2_SCALE_text, #SC2_ROTATE_WHEEL_text { width: 2.9rem; }

.SC2 input.SC2_slider_step { width: 1.3rem; font-size: .8rem; }

#SC2_DISPLAY_SETTINGS  { vertical-align: top; border: 0; width: 100%; }

input[type=range].SC2 {
	-webkit-appearance: none;
	outline: 0;
	border: solid 1px transparent;
	margin: 0 0 0 0;
	display: inline-block;
	vertical-align: middle;
	width: 5.7rem;
	height: .5rem;
}
input[type=range].SC2:hover { }

/*FF*/
input[type=range].SC2::-moz-range-track { background-color: rgba(255,255,255,.8); height: 3px; }
input[type=range].SC2::-moz-range-thumb {
	width: 16px;
	height: 20px;
	background: white;  /**148,180,188,**/
	border: solid 1px #666;
	border-radius: 5px;
}

/*IE*/
input[type=range].SC2::-ms-fill-lower { background-color: rgba(255,255,255,.8); height: 5px; }
input[type=range].SC2::-ms-fill-upper { background-color: rgba(255,255,255,.8); height: 5px; }
input[type=range].SC2::-ms-thumb {
	border-radius: 5px;
	border: solid 1px #666;
	background: rgba(255,255,255,.8);  /**148,180,188,**/
	height: 20px;
	width: 12px;
}


#SC2_adv_hdr { border-bottom: solid 2px #333; }
#SC2_adv_r1c1 { width: 8rem }
#SC2_adv_r1c2 { }
#SC2_adv_r1c2 { }

#SC2_show_hide_notes { width: 16rem; margin: 0 0 0 0; }

#SC2_notes p { margin-top: .5rem; }

#SC2_notes  {
	vertical-align: top;
	border: solid 0px black;
	font-family: arial;
	text-align: left;
	padding: 0 0 0 0;
}

#SC2_see_notes { border-radius: 5px; }

#SC2_notes td { padding: .2rem .2rem .2rem .5rem; border: solid 1px #555; }
#SC2_notes th { padding: .2rem .5rem .2rem .2rem; border: solid 1px #555; }
#SC2_notes th.SC2_th1 { font-size: 1.2rem; text-decoration: none; }
#SC2_notes th.SC2 { width: 9rem; }

#SC2_notes .SC2_lacing_examples { border: solid 1px #777; display: inline-block; margin: .3rem 0 .3rem 0; padding: .4rem; }
#SC2_notes .SC2_lacing_examples p { margin: 0 0 .5rem 0; }


.SC2_list_option_in_text { display: inline-block; width: 8rem; border: solid 1px gray; margin-bottom: 1px; padding: 1px .2rem 0 .2rem; }
.SC2_example_input { display: inline-block; width: 3rem; border: solid 1px gray; margin-bottom: 1px; padding: 1px .2rem 0 .2rem; text-align: center; }

table.SC2_DO { margin: 0 0 .2rem 0; }

table.SC2_DO input.SC2_do_size_input { width: 2.5rem; }
table.SC2_DO input.SC2_do_color_input { width: 5rem; }
table.SC2_DO input.SC2_color { width: 5.5rem; }

#SC2_rim  { fill: none; stroke: #999; }
.SC2_axis {             stroke: #999; stroke-width: 1; stroke-dasharray: 3,3; }
.SC2_rsh  { fill: #000; stroke: #000; stroke-width: 0; } /*rim spoke holes*/
.SC2_hsh  { fill: #000; stroke: #000; stroke-width: 0; } /*hub spoke holes 1 */
.SC2_hsh2 { fill: #000; stroke: #000; stroke-width: 0; } /*hub spoke holes 2 */
.SC2_spoke{ fill: none; stroke: #000; stroke-width: 2; }
.SC2_pcd  { fill: none; stroke: #000; stroke-width: 1; }

.SC2_desc { font-siZe: .8rem; padding: 0; line-height: .8rem; }
.SC2_th1	 { height: 1.0rem; text-decoration: underline; font-weight: bold; }
.SC2_th2	 { height: 1.8rem; text-decoration: underline; }

div.SC2_lengths { display: inline-block; margin: .3rem .3rem; vertical-align: top; }

span.SC2_lengths {
	display: inline-block;
	padding: 2px 0 0 0;
	border: solid .05rem #077;
	border-radius: 4px;
	background-color: rgba(255,255,255, .8);
	width: 5rem;
	font: bold 1.1rem courier;
	min-height: 1.5rem;
}


table#SC2_advanced_info.SC2 { border-spacing: 2px; display: inline-block; }
#SC2_advanced_info td { font-size: .9rem; text-align: left; padding-left: .2rem; }

select.SC2_elbows_laced { padding-left: 0px; font-size: .9rem; width: 4.1rem; }

#SC2_advanced_info .SC2_lesser_settings td, td.SC2_lesser_settings { font-size: .8em; padding-left: .5rem; }
#SC2_advanced_info .SC2_lesser_settings td input { width: 2rem; font-size: .9rem; }


#SC2_assumes { font-weight: bold }

#SC2_other_calcs   { font-family: arial; text-align: left; margin: 0; }
#SC2_other_calcs a { min-width: 55%; border-bottom: solid 2px white; }

#SC2_MSG_HEADER {
	margin			: auto;
	text-align		: center;
	font-weight		: bold;
	text-decoration : underline;
}

#SC2_msg_box {
	vertical-align: top;
	width: 18rem;
	position: absolute;
	top		: 6rem;
	left	: 2rem;
	z-index : 998;
	border	: solid 1px red;
	border-radius	: 5px;
	padding			: .5rem .5rem .5rem .5rem; 
	background-color: white;
	font-family		: arial;
	text-align		: center;
	visibility		: hidden;  /** toggled in Show_Message() **/
	max-height: 30rem;
	overflow-y: auto;
	box-shadow: 0 0 10pt 3pt red;
}


#SC2_close_msg {
	height	: 1.3rem;
	width	: 1.5rem;
	float: right;
	margin: -.5rem -.5rem .5rem .5rem;
	padding	: 1px 0 0 0;
	text-align	: center;
	font		: normal .9rem arial;
	border			: solid 1px #444;
	border-radius	: 3px;
	background-color: #F9F9F9;
}


#SC2_ACCEPT_MSG { font-size: 1.2rem; margin: 1rem 0; padding: 2px; }

#SC2_DELETE_ALL_DATA {  }

#SC2_WHEEL_OR_DISPLAY {
	width: 100%;
	height: 2rem;
	font: normal 1.1rem arial;
	border-radius: 8px;
	margin-top: 0;
}

td div.SC2_PHH_data { text-align: right; }
td div.SC2_PH_data_1 { text-align: right; padding-right: 2rem; }

.SC2_show_adv_opts { float: left; margin-left: .3rem; }
#SC2_eso_opts p { padding-top: .3rem; }

.SC2_DO_theme { background-color: rgb(175,198,205); }

.SC2_mono   { font-family: mono; }
.SC2_strike { text-decoration: line-through; }
.SC2_smaller { font-size: .8rem; font-weight: normal; }

/** Wheel type themes **/
.SC2_theme_standard { background-color: rgb(175,198,205); }
.SC2_theme_triplet  { background-color: rgb(210,223,227); }
.SC2_theme_phh      { background-color: rgb(200,214,240); }
.SC2_theme_phr      { background-color: rgb(227,214,254); }
.SC2_theme_phh_phr  { background-color: rgb(245,192,245); }
.SC2_theme_custom   { background-color: #FAB; }
</style>




<div id=SC2_CONTAINER><!--====================================================-->
	<div id=SC2_disable_page></div><!--Used to cover page for "modal" mode.-->

	<div id=SC2_IMPORT_container class=SC2_imex_containers>
		<button id=SC2_X_import class='SC2 SC2_X_imex_windows'>X</button>
		<p class=SC2>Copy/Paste your previously saved data to the area below, then click "Import Data".</p>
		<p class=SC2>If "Preserve Index" is checked, imported wheels will be restored to the same "slots" (or indexes) from which they were saved.
		   That is, when saved, if the wheel list had wheels in slots: 2-5-7-9, they will be restored to the same.
		   <p class=SC2>However, if "Preserve Index is not checked, they will be restored to slots: 1-2-3-4.<br>
		   (Or, starting at the "beginning at index" specified below.)
		<p class=SC2>Also, the import may set "Max" lower than the highest index of the current wheel list. If so,
			you will need to increase "Max" in order to access those wheels.
		<p class=SC2>
			<button id=SC2_perform_import class="SC2 SC2_imex_btns">Import Data</button>
			<button id=SC2_import_sample_set class="SC2 SC2_imex_btns">Load Sample Wheel Set</button>
			<button id=SC2_close_import   class="SC2 SC2_imex_btns">Cancel and Return to Wheel</button>
		<p class=SC2><label><input type=checkbox id=SC2_PRESERVE_INDEX class=SC2> Preserve Index.</label>
			<label id=SC2_import_index_label>Place imported wheels beginning at index <input type=text id=SC2_IMPORT_INDEX class=SC2 value=1></label>
		<textarea id=SC2_IMPORT_INPUT class="SC2 SC2_IMEX_DATA"></textarea>
	</div>

	<div id=SC2_EXPORT_container class=SC2_imex_containers>
		<button id=SC2_X_export class='SC2 SC2_X_imex_windows'>X</button>
		<p class=SC2>Copy and paste the text below into a blank text file in your favorite text editor.
		   Do not edit the data unless you <i>really</i> know what you're doing!</p>
		<p class=SC2>
		<button id=SC2_copy_to_clipboard class="SC2 SC2_imex_btns">Copy to Clipboard</button>
		<button id=SC2_close_export      class="SC2 SC2_imex_btns">Return to Wheel</button>
		<div id=SC2_EXPORT_OUTPUT class=SC2_IMEX_DATA></div>
	</div>

	<div id=SC2_left_side><!--==========================================-->
		<div id=SC2_msg_box>
			<button id=SC2_close_msg class=SC2>X</button>
			<div id=SC2_message><br></div>
			<button id=SC2_ACCEPT_MSG class=SC2>I Accept</button>
		</div>

		<button type=button id=SC2_WHEEL_OR_DISPLAY class="SC2 SC2_ndo_buttons" value="wheel">Show Display Settings</button>

		<div id=SC2_WHEEL_SETTINGS_container><!--===========-->
		<table id=SC2_WHEEL_SETTINGS class="SC2 SC2_type_theme">
			<tr><th colspan=2>Wheel Settings</th></tr>
			<tr>
				<td colspan=2><b>Type</b>
					<select id=SC2_WHEEL_TYPE class=SC2>
						<option value="standard">Standard</option>
						<option value="triplet" >Triplet</option>
						<option value="phr"     >Paired Hole Rim (PHR)</option>
						<option value="phh"     >Paired Hole Hub (PHH)</option>
						<option value="phh_phr" >PHH &amp; PHR</option>
						<option value="custom"  >Custom</option>
					</select>
				</td>
			</tr>

			<tr><td class=SC2_thv>ERD</td><td><input id=SC2_ERD class=SC2 type=text maxlength=5></td></tr>
			<tr><td class=SC2_thv>Rim Holes</td>
				<td><select id=SC2_NR class=SC2><!-- Populated onload --></select></td>
			</tr>
			<tr><td></td><td>Side 1 &nbsp;Side 2</td></tr>
			<tr>
				<td class=SC2_thv>Flange Holes</td>
				<td><input type=text id=SC2_NF1 class=SC2 maxlength=2> <input type=text id=SC2_NF2 class=SC2 maxlength=2></td>
			</tr>
			<tr>
				<td class=SC2_thv>PCD</td>
				<td><input type=text id=SC2_PCD1 class=SC2 maxlength=5> <input type=text id=SC2_PCD2 class=SC2 maxlength=5></td>
			</tr>

			<tr id=SC1_flange_to_opts>
				<td colspan=2>
					<button type=button id=SC2_show_FL_to_LN class="SC2 SC2_mini_button" value=none>+</button>
					<b>Flange-to-Ctr</b>&boxdr;<input type=text id=SC2_FTC1 class=SC2 maxlength=5> <input type=text id=SC2_FTC2 class=SC2 maxlength=5>&nbsp;
					<div id=SC2_FL_to_LN>Flange-to-LN&boxur;<input type=text id=SC2_FTL1 class=SC2 maxlength=5> <input type=text id=SC2_FTL2 class=SC2 maxlength=5>&nbsp;<br>
					OLD&nbsp; &nbsp; &nbsp; &boxUR;<input type=text id=SC2_OLD class=SC2 maxlength=5>&boxUL; &nbsp; &nbsp;&nbsp;</div>
				</td>
			</tr>

			<tr>
				<td class=SC2_thv><span class=SC2_smaller>Linked</span> <input type=checkbox id=SC2_OSB_linked class=SC2> OC Rim</td>
				<td><input type=text id=SC2_OSB1 class=SC2 maxlength=4> <input type=text id=SC2_OSB2 class=SC2 maxlength=4></td>
			</tr>
			<tr>
				<td class=SC2_thv>Cross</td>  <!-- Populated onload -->
				<td><select id=SC2_SX1 class=SC2></select> <select id=SC2_SX2 class=SC2></select></td>
			</tr>
			<tr>
				<td class=SC2_thv>SHD</td>
				<td><input id=SC2_SHD class=SC2 type=text maxlength=4></td>
			</tr>
			<tr>
				<td class=SC2_thv>Lace Option</td>
				<td>
					<select id=SC2_LACE_OPT class=SC2>
						<option value="-1">&nbsp;2</option>
						<option value=" 1" selected>&nbsp;1</option>
					</select>
				</td>
			</tr>
		</table><!--//end Wheel Settings -->


		<table id=SC2_ADVANCED_SETTINGS class="SC2 SC2_type_theme">
			<tr class=SC2_separator><td></td></tr>
			<tbody id=SC2_PHH_options>
			<tr><td><button type=button id=SC2_show_phh_opts class="SC2 SC2_mini_button SC2_show_adv_opts" value=none>+</button>
				<b>Paired-Hole Hub</b>
			</td></tr>
			<tr id=SC2_phh_opts>
				<td>
					<p>Auto-Angles	<select id=SC2_HUB_AUTO_ANGLES class="SC2 SC2_auto_angles"><!-- Populated onload --></select>
					<div class=SC2_PHH_data>PH Angles
					&#9484;<input type=text id=SC2_PHHA1 class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta>&deg;</span>
					<input type=text id=SC2_PHHA2 class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta>&deg;</span><br>
					PH Distances
					&#9492;<input type=text id=SC2_PHHD1 class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta> </span>
					<input type=text id=SC2_PHHD2 class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta> </span>
					</div>
					<p class=SC2>Hub Flange Rotations</p>
					<div class=SC2>Auto-Rotate
						<select id=SC2_AUTO_ROT class="SC2 SC2_auto_angles">
							<optgroup id=SC2_AUTO_ROT_OPTS label=""><!-- Populated onload --></optgroup>
							<option value="auto" id=SC2_auto_rot_linked>Linked to PH Rim</option>
							<option value="off">Manual</option>
						</select><br>
					</div>
					<div class="SC2_rot_labels SC2_PH_data_1">Flanges Rotated 
						<input type=text id=SC2_ROTF class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta>&deg;</span>
					</div>
				</td>
			</tr>
			<tr><td id=SC2_phr_frot_divider><hr class=SC2_hr2></td></tr>
			</tbody>
			
			<tbody id=SC2_PHR_options>
			<tr><td><button type=button id=SC2_show_phr_opts class="SC2 SC2_mini_button SC2_show_adv_opts" value=none>+</button>
				<b>Paired-Hole Rim</b>
			</td></tr>
			<tr id=SC2_phr_opts>
				<td>Auto-Angles
					<select id=SC2_RIM_AUTO_ANGLES class="SC2 SC2_auto_angles">
						<option value="2">2 x Even</option>
						<option value="1.75" >+3/4 Even</option>
						<option value="1.5"  >+1/2 Even</option>
						<option value="1.25" >+1/4 Even</option>
						<option value="1" selected>Even (Normal Rim)</option>
						<option value=".75" >3/4 Even</option>
						<option value=".5"  >1/2 Even</option>
						<option value=".25" >1/4 Even</option>
						<option value="0">0</option>
						<option value="-.25" >-1/4 Even</option>
						<option value="-.5"  >-1/2 Even</option>
						<option value="-.75" >-3/4 Even</option>
						<option value="-1"   >-Even</option>
						<option value="-1.25">-1 1/4 Even</option>
						<option value="-1.5" >-1 1/2 Even</option>
						<option value="-1.75">-1 3/4 Even</option>
						<option value="-2">-2 x Even</option>
						<option value="off">Manual</option>
					</select>
					<div class=SC2_PH_data_1>PH Angles
						&#9484;<input type=text id=SC2_PHRA class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta>&deg;</span><br>
						PH Distances
						&#9492;<input type=text id=SC2_PHRD class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta>&nbsp;</span>
					</div>
				</td>
			</tr>
			<tr><td><hr class=SC2_hr2></td></tr>
			</tbody>

			<tbody id=SC2_ESO_options>
			<tr><td><button type=button id=SC2_show_eso_opts class="SC2 SC2_mini_button SC2_show_adv_opts" value=none>+</button><b>Esoteric Options</b></td></tr>
			<tr id=SC2_eso_opts>
				<td class=SC2_rot_labels>
					<p class=SC2>Prima Lacing <input type=checkbox id=SC2_PRIMA_LACING class=SC2> (rear wheel)
					<p class=SC2>Rim Rotated <input type=text id=SC2_ROTR class="SC2 SC2_ph_inputs" maxlength=6><span class=SC2_theta>&deg;</span>
				</td>
			</tr>
			<tr class=SC2_separator><td></td></tr>
		</table><!--//end Advanced Settings -->


		<table id=SC2_SPOKE_LENGTHS class="SC2 SC2_type_theme">
			<tr><th>Spoke Lengths</th></tr>
			<tr>
				<td>
					<div class=SC2_lengths><span id=SC2_SL1 class=SC2_lengths></span></div>
					<div class=SC2_lengths><span id=SC2_SL2 class=SC2_lengths></span></div>
				</td>
			</tr>
		</table>


		<button type=button id=SC2_show_hide_advanced class="SC2 SC2_ndo_buttons" value=none>Advanced Build Info</button>
		<table id=SC2_advanced_info class="SC2 SC2_type_theme">
			<tbody id=SC2_adv_info_tbody>
			<tr><td id=SC2_adv_r1c1></td><td id=SC2_adv_r1c2></td><td id=SC2_adv_r1c3></td></tr>
			<tr class=SC2_separator><td colspan=3 id=SC2_adv_hdr>
				(This section does not directly affect the "Spoke Lengths" provided above.
				See <button type=button id=SC2_see_notes class=SC2>Notes etc.</button>
				for more information.)
			</td></tr>
			<tr class=SC2_lesser_settings><td colspan=2>Flange width at spoke holes:</td><td><input type=text id=SC2_FW  class="SC2" maxlength=4></td></tr>
			<tr class=SC2_lesser_settings><td colspan=2>Spoke diameter at bend:     </td><td><input type=text id=SC2_SDB class="SC2" maxlength=4></td></tr>
		
			<tr class=SC2_separator><td colspan=3></td></tr>
			<tr><td></td><td>&nbsp; Side 1</td><td>&nbsp; Side 2</td></tr>
			<tr>
				<td>Elbows Laced</td>
				<td>
					<select id=SC2_ELBOWS1 class="SC2 SC2_elbows_laced">
						<option value="-1">In</option>
						<option value="0" >Center</option>
						<option value="1" >Out</option>
					</select>
				</td>
				<td>
					<select id=SC2_ELBOWS2 class="SC2 SC2_elbows_laced">
						<option value="-1">In</option>
						<option value="0" >Center</option>
						<option value="1" >Out</option>
					</select>
				</td>
			</tr>
		
			<tr class=SC2_separator><td colspan=3></td></tr>
			<tr>
				<td>Length Adjust.</td>
				<td><input type=text id=SC2_SL_ADJ1 class=SC2 readonly tabindex="-1"></td>
				<td><input type=text id=SC2_SL_ADJ2 class=SC2 readonly tabindex="-1"></td>
			</tr>
			<tr>
				<td>Spoke Ratio</td>
				<td><input type=text id=SC2_spoke_ratio1 class=SC2 readonly tabindex="-1"></td>
				<td><input type=text id=SC2_spoke_ratio2 class=SC2 readonly tabindex="-1"></td>
			</tr>
			<tr>
				<td>Bracing Angles</td>
				<td><input type=text id=SC2_brace_angle1 class=SC2 readonly tabindex="-1">&deg;</td>
				<td><input type=text id=SC2_brace_angle2 class=SC2 readonly tabindex="-1">&deg;</td>
			</tr>
			<tr>
				<td>Tension Ratio</td>
				<td><input type=text id=SC2_tension_ratio1 class=SC2 readonly tabindex="-1">%</td>
				<td><input type=text id=SC2_tension_ratio2 class=SC2 readonly tabindex="-1">%</td>
			</tr>
			<tr>
				<td>Tension</td>
				<td><input type=text id=SC2_TENSION1 class=SC2 readonly tabindex="-1"></td>
				<td><input type=text id=SC2_TENSION2 class=SC2 ></td>
			</tr>
			<tr class=SC2_separator><td colspan=3></td></tr>
			</tbody>
		</table>
		</div><!--end SC2_WHEEL_SETTINGS_container -->

		


		<div id=SC2_DISPLAY_SETTINGS><!-- ==========-->
			<table class="SC2 SC2_DO SC2_DO_theme">
				<tr>
					<th colspan=4>Spokes
						<button type=button id=SC2_reset_options_spokes class="SC2 SC2_reset_button">Reset</button>
					</th>
				</tr>
				<tr class=SC2_th1><td>Group</td><td>Color</td><td>Size</td><td>Show?</td></tr>
				<tr class=SC2_th2>
					<td></td>
					<td colspan=2>Side 1</td>
					<td><input type=checkbox id=SC2_SHOW_SIDE1 class=SC2></td>
				</tr>
				<tr>
					<td>1</td>
					<td><input type=text id=SC2_SPOKE_COLOR1 class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_SPOKE_LINE_SIZE1 class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_SPOKE_SHOW1 class=SC2></td>
				</tr>
				<tr>
					<td>2</td>
					<td><input type=text id=SC2_SPOKE_COLOR2 class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_SPOKE_LINE_SIZE2 class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_SPOKE_SHOW2  class=SC2></td>
				</tr>
				<tr class=SC2_separator><td colspan=4></td></tr>
				<tr class=SC2_th2>
					<td></td>
					<td colspan=2>Side 2</td>
					<td><input type=checkbox id=SC2_SHOW_SIDE2 class=SC2></td>
				</tr>
				<tr>
					<td>3</td>
					<td><input type=text id=SC2_SPOKE_COLOR3 class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_SPOKE_LINE_SIZE3 class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_SPOKE_SHOW3 class=SC2></td>
				</tr>
				<tr>
					<td>4</td>
					<td><input type=text id=SC2_SPOKE_COLOR4 class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_SPOKE_LINE_SIZE4 class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_SPOKE_SHOW4 class=SC2></td>
				</tr>
				<tr class=SC2_separator><td colspan=4><hr class=SC2></td></tr>
				<tr>
					<td>Axes</td>
					<td><input type=text id=SC2_AXES_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_AXES_LINE_SIZE  class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_AXES_SHOW  class=SC2></td>
				</tr>
				<tr class=SC2_separator><td colspan=4></td></tr>
			</table>

			<table class="SC2 SC2_DO SC2_DO_theme">
				<tr>
					<th colspan=4>
						Rim &amp; Flanges
						<button type=button id=SC2_reset_options_rim_etc class="SC2 SC2_reset_button">Reset</button>
					</th>
				</tr>
				<tr class=SC2_separator><td colspan=4></td></tr>
				<tr class=SC2_th1><td></td><td>Color</td><td>Size</td><td>Show?</td></tr>
				<tr>
					<td>Rim</td>
					<td><input type=text id=SC2_RIM_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_RIM_LINE_SIZE class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_RIM_SHOW  class=SC2></td>
				</tr>
				<tr>
					<td>F1</td>
					<td><input type=text id=SC2_F1_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_F1_LINE_SIZE class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_F1_SHOW  class=SC2></td>
				</tr>
				<tr>
					<td>F2</td>
					<td><input type=text id=SC2_F2_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_F2_LINE_SIZE class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_F2_SHOW  class=SC2></td>
				</tr>
				<tr class=SC2_separator><td colspan=4></td></tr>

				<tr class=SC2_th2>
					<td></td>
					<td colspan=2>Spoke Holes</td>
					<td><input type=checkbox id=SC2_HOLES_SHOW_ALL class=SC2></td>
				</tr>
				<tr>
					<td>Rim</td>
					<td><input type=text id=SC2_HOLES_RIM_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_HOLES_RIM_SIZE class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_HOLES_RIM_SHOW class=SC2></td>
				</tr>
				<tr>
					<td>F1</td>
					<td><input type=text id=SC2_HOLES_F1_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_HOLES_F1_SIZE class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_HOLES_F1_SHOW class=SC2></td>
				</tr>
				<tr>
					<td>F2</td>
					<td><input type=text id=SC2_HOLES_F2_COLOR class="SC2 SC2_color"></td>
					<td><input type=text id=SC2_HOLES_F2_SIZE class="SC2 SC2_do_size_input"></td>
					<td><input type=checkbox id=SC2_HOLES_F2_SHOW class=SC2></td>
				</tr>
				<tr class=SC2_separator><td colspan=4></td></tr>
			</table>
		</div><!--//end Display Options ====================-->




		<button type=button id=SC2_show_hide_other class="SC2 SC2_ndo_buttons" value="none">A few other calculators</button>
		<div id=SC2_other_calcs>
			Ancesters to The Wheel Maker:<br>
			<a id=a1 class=SC2 href="D-SC.1.html">D-SC 1</a><br>
			<a id=a2 class=SC2 href="D-SC.3.html">D-SC 3</a><br>
			<br>
			<hr class=SC2>
			And a few other spoke length calculators from around the web:<br>
			<p class="SC2 SC2_desc">(I have no affiliation with the following calculators or websites.
			Their links are provided for convenience and comparison only.)</p>
			
			<a class=SC2 href="https://www.sheldonbrown.com/rinard/spocalc.htm" target="_blank">Sheldon's SpoCalc</a><br>
			<a class=SC2 href="http://www.mrrabbit.net/wheelsbyflemingapplications.php" target="_blank">Mr. Rabbit's SpokeChart v2-0<br><span class=SC2_indents>(link near bottom of page)</span></a><br>
			<a class=SC2 href="https://www.bikeschool.com/index.php/resources/spoke-calculator" target="_blank">Bike School</a><br>
			<a class=SC2 href="http://www.prowheelbuilder.com/spokelengthcalculator" target="_blank">Pro Wheel Builder</a><br>
			<a class=SC2 href="https://leonard.io/edd/" target="_blank">Edd</a><br>
			<a class=SC2 href="http://www.sapim.be/spoke-calculator" target="_blank">Sapim</a><br>
			<a class=SC2 href="https://spokes-calculator.dtswiss.com/en/" target="_blank">DT Swiss</a><br>
			<a class=SC2 href="http://www.wheelpro.co.uk/spokecalc/" target="_blank">Wheel Pro</a><br>
			<a class=SC2 href="https://biketechtools.com/spoke-length-calculator" target="_blank">Bike Tech Tools</a><br>
			<a class=SC2 href="http://www.kstoerz.com/freespoke/fullcalc" target="_blank">FreeSpoke</a><br>
		</div>
	</div><!--//end SC2_left_side ======================================-->




	<!--================================================================-->
	<div id=SC2_right_side>
		<div id=SC2_list_container><h4 id=SC2_sample_list_hdr class=SC2_theme_standard>Choose Sample
			<button type=button id=SC2_X_close_load_sample class=SC2>Done</button></h4>
			<select id=SC2_sample_wheel_list class=SC2 size=10><!--//Populated onload--></select>
		</div>

		<div id=SC2_header_opts class="SC2 SC2_DO_theme">
			<div id=SC2_select_wheel_opts>
				<div id=SC2_rename_box>
					<select id=SC2_CURRENT_WHEEL class=SC2><!-- Populated onload --></select><br>
					<input id=SC2_WHEEL_NAME type=text class=SC2 value="" tabindex=-1>
				</div>
				<button type=button id=SC2_rename_wheel class=SC2>Rename</button>
			</div>
			<div id=SC2_wheel_opts class=SC2>
				<label id=SC2_auto_copy_container>Auto Copy<input id=SC2_auto_copy class=SC2 type=checkbox></label>
				<button type=button id=SC2_load_sample       class=SC2>Load Sample</button> 
				<button type=button id=SC2_undo_sample_clear class=SC2>Undo</button>
				<button type=button id=SC2_clear_settings    class=SC2>Clear</button>
				<label id=SC2_max_wheels_label>Max:<input type=text id=SC2_max_wheels class=SC2></label>
			</div>
			<button type=button id=SC2_show_wheel_opts class="SC2 SC2_ndo_buttons" value=none>+</button>
		</div>

		<div id=SC2_wheel_container_container>
			<div id=SC2_wheel_container>
				<svg id="SC2_svg_wheel">
					<title></title>
					<g id="SC2_axes">
						<!--Draw 4 axis from center to edges, so the dashed lines are fixed at the center.-->
						<line id="SC2_x-axis1" class="SC2_axis"/>
						<line id="SC2_y-axis1" class="SC2_axis"/>
						<line id="SC2_x-axis2" class="SC2_axis"/>
						<line id="SC2_y-axis2" class="SC2_axis"/>
					</g>
					<g id="SC2_WHEEL">
						<!--Order of <element>s is their "z-index". ie: last one is on top.-->
						<!--So, list "side 1" items last, so that they're visually on top.-->
						<circle id="SC2_rim" r=""/>
						<g id="SC2_holes_rim"></g>
						<circle id="SC2_flange2" class="SC2_pcd" r=""/>
						<g id="SC2_spokes2"></g>
						<g id="SC2_holes_f2"></g>
						<circle id="SC2_flange1" class="SC2_pcd" r=""/>
						<g id="SC2_spokes1"></g>
						<g id="SC2_holes_f1"></g>
					</g><!--//end id=SC2_WHEEL -->
				</svg>
			</div><!--//end SC2_wheel_container-->
		</div><!--//end SC2_wheel_container_container-->

		<div id=SC2_scale_rotate_container class=SC2_theme_standard>
			<button type=button id=SC2_show_hide_scale class="SC2 SC2_ndo_buttons" value=none>+</button>
			<div id=SC2_scale_rotate_options class="SC2 SC2_DO_theme">
				<div class=SC2_rotate_scale_containers><label>Scale:</label>
					<button type=button class="SC2 SC2_plus_minus_buttons" id=SC2_SCALE_down>-</button>
					<input type=range id=SC2_SCALE_slider class=SC2 min=0 max=2000>
					<button type=button class="SC2 SC2_plus_minus_buttons" id=SC2_SCALE_up>+</button>
					<input type=text  id=SC2_SCALE_text class=SC2>%
					<input type=text  id=SC2_SCALE_step class="SC2 SC2_slider_step">
				</div>
				<button type=button id=SC2_reset_scale_rotate class=SC2>Reset</button>
				<div class=SC2_rotate_scale_containers>
					<label>Rotate:</label>
					<button type=button class="SC2 SC2_plus_minus_buttons" id=SC2_ROTATE_down>-</button>
					<input type=range id=SC2_ROTATE_WHEEL_slider class=SC2 min=0 max=360>
					<button type=button class="SC2 SC2_plus_minus_buttons" id=SC2_ROTATE_up>+</button>
					<input type=text  id=SC2_ROTATE_WHEEL_text   class=SC2>&deg;
					<input type=text  id=SC2_ROTATE_WHEEL_step   class="SC2 SC2_slider_step">
				</div>
			</div>
		</div><!--//end SC2_scale_rotate_container-->
	</div><!--//end SC2_right_side ========================================-->



	<button type=button id=SC2_show_hide_notes class="SC2 SC2_ndo_buttons" value=none>Notes etc.</button>
	<div class=SC2_containers><!-- Notes <table> -->
		<table id=SC2_notes>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Disclaimer</a></th>
				<td>
					<div id=SC2_responsibility>
						<p id=SC2_assumes class=SC2>In all cases, the user assumes full responsibility for the use of any spoke length, image, or other output of this program.
					</div>
					<div>
						<p class=SC2>Like every spoke length calculator, this is a simple utility, and can not determine the validity of every possible combination of rim and hub values.
						<p class=SC2>That is, just because the program many generate a theoretical wheel on screen from a given set of values, does not guarantee that such a wheel is realistically practical, or even possible. Or even that all required spokes lengths are listed.  The preceding will more likely become evident in Custom mode, as it has fewer restrictions on rim &amp; hub values than the other modes.  And while it may often be obvious when values produce an unrealistic wheel, again, there are no guarantees.
						<p class=SC2>For additional information, please refer to geometry. And physics.
					</div>
				</td>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Wheel</a></th>
				<td><p>
					<p>All wheels with saved settings are marked with two colons (::) after the wheel number in the Wheel select list.
					<p>Wheels names can be blank.  You can click [Rename] and delete the name, except for the " :: " indicator.
				</td>
			</tr>
			
			<tr
				><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Auto Copy</a></th>
				<td>
					<p>Values for the current wheel can be copied to a blank wheel (one that has no settings):
					<ul class=SC2>
						<li>Select the wheel to copy.
						<li>Make sure Auto Copy is checked.
						<li>Select a blank wheel (no "::" after the number) from the Wheel select list.
					</ul>
					<p>To prevent Auto Copy, make sure the option is unckecked.
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Max</a></th>
				<td><p>Number of slots in the "Wheel" select list.
					<p>Note that if you have 10 wheels, and change "Max" to 5, wheels above 5 are not lost.
					   If you change "Max" back to 10, all existing wheels up to 10 will be listed.
					<p>The maximum "Max" is 100.
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Load Sample</a></th>
				<td>Loads a complete set of values and builds a sample wheel.</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Clear</a></th>
				<td>Clears and removes the saved settings for the current wheel.</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Undo</a></th>
				<td><p>This will undo the most recent "Load Sample", or the most recent "Clear",
					but only if no wheel settings have been changed since clicking either button.
					<p>
				</td>
			</tr>

			<tr><th class=SC2></th>
				<th>Wheel Settings
					<p>All measured settings are mm (millimeters), except those that aren't (like angles).
				</th>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Type</a></th>
				<td><p>Determines the base type of wheel: Standard, Triplet, Paired-Hole Rim, Paired Hole Hub, Paired-Hole Rim with Paired Hole Hub, Custom.
					<p>Each "Type" has various restrictions on hole count, spoke cross, Lace Type, etc, depending on the nature of the type.  Never-the-less, this does not guarantee that the generated wheel will be realistic or practical. 
					<p>When changing the Type, some wheel values - such as Rim Holes, Flange Holes, and Spoke Cross - may automatically be adjusted to fit the contraints of the new Type. For example, if the current wheel is set to "Triplet" with 21 Rim Holes, and then Type is changed to "Standard", Rim Holes will be adjusted to 24, along with cooresponding changes to Flange Holes.
					<p>Custom removes most restrictions on the various wheel values.  Subsequently, there's a greater possibilty to enter values that will produce an impractical, or even impossible, wheel.  It may be obvious. Hopefully. But maybe not...
				</td>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>ERD</a></th>
				<td>The "<b>E</b>ffective <b>R</b>im <b>D</b>iameter".<br>
					<p>A picture could say a thousand words, so, <a class=SC2 href='https://duckduckgo.com/?q=bicycle+effective+rim+diamter&t=ffsb&iax=images&ia=images' target=_blank>here are a few.</a>
					<p>Note that the display Scale (bottom of wheel image) is based on the ERD (Wheel Settings) &amp; Rim size (Display Settings). For example, if Scale is set to 100, changing the ERD will not change the overall size of the image on screen, as the wheel will automatically scale to fit the wheel window. 
				</td>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Rim Holes</a></th><td>Number of spoke holes in the Rim. Most of the time, this will be the same as the number of spokes.</td></tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Flange Holes</a></th><td>
				Number of spoke holes in the Flange. Normally, the number of holes in each hub flange is 1/2 of the number of holes in the rim, and 1/2 the spoke count. One notable exception is a triplet laced wheel.  Additionally, if the number of flange holes is odd (not even), the spoke cross for that side must be, and is automatically set to, zero.
				<p>Note that the number of holes for Side 1 must be less than or equal to Side 2. This is due to some unsolved programming hangup that I <span class=SC2_strike>can't</span> have yet to solve.
				<p>If your build has fewer spokes on the drive side, which would normally be "Side 2", simply "flip" the wheel.  That is, enter drive side values for "Side 1", and non-drive side for "Side 2".
			</td></tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>PCD</a></th><td>"Pitch Circle Diameter" - diameter of circle running thru the spoke hole centers in the flange. Also referred to as the hub or flange diameter.</td></tr>
 
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Flange-to-Ctr</a></th>
				<td><p>"Flange to Center", or "FTC", or "Center to Flange", or "CTF", etc.
					<p>The distance the flange is offset from the hub center.
					<p>Since it's highly impractical to actually measure anything from the hub center (since it's never marked), to obtain these values, subtract the Flange-to-LN from 1/2 the OLD.
					<p>For example, common rear road hubs have an OLD of 130mm.  Half of that is 65mm.  So, if the distance from the left (or Side 1) locknut face to the left flange center is 27.5mm, then the Side 1 Flange Offset is (65 - 27.5), or 37.5mm .
					<p>Or, if not currently visible, click the [+] just left of "Flange-to-Ctr", and enter the OLD & Flange-to-Locknut values.  The subsequent "Flange-to-Center" value will automatically be calculated.
				</td>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Flange-to-LN</a></th>
				<td>
					<p>"Flange to Locknut", or "Locknut to Flange.
					<p>The distance from the outer face of the locknut to the center of the flange's width (thickness).
					<p>This value, along with the OLD, may be used to determine the Flange-to-Ctr value.
					<p>This option is only available if the OLD is provided.
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>OLD</a></th>
				<td><p>"Over Locknut Distance", or "Over Locknut Dimension".
					<p>The distance between the axle "locknuts" outer faces. Now, not all axles have actual "locknuts", but they will have an outer surface before the end of each axle end that fits between the dropouts.
					<p>As with most things, <a class=SC2 href='https://duckduckgo.com/?q=bicycle+hub+measure+over+locknut&iax=images&ia=images' target=_blank>see the internet</a> for more information.
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>OC Rim</a></th>
				<td>"Off-Center" Rim.<br>
					May also be referred to as "OSB", "Offset Spoke bed", "asymetrical", or similar terms.
					<p>The spoke holes in the rim are "off-center", or "off-set", to one side.
					<p>Useage: Enter a (-)negative number for the side that the holes are closer to (spokes will be a tiny bit shorter); and enter a (+)positive number for the side that the holes are further from (spoke will be a tiny bit longer).
					<p>For example, on a rear wheel rim with a 3mm offset, enter -3 for "Side 1" (the left/non-drive side), and 3 for "Side 2" (the right/drive side).
					<p>If "Linked" is checked, the negative of the value entered in one side will automatically be entered for the other side. This is probably the case for most OC rims.</p>
					<p>The OC settings can also be used for unusal rims, such as Shimano's 540 series, where the spoke holes are actually in the sides of the rim.  In this case, "Linked" should be <i>unchecked</i>, as both values should be positive.
				</td>
			</tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Cross</a></th>
				<td>"Spoke Cross" value.  Number of spokes each spoke crosses on the same side of wheel.
					<p>In Standard and Triplet modes, spoke crossings are automatically set to common values for a given rim hole count, but can be changed if desired.  Additionally, the cross must be zero if the number of holes in the flange is odd (not even).
					<p>In Custom mode, if the number of flange holes is odd, cross can be non-zero, but all spokes on that side will be laced the same direction.  Spokes on the opposite flange will be laced in the opposite direction if they are also odd, otherwise they will be laced normally.
				</td>
			</tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>SHD</a></th><td>"Spoke Hole Diameter". Like Flange Offset &amp; OC, this value only affects final spoke length, and not the wheel as displayed.  To change the displayed hole size, see [Display Setttings]</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Lace Option</a></th><td>Asymetrical lacings, such as triplets, can generally produce two possible patterns (and spoke lengths).  The two patterns depend on which direction Spoke 1 is laced in relation to Hole 0.  Just try it &amp; see.</td></tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Paired Holes</a></th>
				<td>
					<p>Paired Hole (PH) options available in PH  &amp; Custom Wheel Types.
					<p>A <u>PH Angle</u> is formed by lines passing thru the center of paired spoke holes and extending to the axial center of the hub. For example: the angle between two radial spokes.
					<p>A <u>PH Distance</u> is the straight-line distance between the center of paired spoke holes (not along the arc of the rim).  In geometry, this distance is called a chord.
					<p>The PH angle and PH distance are directly related.  That is, setting the PH angle will automatically set the cooresponding PH distance, and vice-versa.
					<p><ul class=SC2>
						<li>In <span class=SC2_list_option_in_text>Paired-Hole Hub</span> mode, hole angles and spoke cross for Side 2 are automatically set to the same value as Side 1.
						<li>In <span class=SC2_list_option_in_text>Custom</span> mode, and Paired Holes Hub selected, hole angles and spoke cross for Side 1 and Side 2 are each user selectable and independent of one another.
							<ul class=SC2>
								<li>Be careful in custom mode to always set the Lace Option so that the spokes in paired holes pull away from each other. The spokes in paired holes should <i>not</i> cross each other!
							</ul>
					</ul>
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Hub Auto-Angles</a></th>
				<td><p>Determines if angles between paired-holes (PH) are automatically calculated, or user provided.				
					<p><ul class=SC2>
						<li><span class=SC2_list_option_in_text>Even (Normal)</span> Normal angles (non-PH hub), with evenly spaced holes around the flange.
						<li><span class=SC2_list_option_in_text>...</span> A few paired-hole angles, based on "Even (Normal)" angles.
						<li><span class=SC2_list_option_in_text>Manual</span> Angles, or distances, are user provided.
					</ul>
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Hub Flange Rotations</a></th>
				<td><p>In addition to, and seperate from, paired-holes on each flange, the flanges can be "rotated" relative to each other.  (Not physically rotated of course, but the holes drilled in positions as though the flanges had been rotated.) "Even (Normal)" means a normal hub, such that the holes in each flange are evenly spaced between them. "1/2 Hole" aligns the holes of each flange.
					<p><ul class=SC2>
						<li><span class=SC2_list_option_in_text>...</span> A few rotation values relative to "Normal".
						<li><span class=SC2_list_option_in_text>0 (Normal)</span> Normal, non-"rotated" flanges.
						<li><span class=SC2_list_option_in_text>Auto w/ Rim PH</span>  The calculated rotations are based on any rim PH angles, and should produce a wheel with only one spoke length per side,*
						<li><span class=SC2_list_option_in_text>Manual</span>
					</ul>
					<p>*With normal rim to hub spoke hole ratios. Ex: 24 hole rim, and a 24 hole hub with 12 holes in each flange.
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Rim Auto-Angles</a></th>
				<td><p>Determines if angles between paired-holes (PH) are automatically calculated, or user provided.				
					<p><ul class=SC2>
						<li><span class=SC2_list_option_in_text>Even (Normal)</span> Normal angles (non-PH rim), with evenly spaced holes around the rim.
						<li><span class=SC2_list_option_in_text>...</span> A few paired-hole values based on "Even (Normal)" angles.
						<li><span class=SC2_list_option_in_text>0</span> (ex: Shimano 540's)
						<li><span class=SC2_list_option_in_text>Manual</span>
					</ul>
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Prima Lacing</a></th>
				<td><p>When checked, this option changes the lacing method as indicated below.
				
					<p>This lacing method should only be used with a paired-hole rim.

					<ul class=SC2>
						<li><p>In a paired-hole rim, "Prima Lacing" spokes match up something like this:</p>
						<div class=SC2_lacing_examples>
						<span class=SC2_mono>F1_F2_____________F2_F1_____________F1_F2_____________F2_F1_____________</span> ...etc...
						</div>
					
						<li><p>Whereas normally laced spokes match up like this:</p>
						<div class=SC2_lacing_examples>
						<span class=SC2_mono>F1_F2_____________F1_F2_____________F1_F2_____________F1_F2_____________</span> ...etc...
						</div>
					
						<li><p>And of course, normally laced spokes in a normal rim:</p>
						<div class=SC2_lacing_examples>
						<span class=SC2_mono>F1_______F2_______F1_______F2_______F1_______F2_______F1_______F2_______</span> ...etc...
						</div>
					</ul>

					<p>"F1" &amp; "F2" indicate spokes from a Flange on "Side 1" or "Side 2". (Or left side/right side, or NDS/DS, etc...)
					<p>An example of some wheel values that might be used in conjunction with this option:
					<ul class=SC2>
						<li>PCD <span class=SC2_example_input>60</span> <span class=SC2_example_input>76</span>
						<li>Paired-Hole Hub Auto-Angles <span class=SC2_list_option_in_text>3/8 Even</span>
						<li>Paired-Hole Hub Auto-Rotate <span class=SC2_list_option_in_text>+ 1/2 Hole</span>
						<li>Paired-Hole Rim PH Distance <span class=SC2_example_input>10</span> to <span class=SC2_example_input>20</span>
						<li>and the Lace Option set so that paired spokes appear somewhat parallel.<br>
						(or to converge at the hub if PCD's are the same).
					</ul>
				</td>
			</tr>

			<tr><th class=SC2 id=SC2_advanced_notes></th>
				<th><p>Advanced Build Info</th>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>General Info</a></th>
				<td>
					<p>The "Advanced Build Info" section is largely academic, and can be ignored for most practical spoke length calculations.
					<p>Basically, this section does not directly affect the "Spoke Lengths" provided above. Instead, it
						just indicates the effects to various spoke values (length, angle, etc) based on "Flange width", 
						"Spoke diameter at bend", and "Elbows Laced".
					<p>Also, the data shown is for spoke 1 of each flange only.  Such data might not be valid for other spokes in wheels with more than one spoke length per side.
				</td>
			</tr>

			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Flange Width</a></th><td>The flange width at spoke holes affects bracing angles and tension ratio. It is often about 3mm. Also, it only matters if spokes are not laced "Center" (not entirely true, but true enough for now).</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Spoke Diameter at the Bend</a></th><td>Spoke diameter just before the "J" bend, where it goes into the hub. This is usually 2mm, but can be other values. The value affects bracing angles &amp; tension ratio. Also, it only matters if spokes are not laced "Center" (not entirely true, but true enough for now).</td></tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Elbows Laced</a></th>
				<td>Specify if the spokes are laced elbows In, Out, or Center.  This affects the bracing angle and tension ratio.  It also affects spoke length a tiny amount. The differences between "Center" and "In" or "Out" are determined by Flange Width and Spoke Diameter at Bend.
					<p>Geometrically, "Center" is the mid-point of the flange thickness, and is the position used for general spoke length calculations by most spoke length calculators.  However, except for specially made hubs and spokes (eg: straight pull), spokes can not actually be laced "center".
					<p>So, if "Center" is used to approximate a common wheel where the spokes are acually laced alternately in/out/in/out (default), the other Advanced values (Length Adjust, Bracing Angles, etc) are just rough approximations.
					<p>A lot of other superfluous details are left out, because it gets complicated and doesn't really matter. So, go ride!
				</td>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Length Adjust.</a></th><td>How much the spoke length is affected by lacing choice (elbows in/out). In general, not enough to worry about.</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Spoke Ratio</a></th><td>The (Side 1):(Side 2) spoke ratio. Usually 1:1, but is 1:2 for triplets, and can be other ratios in custom mode.</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Bracing Angles</a></th><td>The lateral angle the spoke makes going from the rim to the hub.  This is affected by the flange-to-center width, OC rims, PCD, ERD, and spoke cross. Geometricallly, this value is also affected by the spoke hole diameter, but only by a tiny amount. Even less.</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Tension Ratio</a></th><td>The theoretical spoke tension ratio (Side 1):(Side 2).  Side 2 is defined as 100%. This value is based on the spoke ratio and bracing angles.  Note that a change in the bracing angle on either side will affect the ratio listed for Side 1.</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Tension</a></th>
				<td>Enter a spoke tension value under Side 2 to see the cooresponding tension value for Side 1 spokes, based on the Tension Ratio.
				<p>The spoke tensions between Side 1 and Side 2 of a wheel are interdependent. 
					That is, you can't change the tension on one side without affecting the other.*
					<p>So, generally, one side (such as the drive side of a rear wheel) is set to an appropriate tension level, and the other side is what it is, based on hub &amp; rim geometry.
					<p>*Actually, adjusting the tension of <i>any</i> spoke also affects the tension of <i>every other</i> spoke a little bit.
				</td>
			</tr>
			
			<tr><th class=SC2></th><th>Disaplay Settings</th></tr>
			<tr>
				<th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>General</a></th>
				<td>
					Display Options affect the wheel as displayed only, and have no effect on spoke length calculations.
				</td>
			</tr>
			<tr>
				<th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Rim Size</a></th>
				<td>
					Rim Size affects the displayed scale, and- as indicated above, has no effect on spoke length calculations.
					<p>When set to 5 or less, the "center" of the "rim" will be the ERD, and traces thru the rim spoke holes.
					<p>When set more than 5, the "rim" expands away from the rim holes, to simulate an actual rim, where the spoke ends (and the ERD) are slightly within the inner diameter of the rim.
				</td>
			</tr>
			<tr>
				<th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Scale</a></th>
				<td><p>The wheel window is always 100% of the current wheel size (ERD + Rim size Display Setting).  The scale is a percentage relative to the current wheel size.<br>
					<p>For Example:
					<p>
					At 100, the displayed wheel is scaled to fit the display window.<br>
					At 200, the displayed wheel's diameter is twice the window size,<br>
					At 300, the displayed wheel's diameter is thrice the window size, etc...<br>
					<p>Changeing the scale re-centers the wheel within the window.
				</td>
			</tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Colors</a></th>
				<td>Colors can be specified using common 
				<a class=SC2 href="https://www.w3schools.com/Colors/colors_names.asp" target="_blank">html/css color names</a> 
				(black, gray, red, blue, green, skyblue, etc.),
				or with any currently valid html/css color code format (hex, rgb, cymk, etc.).
				</td>
			</tr>
			<tr><th class=SC2></th><th>ETC</th></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Saved Settings</a></th>
				<td><p>In general, all information generated and used by this program internally, such as wheel data and display options, is saved locally, to this device only, in your web browser's localStorage.
					<p>To clear all wheel data &amp; display options stored by this web browser on this device, click the following button:<br>
					<button type=button id=SC2_DELETE_ALL_DATA class=SC2>DELETE ALL SAVED WHEEL AND DISPLAY SETTINGS</button>
					<p>Your browser's cache is not affected by this option, and may retain some information.
					<p>Additionally, any wheels saved via Export Data is naturally unaffected by this option.
				</td>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Export Data</a></th>
				<td><p>Generates a JSON string of all wheel & display data that can then be saved in a text file for backup.</p>
					<button id=SC2_EXPORT class=SC2>Export Wheels &amp; Display Settings</button>
				</td>
			</tr>
			
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Import Data</a></th><td>
				<p class=SC2>Importing previously Exported data may override some or all wheels currently listed in the Wheel select list.  
				<p class=SC2>For example, say you currently have wheels saved in slots 1,2,3, &amp; 4 in the Wheel list. You then perform an Import that only contains wheels for slots 1,2, &amp; 3.  In that case, wheels 1,2, &amp; 3 will be overwritten, but existing wheel 4 will remain unchanged.
				<p class=SC2>In the Import window that opens by clicking the following button, there is an option to load &amp; import 
				a sample set of wheels. These wheels are for example only, and do not contain accurate values for any actual known wheel.
				<p><button id=SC2_IMPORT class=SC2>Import Wheels &amp; Display Settings</button>
			</td></tr>

			<tr><th class=SC2></th><td>&nbsp;</td></tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Contact</a></th>
				<td><p>Please report any issues to <a class=SC2 id=SC2_admin_link href="/">...</a>.
					<p>Or, if you have a github account, at <a class=SC2 href="https://github.com/Self-Evident/The_Wheel_Maker/issues" target="_blank">github.com/Self-Evident/The_Wheel_Maker/issues</a>.
				</td>
			</tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Copyright</a></th>
				<td><pre id=SC2_COPY_LICENSE></pre></td>
			</tr>
			<tr><th class=SC2><a class="SC2 SC2_help_topic" tabindex=0>Version</a></th><td id=SC2_VERSION></td></tr>
			<tr><th class=SC2></th><td></td></tr>
		</table>
	</div><!--//end Notes <table>  =============-->

</div><!--//end SC2_CONTAINER ================================================-->
<br>
<br>






<script>(function(){
/******************************************************************************/
var D = document;
function E(id) { return document.getElementById(id); }
function E_(id) { return document.getElementById(_NS_ + id); }

var _NS_ = "SC2_"; //"Namespace" prefix used for <element> id's & class names.

//Local Storage key names.
var LS_UNDO            = _NS_ + "UNDO";
var LS_VALUES_PREFIX   = _NS_ + "WHEEL_";
var LS_CURRENT_WHEEL   = _NS_ + "CURRENT_WHEEL"; //1, 2, 3, etc...
var LS_DISPLAY_OPTIONS = _NS_ + 'DISPLAY_OPTIONS';

var SSI = " :: " //Saved Settings Indicator. Used in CURRENT_WHEEL <select> list <option>'s.

var SAVE_UNDO = true;  //used onclick of $LOAD_SAMPLE, and onchange of $SAMPLE_WHEEL_LIST.

var HEADER_OPTS_WIDTH = parseInt(window.getComputedStyle(E_('wheel_container_container'), null ).getPropertyValue("width")) + "px";


//Various messeges
var MSGS = {};
MSGS.notice   = "<div id=SC2_MSG_HEADER>Notice!</div>";
MSGS.invalid  = "Invalid input: ";
MSGS.max_fl   = "Maximum value for flange holes: ";
MSGS.nf1_2    = "Number of flange holes:<br>Side 1 must be less than or equal to Side 2.<br>If needed, increase Side 2 first.";
MSGS.nf2_1    = "Number of flange holes:<br>Side 2 must be greater than or equal to Side 1.<br>If needed, decrease Side 1 first.";
MSGS.data1    = "(Angle from spoke hole thru hub's axial center - <i>not</i> the angle of the spoke.)";
MSGS.import_invalid     = "Invalid import data.<br>Import data must be a valid JSON string.";
MSGS.import_complete    = "<b>Import complete.</b>"
MSGS.import_adjust_max  = '<br>The imported "Max" number of wheels is less than before the import.<br>';
MSGS.import_adjust_max += 'Adjust "Max" as needed to access any existing wheels above its current value.<br>';
MSGS.cannot_exceed   = 'The number of imported wheels plus the "beginning" index cannot exceed ';
MSGS.imported_wheels = 'Imported wheels: ';
MSGS.beginning_index = 'Beginning at index: ';
MSGS.total           = 'Total: ';
MSGS.decrease        = 'Decrease the "beginning at index" value to no more than: ';
MSGS.before_import   = 'before import: ';
MSGS.after_import    = ' after import: ';
MSGS.clear_all  = "Clear all current and saved settings?\n\n";
MSGS.clear_all += "This will delete all* cookies and localStorage created\n";
MSGS.clear_all += "by this web page and this web browser on this device.\n\n";
MSGS.clear_all += "*(Those that begin with \""+_NS_+"\".)\n\n";
MSGS.clear_all += "Are you sure?\n\n";




//id & class prefixes, etc.
var SPOKE_ID_PREFIX 	= _NS_ + "spoke_";
var SPOKE_BASE_CLASS	= _NS_ + "spoke";
var SPOKE_GROUP_PREFIX	= _NS_ + "group"; //SC2_group1, ..., SC2_group4
var HUB_HOLE_MESOFIX	= "_sh";	    //hole id = HUB_HOLES + f1 + HUB_HOLE_MESOFIX + 1
var HUB_HOLES           = [];
    HUB_HOLES[1]        = _NS_ + "f1" + HUB_HOLE_MESOFIX; //Hub/flange hole id ex: SC2_f1_sh1
	HUB_HOLES[2]        = _NS_ + "f2" + HUB_HOLE_MESOFIX; //Hub/flange hole id ex: SC2_f1_sh1
var RIM_HOLES			= _NS_ + "rsh"; //class; id prefix: SC2_rsh1, SC2_rsh2, etc...
var AXIS_CLASS			= _NS_ + "axis";
var SCALE_ROTATE_OPEN   = _NS_ + "scale_rotate_open"




//Assign all necessary element references here.
var $PRIOR_FOCUS = ""; //Used to return focus to input that had error. Set onfocus() of the inputs.

var $DISABLE_PAGE = E_('disable_page');

var $RESPONSIBILITY   = E_('responsibility');
var $WHEEL_OR_DISPLAY = E_('WHEEL_OR_DISPLAY');

var $CONTAINER		= E_('CONTAINER');
var $WHEEL_SETTINGS_container = E_('WHEEL_SETTINGS_container');
var $WHEEL_SETTINGS = E_('WHEEL_SETTINGS');

var $SHOW_ADV_SETTINGS = E_('SHOW_ADV_SETTINGS'); //<button>

var $CURRENT_WHEEL  = E_('CURRENT_WHEEL'); //1, 2, 3, etc...
var $WHEEL_NAME     = E_('WHEEL_NAME');

var $HEADER_OPTS     = E_('header_opts');
var $SHOW_WHEEL_OPTS = E_('show_wheel_opts');
var $WHEEL_OPTS      = E_('wheel_opts');

var $MAX_WHEELS     = E_('max_wheels');
var $AUTO_COPY      = E_('auto_copy');
var $RENAME_WHEEL   = E_('rename_wheel');
var $LOAD_SAMPLE	= E_('load_sample');
var $CLEAR_SETTINGS	= E_('clear_settings');
var $UNDO_SAMPLE_CLEAR = E_('undo_sample_clear');

var $LIST_CONTAINER      = E_('list_container');
var $X_CLOSE_LOAD_SAMPLE = E_('X_close_load_sample'); //[X] button
var $SAMPLE_WHEEL_LIST   = E_('sample_wheel_list');   //<select> list

var $WHEEL_TYPE		= E_('WHEEL_TYPE');

var $ERD  = E_('ERD'); // Effective Rim Diameter
var $NR   = E_('NR');	 // Number of holes in the Rim
var $NF	  = [];
	$NF[1]= E_('NF1'); // Number of holes in Flange 1
	$NF[2]= E_('NF2'); //    "        "       "     2

	//Not elements, but requires a few elements defined above...
var MAX = {};			 //At these values, it starts to take to long to run. (Well, it did on my old machine...)
	MAX[$NR.id]    = 96; //MAX NR needs to be divisible by 3 AND by 4,  for Build_NR() to work for both standard & triplet modes.
	MAX[$NF[1].id] = 96;
	MAX[$NF[2].id] = 96;

var $PCD    = [];
	$PCD[1] = E_('PCD1');	// Pitch Circle Diameter 1
	$PCD[2] = E_('PCD2');	// 	 "	   "		"	 2

var $SHOW_FL_to_LN = E_('show_FL_to_LN'); //<button> Show/Hide FL-to-LN inputs
var $FTC    = [];
	$FTC[1] = E_('FTC1');	// Flange-to-Center 1 distance
	$FTC[2] = E_('FTC2');	// 	  "			"	2	 "

	//FTL's are used to compute, and are computed from, FTC, and are not saved.
var $FL_to_LN = E_('FL_to_LN');
var $FTL    = [];
	$FTL[1] = E_('FTL1');	// Flange-to-Locknut 1 distance.
	$FTL[2] = E_('FTL2');	// 	  "			"	 2	 "     .
var $OLD    = E_('OLD');  //"Over Locknut Distance" = FTL[1] + FTC[1] + FTC[2] + FTL[2]

var $OSB_linked = E_('OSB_linked'); //checkbox - if checked, OSB[1] = -OSB[2], automatically.
var $OSB    = [];
	$OSB[1] = E_('OSB1');	// Offset Spoke Bed 1 (off center rim)
	$OSB[2] = E_('OSB2');	// 	  "			"	2	 "		"
var $SX     = [];
	$SX[1]  = E_('SX1');	// Spoke Crossing side 1
	$SX[2]  = E_('SX2');	// Spoke Crossing side 2

var $SHD    = E_('SHD');	// Spoke Hole Diameter. Affects spoke length calcs only.

var $LACE_OPT = E_('LACE_OPT'); // Wheel Type/Lacing Option
	$LACE_OPT.options[0].value = -1; //Type 1. spoke length calculations. DO NOT CHANGE 
	$LACE_OPT.options[1].value =  1; //Type 2. The option values (1 or -1) are used in the 

var $ADVANCED_SETTINGS = E_('ADVANCED_SETTINGS'); //container <table>

var $PHH_options   = E_('PHH_options');
var $SHOW_PHH_OPTS = E_('show_phh_opts');
var $PHH_OPTS      = E_('phh_opts');
var $HUB_AUTO_ANGLES = E_('HUB_AUTO_ANGLES');
var $PHHA    = [];
	$PHHA[1] = E_('PHHA1'); //Paired-Holes Flange 1 Angle
	$PHHA[2] = E_('PHHA2'); //Paired-Holes Flange 2 Angle
var $PHHD    = [];
	$PHHD[1] = E_('PHHD1'); //Paired-Holes Flange 1 Distance (center to center)
	$PHHD[2] = E_('PHHD2'); //Paired-Holes Flange 2 Distance (center to center)

var $AUTO_ROT = E_('AUTO_ROT'); //<select> Auto adjust $ROTF's to ((even rim holes angle) - (paired rim hole angle)) / 2
var $AUTO_ROT_OPTS = E_('AUTO_ROT_OPTS'); //<optgroup>

var $ROTF     = E_('ROTF'); //Angle of Flanges Rotation (seperate from paired-hole values) relative to each other.
var $AUTO_ROT_LINKED = E_('auto_rot_linked');

var $PHR_FROT_DIVIDER = E_('phr_frot_divider');

var $PHR_options   = E_('PHR_options');
var $SHOW_PHR_OPTS = E_('show_phr_opts');
var $PHR_OPTS      = E_('phr_opts');
var $RIM_AUTO_ANGLES = E_('RIM_AUTO_ANGLES');
var $PHRA = E_('PHRA'); //Paired-Holes Rim Angle
var $PHRD = E_('PHRD'); //Paired-Holes Rim Distance (center to center)

var $ESO_options   = E_('ESO_options');
var $SHOW_ESO_OPTS = E_('show_eso_opts');
var $ESO_OPTS      = E_('eso_opts');
var $PRIMA_LACING  = E_('PRIMA_LACING');
var $ROTR = E_('ROTR'); //Rim Rotation: additional angle between holes 1 of flange[1] and rim. Normal is 0.

var $SL   = [];	              //Spoke Lengths
	$SL[1]= E_('SL1');  //Flange 1
	$SL[2]= E_('SL2');  //   "   2


var $SHOW_HIDE_ADVANCED = E_('show_hide_advanced'); //<button> to show/hide advanced build info
var $ADVANCED_INFO      = E_('advanced_info'); //<div> around advanced info.
var $SEE_NOTES          = E_('see_notes'); //

var $FW	 = E_('FW');  //Flange Width at spoke holes.
var $SDB = E_('SDB'); //Spoke Diameter at Bend.

var $ELBOWS	= [];
	$ELBOWS[1] = E_('ELBOWS1');
	$ELBOWS[2] = E_('ELBOWS2');

var $SL_ADJ    = []; //Spoke Lengths adjusted for elbows in or out.
	$SL_ADJ[1] = E_('SL_ADJ1');
	$SL_ADJ[2] = E_('SL_ADJ2');

var $SPOKE_RATIO    = [];
	$SPOKE_RATIO[1] = E_('spoke_ratio1');
	$SPOKE_RATIO[2] = E_('spoke_ratio2');

var $BRACE_ANGLE    = [];
	$BRACE_ANGLE[1] = E_('brace_angle1');
	$BRACE_ANGLE[2] = E_('brace_angle2');

var $TENSION_RATIO    = [];
	$TENSION_RATIO[1] = E_('tension_ratio1');
	$TENSION_RATIO[2] = E_('tension_ratio2');

var $TENSION    = [];
	$TENSION[1] = E_('TENSION1');
	$TENSION[2] = E_('TENSION2');

var $DISPLAY_SETTINGS = E_('DISPLAY_SETTINGS'); //<div> around display options to enable show/hide

var $OTHER_CALCS = E_('other_calcs'); //<div> around A Few Other Calcs links

var $SHOW_HIDE_OTHER = E_('show_hide_other'); //<button> to show/hide other calcs links.
var $SHOW_HIDE_SCALE = E_('show_hide_scale'); //<button> to show/hide scale & rotation options.
var $SHOW_HIDE_NOTES = E_('show_hide_notes'); //<button> to show/hide Notes.

var $SCALE_ROTATE_OPTIONS = E_('scale_rotate_options');

var $SCALE_text   = E_('SCALE_text');
var $SCALE_step   = E_('SCALE_step');
var $SCALE_slider = E_('SCALE_slider');
var $SCALE_up     = E_('SCALE_up');
var $SCALE_down   = E_('SCALE_down');

var $ROTATE_WHEEL_text   = E_('ROTATE_WHEEL_text');
var $ROTATE_WHEEL_step   = E_('ROTATE_WHEEL_step');
var $ROTATE_WHEEL_slider = E_('ROTATE_WHEEL_slider');
var $ROTATE_WHEEL_up     = E_('ROTATE_up');
var $ROTATE_WHEEL_down   = E_('ROTATE_down');

var $RESET_SCALE = E_('reset_scale_rotate');
var $RESET_OPTIONS_SPOKES  = E_('reset_options_spokes');   //<button> to reset display options.
var $RESET_OPTIONS_RIM_ETC = E_('reset_options_rim_etc');  //<button> to reset display options.

var $SPOKE_COLOR    = [];
	$SPOKE_COLOR[1] = E_('SPOKE_COLOR1');//Spoke group 1 color
	$SPOKE_COLOR[2] = E_('SPOKE_COLOR2');//Spoke group 2 color
	$SPOKE_COLOR[3] = E_('SPOKE_COLOR3');//Spoke group 3 color
	$SPOKE_COLOR[4] = E_('SPOKE_COLOR4');//Spoke group 4 color

var $SPOKE_LINE_SIZE    = []; 
	$SPOKE_LINE_SIZE[1] = E_('SPOKE_LINE_SIZE1');//Spoke group 1 line width
	$SPOKE_LINE_SIZE[2] = E_('SPOKE_LINE_SIZE2');//			  2
	$SPOKE_LINE_SIZE[3] = E_('SPOKE_LINE_SIZE3');//			  3
	$SPOKE_LINE_SIZE[4] = E_('SPOKE_LINE_SIZE4');//			  4


var $SHOW_SIDE = [];
	$SHOW_SIDE[1] = E_('SHOW_SIDE1');//Show side 1 spokes (groups 1 & 2)
	$SHOW_SIDE[2] = E_('SHOW_SIDE2');//Show side 1 spokes (groups 1 & 2)

var $SPOKE_SHOW    = [];
	$SPOKE_SHOW[1] = E_('SPOKE_SHOW1');// Show spoke group 1
	$SPOKE_SHOW[2] = E_('SPOKE_SHOW2');// Show spoke group 2
	$SPOKE_SHOW[3] = E_('SPOKE_SHOW3');// Show spoke group 3
	$SPOKE_SHOW[4] = E_('SPOKE_SHOW4');// Show spoke group 4

var $RIM	 = E_('rim'); //<circle>
var $FLANGE1 = E_('flange1'); //<circle>
var $FLANGE2 = E_('flange2'); //<circle>

var $RIM_COLOR = E_('RIM_COLOR');
var $F1_COLOR  = E_('F1_COLOR');
var $F2_COLOR  = E_('F2_COLOR');

var $RIM_LINE_SIZE = E_('RIM_LINE_SIZE');//Width of rim.
var $F1_LINE_SIZE  = E_('F1_LINE_SIZE'); //Line width of flange cirlce.
var $F2_LINE_SIZE  = E_('F2_LINE_SIZE'); //Line width of flange cirlce.

var $RIM_SHOW = E_('RIM_SHOW'); // Show Rim circle.
var $F1_SHOW  = E_('F1_SHOW');  // Show Flange 1 circle.
var $F2_SHOW  = E_('F2_SHOW');  // Show Flange 2 circle.

var $HOLES_SHOW_ALL = E_('HOLES_SHOW_ALL');

var $HOLES_RIM_COLOR = E_('HOLES_RIM_COLOR'); //Spoke hole color
var $HOLES_RIM_SIZE	 = E_('HOLES_RIM_SIZE');  //Displayed spoke hole size (all holes)
var $HOLES_RIM_SHOW	 = E_('HOLES_RIM_SHOW');  //Take a guess...

var $HOLES_F1_COLOR = E_('HOLES_F1_COLOR'); //Spoke hole color
var $HOLES_F2_COLOR = E_('HOLES_F2_COLOR'); //Spoke hole color

var $HOLES_F1_SIZE  = E_('HOLES_F1_SIZE');  //Displayed spoke hole size (all holes)
var $HOLES_F2_SIZE  = E_('HOLES_F2_SIZE');  //Displayed spoke hole size (all holes)

var $HOLES_F1_SHOW  = E_('HOLES_F1_SHOW');  //Take a guess...
var $HOLES_F2_SHOW  = E_('HOLES_F2_SHOW');  //Take a guess...

var $AXES_COLOR     = E_('AXES_COLOR');
var $AXES_LINE_SIZE = E_('AXES_LINE_SIZE');
var $AXES_SHOW  	= E_('AXES_SHOW');

var $SPOKES        = [];
	$SPOKES[1]     = E_('spokes1');   //<g> containing all f1
	$SPOKES[2]     = E_('spokes2');   //<g> containing all f2.
var $HOLES_RIM	   = E_('holes_rim'); //<g> containing rim holes.
var $FLANGE1_HOLES = E_('holes_f1');  //<g> containing flange 1 holes.
var $FLANGE2_HOLES = E_('holes_f2');  //<g> containing flange 2 holes.

var $MSG_BOX 	 = E_('msg_box');	 //Container div for msg div & [Close] btn.
var $CLOSE_MSG	 = E_('close_msg'); //[Close] button for error message box.
var $MESSAGE_DIV = E_('message');	 //div for actual error message.
var $ACCEPT_MSG  = E_('ACCEPT_MSG'); //[I Accept] disclaimer button. id is also cookie name.

var $WHEEL_CONTAINER = E_('wheel_container');
var $SVG_WHEEL = E_('svg_wheel'); //Main <svg> element containing wheel & axes.
var $G_WHEEL   = E_('WHEEL'); //<g> containing just the wheel elements: spokes, holes, rim, & flanges.

var $NOTES = E_('notes'); //Notes <div>.
var $NOTES_ADVANCED_BUILD_INFO = E_('advanced_notes');

var $X_axis1 = E_('x-axis1');
var $Y_axis1 = E_('y-axis1');
var $X_axis2 = E_('x-axis2');
var $Y_axis2 = E_('y-axis2');

var $DELETE_ALL_DATA = E_('DELETE_ALL_DATA');

var $SC2_VERSION = E_('VERSION');

var $LICENSE      = E_('LICENSE');
var $COPY_LICENSE = E_('COPY_LICENSE');

var $EXPORT            = E_('EXPORT'); //<button>
var $EXPORT_CONTAINER  = E_('EXPORT_container');
var $EXPORT_OUTPUT     = E_('EXPORT_OUTPUT'); //<div> of data
var $COPY_TO_CLIPBOARD = E_('copy_to_clipboard');//<button>
var $CLOSE_EXPORT      = E_('close_export');     //<button>

var $X_IMPORT           = E_('X_import');          //<button> [X]
var $X_EXPORT           = E_('X_export');          //<button> [X]
var $IMPORT             = E_('IMPORT');            //<button>
var $IMPORT_CONTAINER   = E_('IMPORT_container');
var $IMPORT_INPUT       = E_('IMPORT_INPUT');      //<input textarea> of data
var $PERFORM_IMPORT     = E_('perform_import');    //<button>
var $IMPORT_SAMPLE_SET  = E_('import_sample_set'); //<button>
var $CLOSE_IMPORT       = E_('close_import');      //<button>
var $PRESERVE_INDEX     = E_('PRESERVE_INDEX');
var $IMPORT_INDEX_LABEL = E_('import_index_label'); //also container.
var $IMPORT_INDEX       = E_('IMPORT_INDEX'); //Import starting at this index/slot.
//end assignment of element references.



var SPOKES_RECESSED = 4; //Amount spoke is "recessed" into rim (RIM_LINE_SIZE), similar to a real wheel. For asthetics only.
var MAX_MAX_WHEELS = 100; //I don't know, seems like a good idea. Not the specific value necessarily, but the general concept...


/*************************************************./
Consider all raw size & x/y values to be either mm or degrees,
to coorespond directly to rim, hub, & spoke measurements.
/*************************************************/
var DEFAULT_VALUES = {
	'WHEEL_NAME' : "New Wheel",
	'WHEEL_TYPE' : "standard", //standard, triplet, custom

	'ERD'  : 577,
	'NR'   : 24,
	'NF1'  : 12,
	'NF2'  : 12,
	'PCD1' : 38.5,
	'PCD2' : 50.6,
	'FTC1' : 37.7,
	'FTC2' : 17.1,
	'OLD'  : 0,
	'OSB_linked': true, //When true, -OSB1 = OSB2, or vice-versa, but only after a change to eiter.
	'OSB1' : "",
	'OSB2' : "",
	'SX1'  : 2,
	'SX2'  : 2,
	'SHD'  : 2.6,	//Affects spoke length calcs only (not displayed size).
	'LACE_OPT': 1,	//1 or -1
	'FW'   : 3,		//Flange Width, at spoke holes.
	'SDB'  : 2,		//Spoke Diameter, at bend.
	'ELBOWS1' : 0,	//0 = flange center, 1 = elbows out, -1 = elbows in
	'ELBOWS2' : 0,	//
	'TENSION2': 110,

	'HUB_AUTO_ANGLES': "1", //Make sure "value" actually === an <option> "value"! ex: "1" !== "1.0"
	'PHHA1' : 30,
	'PHHA2' : 30,

	'AUTO_ROT': '0', //Affects hub flanges only.
	'ROTF'    : 0, //Flange 1 rotation in degrees.

	'RIM_AUTO_ANGLES': "1",  //Make sure "value" actually === an <option> "value"! ex: ".5" !== ".50"
	'PHRA'  : 15,

	'ROTR'    : 0, //Rim rotation in degrees. This is really useless, but fun!
	'PRIMA_LACING': false,

	'SPOKE_COLOR1': "#477", //Spoke group colors
	'SPOKE_COLOR2': "#477", //
	'SPOKE_COLOR3': "#355", //
	'SPOKE_COLOR4': "#355", //
	'SPOKE_LINE_SIZE1': 2,
	'SPOKE_LINE_SIZE2': 2,
	'SPOKE_LINE_SIZE3': 2,
	'SPOKE_LINE_SIZE4': 2,
	'SPOKE_SHOW1': true,
	'SPOKE_SHOW2': true,
	'SPOKE_SHOW3': true,
	'SPOKE_SHOW4': true,
	'RIM_SHOW'   : true,
	'F1_SHOW'    : true,
	'F2_SHOW'    : true,
	'RIM_LINE_SIZE' :30,
	'F1_LINE_SIZE'  :1,
	'F2_LINE_SIZE'  :1,
	'AXES_LINE_SIZE':1,
	'RIM_COLOR' : "#BBB",
	'F1_COLOR'  : "#AAA",
	'F2_COLOR'  : "#777",
	'HOLES_RIM_COLOR': "black",
	'HOLES_RIM_SIZE' : 4, //Displyed hole diameter.  4 approximates spoke head size.  (if hole line size = 0 (stroke-width)).
	'HOLES_RIM_SHOW' : true,
	'HOLES_F1_COLOR': "#066",
	'HOLES_F1_SIZE' : 4, //Displyed hole diameter.
	'HOLES_F1_SHOW' : true,
	'HOLES_F2_COLOR': "#044",
	'HOLES_F2_SIZE' : 4, //Displyed hole diameter.
	'HOLES_F2_SHOW' : true,
	'AXES_COLOR': "#999",
	'AXES_SHOW' : true,

	'ROTATE_WHEEL_text': 180,
	'ROTATE_WHEEL_step': 5,
	'SCALE_text'       : 100,  //Percent.  100% will fit wheel on screen. (ERD + (RIM_LINE_SIZE * 2)).
	'SCALE_step'       : 20,
}//end DEFAULT_VALUES



var DEFAULT_OPTIONS = {
	'max_wheels'        : 10,
	'show_wheel_opts'   : "none", //none or table-row
	'show_phh_opts'     : "table-row", //none or table-row
	'show_phr_opts'     : "table-row", //none or table-row
	'show_eso_opts'     : "none", //none or table-row
	'show_hide_advanced': "none", //none or inline-block
	'show_hide_other'   : "none", //  "			"
	'show_hide_notes'   : "none", //  "			"
	'show_hide_scale'   : "none", //  "			"
	'show_FL_to_LN'     : "none", //none or block
 }
/*************************************************/




var HUB_AUTO_ANGLES_OPTS_COMMON = '<option value="1">Even (Normal Hub)</option> <option value=".875">7/8 Even</option> <option value=".75">3/4 Even</option> <option value=".625">5/8 Even</option> <option value=".5">1/2 Even</option> <option value=".375">3/8 Even</option> <option value=".25">1/4 Even</option> <option value=".125">1/8 Even</option> <option value="0">0</option> <option value="off">Manual</option>'; 
var HUB_AUTO_ANGLES_OPTS_CUSTOM = '<option value="2">2 x Even</option> <option value="1.875">+7/8 Even</option> <option value="1.75">+3/4 Even</option> <option value="1.625">+5/8 Even</option> <option value="1.5">+1/2 Even</option> <option value="1.375">+3/8 Even</option> <option value="1.25">+1/4 Even</option> <option value="1.125">+1/8 Even</option>' + HUB_AUTO_ANGLES_OPTS_COMMON;

var AUTO_ROT_OPTS_COMMON = '<option value="1">+1 Hole</option> <option value=".875">+7/8 Hole</option> <option value=".75">+3/4 Hole</option> <option value=".625">+5/8 Hole</option> <option value=".5">+1/2 Hole</option> <option value=".375">+3/8 Hole</option> <option value=".25">+1/4 Hole</option> <option value=".125">+1/8 Hole</option> <option value="0">Even (Normal Hub)</option>'; 
var AUTO_ROT_OPTS_CUSTOM = '<option value="1.5">+1 1/2 Hole</option> <option value="1.375">+1 3/8 Hole</option> <option value="1.25">+1 1/4 Hole</option> <option value="1.125">+1 1/8 Hole</option> ' + AUTO_ROT_OPTS_COMMON + ' <option value="-.125">-1/8 Hole</option> <option value="-.25">-1/4 Hole</option> <option value="-.375">-3/8 Hole</option> <option value="-.5">-1/2 Hole</option>';


var SAMPLE_WHEELS = {"wheels":{"2":{"WHEEL_NAME":"Sample Standard","WHEEL_TYPE":"standard","ERD":"577","NR":"24","NF1":"12","NF2":"12","PCD1":"38.5","PCD2":"50.6","FTC1":"37.7","FTC2":"17.1","OLD":"0","OSB_linked":true,"OSB1":"0","OSB2":"0","SX1":"2","SX2":"2","SHD":"2.6","LACE_OPT":"1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"110","HUB_AUTO_ANGLES":"1","PHHA1":"30","PHHA2":"30","AUTO_ROT":"0","ROTF":"0","RIM_AUTO_ANGLES":"1","PHRA":"15","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#477","SPOKE_COLOR2":"#477","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#355","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"30","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"180","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"3":{"WHEEL_NAME":"Sample Triplet","WHEEL_TYPE":"triplet","ERD":"577","NR":"24","NF1":"8","NF2":"16","PCD1":"38.5","PCD2":"50.6","FTC1":"37.7","FTC2":"17.1","OLD":"","OSB_linked":false,"OSB1":"","OSB2":"","SX1":"0","SX2":"3","SHD":"2.6","LACE_OPT":"1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"120","HUB_AUTO_ANGLES":"1","PHHA1":"45","PHHA2":"22.5","AUTO_ROT":"0","ROTF":"0","RIM_AUTO_ANGLES":"1","PHRA":"15","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#B77","SPOKE_COLOR2":"#877","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#377","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"30","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"180","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"4":{"WHEEL_NAME":"Sample PHR","WHEEL_TYPE":"phr","ERD":"580","NR":"24","NF1":"12","NF2":"12","PCD1":"70","PCD2":"80","FTC1":"30","FTC2":"30","OLD":"","OSB_linked":false,"OSB1":"","OSB2":"","SX1":"2","SX2":"2","SHD":"2.6","LACE_OPT":"-1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"120","HUB_AUTO_ANGLES":"1","PHHA1":"30","PHHA2":"30","AUTO_ROT":"0","ROTF":"0","RIM_AUTO_ANGLES":".25","PHRA":"3.75","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#B77","SPOKE_COLOR2":"#877","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#377","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"30","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"215","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"5":{"WHEEL_NAME":"Sample PHH","WHEEL_TYPE":"phh","ERD":"580","NR":"24","NF1":"12","NF2":"12","PCD1":"70","PCD2":"80","FTC1":"30","FTC2":"30","OLD":"","OSB_linked":false,"OSB1":"","OSB2":"","SX1":"2","SX2":"2","SHD":"","LACE_OPT":"-1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"","HUB_AUTO_ANGLES":".5","PHHA1":"15","PHHA2":"15","AUTO_ROT":"0","ROTF":"0","RIM_AUTO_ANGLES":"1","PHRA":"15","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#B77","SPOKE_COLOR2":"#877","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#377","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"30","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"180","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"6":{"WHEEL_NAME":"Skip-Hole Triplet","WHEEL_TYPE":"custom","ERD":"577","NR":"36","NF1":"18","NF2":"18","PCD1":"38","PCD2":"50","FTC1":"37.3","FTC2":"17.2","OLD":"","OSB_linked":true,"OSB1":"0","OSB2":"0","SX1":"0","SX2":"3","SHD":"2.6","LACE_OPT":"-1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"110","HUB_AUTO_ANGLES":"1","PHHA1":"20","PHHA2":"20","AUTO_ROT":"0","ROTF":"0","RIM_AUTO_ANGLES":"1","PHRA":"10","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#B77","SPOKE_COLOR2":"#877","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#377","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":false,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"30","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"0","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"7":{"WHEEL_NAME":"SSR rear","WHEEL_TYPE":"phh_phr","ERD":"588","NR":"24","NF1":"12","NF2":"12","PCD1":"47","PCD2":"47","FTC1":"30","FTC2":"18","OLD":"","OSB_linked":false,"OSB1":"0","OSB2":"0","SX1":"2","SX2":"2","SHD":"2.6","LACE_OPT":"-1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"110","HUB_AUTO_ANGLES":".5","PHHA1":"15","PHHA2":"15","AUTO_ROT":"auto","ROTF":"20.07","RIM_AUTO_ANGLES":"off","PHRA":"-5.07","ROTR":"0","PRIMA_LACING":true,"SPOKE_COLOR1":"#477","SPOKE_COLOR2":"#477","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#355","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"25","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"180","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"8":{"WHEEL_NAME":"540 - rear","WHEEL_TYPE":"custom","ERD":"580","NR":"16","NF1":"8","NF2":"8","PCD1":"45","PCD2":"50","FTC1":"35","FTC2":"18","OLD":"130","OSB_linked":false,"OSB1":"7","OSB2":"7","SX1":"1","SX2":"0","SHD":"2.6","LACE_OPT":"1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"110","HUB_AUTO_ANGLES":"off","PHHA1":"5.625","PHHA2":"45","AUTO_ROT":"auto","ROTF":"22.5","RIM_AUTO_ANGLES":"0","PHRA":"0","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#477","SPOKE_COLOR2":"#477","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#355","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"35","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"213.75","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"},"9":{"WHEEL_NAME":"540 - front","WHEEL_TYPE":"custom","ERD":"580","NR":"16","NF1":"8","NF2":"8","PCD1":"40","PCD2":"40","FTC1":"32","FTC2":"32","OLD":"100","OSB_linked":false,"OSB1":"7","OSB2":"7","SX1":"0","SX2":"0","SHD":"2.6","LACE_OPT":"-1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"110","HUB_AUTO_ANGLES":"1","PHHA1":"45","PHHA2":"45","AUTO_ROT":"auto","ROTF":"22.5","RIM_AUTO_ANGLES":"0","PHRA":"0","ROTR":"0","PRIMA_LACING":false,"SPOKE_COLOR1":"#477","SPOKE_COLOR2":"#477","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#355","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"35","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"213","ROTATE_WHEEL_step":"0.25","SCALE_text":"100","SCALE_step":"20"},"10":{"WHEEL_NAME":"Prima - rear","WHEEL_TYPE":"custom","ERD":"580","NR":"16","NF1":"8","NF2":"8","PCD1":"60","PCD2":"76","FTC1":"37.7","FTC2":"17.1","OLD":"","OSB_linked":false,"OSB1":"","OSB2":"","SX1":"1","SX2":"1","SHD":"2.6","LACE_OPT":"1","FW":"3","SDB":"2","ELBOWS1":"0","ELBOWS2":"0","TENSION2":"110","HUB_AUTO_ANGLES":".375","PHHA1":"16.875","PHHA2":"16.875","AUTO_ROT":".5","ROTF":"22.5","RIM_AUTO_ANGLES":"off","PHRA":"1.98","ROTR":"0","PRIMA_LACING":true,"SPOKE_COLOR1":"#477","SPOKE_COLOR2":"#477","SPOKE_COLOR3":"#355","SPOKE_COLOR4":"#355","SPOKE_LINE_SIZE1":"2","SPOKE_LINE_SIZE2":"2","SPOKE_LINE_SIZE3":"2","SPOKE_LINE_SIZE4":"2","SPOKE_SHOW1":true,"SPOKE_SHOW2":true,"SPOKE_SHOW3":true,"SPOKE_SHOW4":true,"RIM_SHOW":true,"F1_SHOW":true,"F2_SHOW":true,"RIM_LINE_SIZE":"35","F1_LINE_SIZE":"1","F2_LINE_SIZE":"1","AXES_LINE_SIZE":"1","RIM_COLOR":"#BBB","F1_COLOR":"#AAA","F2_COLOR":"#777","HOLES_RIM_COLOR":"black","HOLES_RIM_SIZE":"4","HOLES_RIM_SHOW":true,"HOLES_F1_COLOR":"#066","HOLES_F1_SIZE":"4","HOLES_F1_SHOW":true,"HOLES_F2_COLOR":"#044","HOLES_F2_SIZE":"4","HOLES_F2_SHOW":true,"AXES_COLOR":"#999","AXES_SHOW":true,"ROTATE_WHEEL_text":"0","ROTATE_WHEEL_step":"5","SCALE_text":"100","SCALE_step":"20"}}}




////////////////////////////////////////////////////////////////////////////////




function Parse_Settings(string) { //*******************************************/
	//If the parse fails, return null, as localStorage does if a localStorage item doesn't exit.
	//ie: return null on any non object/failure/error.
	try {
		var parsed = JSON.parse(string);
		// Non-exception exceptions:
		// JSON.parse(false) and JSON.parse(1234) simply return false & 1234.
		// We'd prefer null, but JSON.parse(null) returns null, and typeof null === "object".
		// So check for those. And since null is falsey, this works:
		if (parsed && typeof parsed === "object") { return parsed; }
	}
	catch (e) {}
	return null;
}//end Parse_Settings() //*****************************************************/




function Normalize_Event(event) { //*******************************************/
	//Normalize the event & which/keycode/charcode...
	if (!event) {var event = window.event;} //for IE
	var key_code = event.which || event.keyCode || event.charCode;
	event.key_code = key_code;
	return event;
}//end Normalize_Event() //****************************************************/




function Pad10(number, pad_str) { //*******************************************/
	if (typeof pad_str == "undefined") { pad_str = "&nbsp; "; }
	if ((number * 1) < 10) { var pad = pad_str; } else { var pad = ""; }
	return pad + number;
}//end Pad10() //**************************************************************/




function Enable_Disable_Undo_Clear() { //**************************************/
	//Run afer each Build_Select_Wheel_List(), but after $CURRENT_WHEEL.value is changed.

	setTimeout(function() { //Needed or doesn't always work. Race condition with localStorage??
		$UNDO_SAMPLE_CLEAR.disabled = (localStorage.getItem(LS_UNDO) == null);
		$CLEAR_SETTINGS.disabled    = (localStorage.getItem(LS_VALUES_PREFIX + $CURRENT_WHEEL.value) == null);
	}, 1);
}//end Enable_Disable_Undo_Clear() //******************************************/




function Load_Clear_or_Get_Settings(defaults, action) { //*********************/
	var $setting = "";
	var settings = {};

	for (var id in defaults) {
		$setting = E_(id);
		
		//Ignore invalid id's (no cooresponding <element>). Shouldn't be any, but just in case...
		if (!$setting) { continue }
		
		if (action == "load") {
			if ($setting.type == "checkbox") { $setting.checked = defaults[id]; }
			else                             { $setting.value   = defaults[id]; }
		}
		else if (action == "clear") {
			if ($setting.type == "checkbox") { $setting.checked = false; }
			else                             { $setting.value = ''; }
		}
		else { //get and return for Save_Settings()...
			if ($setting.type == "checkbox") { settings[id] = $setting.checked; }
			else 							 { settings[id] = $setting.value;   }
		}
	}

	return settings;
}//end Load_Clear_or_Get_Settings() //***********************************************/




function Save_Settings(what, misc, keep_undo) { //*****************************/
	//Save properties of what, but only the properties that exist in defaults.
	//misc = "imported", "copy", or "name". "imported" also used when restoring undo values.

	if (what == "wheel") {
		var storage_id = LS_VALUES_PREFIX + $CURRENT_WHEEL.value;
		var defaults   =  DEFAULT_VALUES;
		if (!keep_undo) { localStorage.removeItem(LS_UNDO); }
		Enable_Disable_Undo_Clear();
	}
	else if (what == "display") {
		var storage_id = LS_DISPLAY_OPTIONS;
		var defaults   = DEFAULT_OPTIONS;
	}
	else if (what == "undo") {
		var storage_id = LS_UNDO;
		var defaults = DEFAULT_VALUES;
	}
	else { //Should never happen, but I'm not entirely perfect...
		var msg  = 'Save_Settings(what)<br>what = "';
			msg += what + '" is invalid<br>Called from:<br>';
			msg += Save_Settings.caller.name;
		Show_Message('', msg);
		return false;
	}


	var settings = Load_Clear_or_Get_Settings(defaults, "get"); //get curruent settings


	//New wheel? Copy? Imported? Restored undo values?
	var current_wheel = $CURRENT_WHEEL.value;
	var new_wheel     = (localStorage.getItem(LS_VALUES_PREFIX + current_wheel) == null);
	var imported      = (misc == "imported");
	var copy          = (misc == "copy");

	if ( ((what == "wheel") && new_wheel) || imported ) {
		if      (imported)        { ; }
		else if (copy)            { $WHEEL_NAME.value = "Copy of " + $WHEEL_NAME.value; }
		//New wheel created by changing a value other than $WHEEL_NAME...
		else if (misc !== "name") { $WHEEL_NAME.value = DEFAULT_VALUES.WHEEL_NAME; }
		//else { the user set a wheel name to start the wheel, so leave it. }

		var option = $CURRENT_WHEEL.options[current_wheel - 1]; //CURRENT_WHEEL counts from 1, options from 0.
		option.innerHTML = Pad10(current_wheel) + SSI + $WHEEL_NAME.value;
		settings.WHEEL_NAME = $WHEEL_NAME.value;
	}

	localStorage.setItem(storage_id, JSON.stringify(settings));
}//end Save_Settings() { //****************************************************/




function Load_Settings(what, imp_def) { //*************************************/
	//imp_def: imported or defaults

	if (imp_def) { var settings = what; } //Or loading default, aka "Sample", wheel settings.
	else         { var settings = Parse_Settings(localStorage.getItem(what)); }

	if (settings == null) { return false; }

	Load_Clear_or_Get_Settings(settings, 'load');

	if ($CURRENT_WHEEL.value && what == (LS_VALUES_PREFIX + $CURRENT_WHEEL.value)) {
		$WHEEL_NAME.current = $WHEEL_NAME.value;
	}

	//Some settings are based on saved settings...
	if ((what != LS_DISPLAY_OPTIONS) && (what != DEFAULT_OPTIONS)) {
		Calc_Flange_Offset($FTL[1], $FTC[1]);
		Calc_Flange_Offset($FTL[2], $FTC[2]);
		Enable_Disable_FTL();
		$SCALE_slider.value = $SCALE_text.value;
		$SCALE_slider.setAttribute('step', $SCALE_step.value);
		$ROTATE_WHEEL_slider.value = $ROTATE_WHEEL_text.value
		$ROTATE_WHEEL_slider.setAttribute('step', $ROTATE_WHEEL_step.value);
		Show_Side_Checked(1); //Spokes...
		Show_Side_Checked(2);
		Show_All_Holes_Checked();
	}

	return true;
}//end Load_Settings() { //***************************************************/




function Validate_Wheel_Settings(misc, save) { //******************************/
	//Currently, just a very basic sanitation of loaded values. Now, even less.

	if (($WHEEL_TYPE.value != "custom") && 
	    ($WHEEL_TYPE.value != "triplet") && 
		($WHEEL_TYPE.value != "phh") && 
		($WHEEL_TYPE.value != "phr") && 
		($WHEEL_TYPE.value != "phh_phr"))  { $WHEEL_TYPE.value = "standard"; }

	if ($LACE_OPT.value != "-1") { $LACE_OPT.value = 1; }

	//For now, just make sure they're numbers (those that should be, at leaset).
	for (var id in DEFAULT_VALUES) {
		var $setting = E_(id);
		if ( !$setting ) { continue }

		//#####All wheel setting text inputs USED to be numbers only (erd, pcd, etc...),
		//#####but now inlcude spoke, rim, & hole colors.
		//#####if ($setting.type == "text" && isNaN($setting.value) && $setting.id != $WHEEL_NAME.id) { $setting.value = ""; }
		if ($setting.tagName == "SELECT" && $setting.selectedIndex < 0) { $setting.selectedIndex = 0; }
	}

	if (save) { Save_Settings("wheel", misc); } //in case any were invalid.
}//end Validate_Wheel_Settings() { //******************************************/




function Load_Samples(sample_index) { //***************************************/
	if ($ACCEPT_MSG.ENABLED && $ACCEPT_MSG.value != "true") { return; }

	Init_NR_SX();

	Load_Settings(SAMPLE_WHEELS.wheels[sample_index], true);

	$WHEEL_NAME.current = $WHEEL_NAME.value;
	var current_wheel = $CURRENT_WHEEL.value;
	var option = $CURRENT_WHEEL.options[current_wheel - 1]; //CURRENT_WHEEL counts from 1, options from 0.
	option.innerHTML = Pad10(current_wheel) + SSI + $WHEEL_NAME.value;

	$G_WHEEL.setAttribute('transform', " rotate(" + $ROTATE_WHEEL_text.value + ")");
	Setup_Type_and_Build("build");
	Setup_Viewbox();

	Save_Settings("wheel", "name", true); //true == don't delete saved undo settings from localStorage.

	//Must come after Save_Settings("wheel",...)
	var current_wheel_settings = localStorage.getItem(LS_VALUES_PREFIX + $CURRENT_WHEEL.value);
	Enable_Disable_Undo_Clear();
}//end Load_Samples() { //*****************************************************/




function Clear_Settings() { //*************************************************/

	Load_Clear_or_Get_Settings(DEFAULT_VALUES, "clear");

	//Selects, checkboxes, and a few others need default values.
	$WHEEL_NAME.current    = DEFAULT_VALUES.WHEEL_TYPE;
	$WHEEL_TYPE.value      = DEFAULT_VALUES.WHEEL_TYPE;
	$LACE_OPT.value        = DEFAULT_VALUES.LACE_OPT;
	$HUB_AUTO_ANGLES.value = DEFAULT_VALUES.HUB_AUTO_ANGLES;
	$RIM_AUTO_ANGLES.value = DEFAULT_VALUES.RIM_AUTO_ANGLES;
	$AUTO_ROT.value        = DEFAULT_VALUES.AUTO_ROT;
	$FW .value             = DEFAULT_VALUES.FW;
	$SDB.value             = DEFAULT_VALUES.SDB;
	$ELBOWS[1].value       = DEFAULT_VALUES.ELBOWS1;
	$ELBOWS[2].value       = DEFAULT_VALUES.ELBOWS2;
	$TENSION[2].value      = ''; //[1] is a computed value, and is cleared in Clear_Wheel()
	$FTL[1].value = ''; //Computed values
	$FTL[2].value = '';

	Setup_and_Build("init");

	Reset_Scale_Rotate();
	Reset_OPTIONS_SPOKES();
	Reset_OPTIONS_RIM_ETC();
	Clear_Wheel(true);

	var current_wheel = $CURRENT_WHEEL.value;
	var option = $CURRENT_WHEEL.options[current_wheel - 1]; //current_wheel counts from 1, options from 0.
	option.innerHTML = Pad10(current_wheel);

	localStorage.removeItem(LS_VALUES_PREFIX + current_wheel);
}//end Clear_Settings() { //***************************************************/




function Load_DEFAULT_VALUES_Spokes() { //************************************/
	for (var group = 1; group <=4; group++) {
		$SPOKE_COLOR[group]    .value   = DEFAULT_VALUES['SPOKE_COLOR'     + group];
		$SPOKE_LINE_SIZE[group].value   = DEFAULT_VALUES['SPOKE_LINE_SIZE' + group];
		$SPOKE_SHOW[group]     .checked = DEFAULT_VALUES['SPOKE_SHOW'      + group];
	}
	
	$SHOW_SIDE[1].checked = ($SPOKE_SHOW[1].checked || $SPOKE_SHOW[2].checked);
	$SHOW_SIDE[2].checked = ($SPOKE_SHOW[3].checked || $SPOKE_SHOW[4].checked);

	$AXES_SHOW.checked    = DEFAULT_VALUES['AXES_SHOW'];
	$AXES_COLOR.value     = DEFAULT_VALUES['AXES_COLOR'];
	$AXES_LINE_SIZE.value = DEFAULT_VALUES['AXES_LINE_SIZE'];
}//end Load_DEFAULT_VALUES_Spokes() { //**************************************/




function Load_DEFAULT_VALUES_Rim_etc() { //***********************************/
	$RIM_COLOR.value     = DEFAULT_VALUES['RIM_COLOR'];
	$F1_COLOR.value      = DEFAULT_VALUES['F1_COLOR'];
	$F2_COLOR.value      = DEFAULT_VALUES['F2_COLOR'];
	$RIM_LINE_SIZE.value = DEFAULT_VALUES['RIM_LINE_SIZE'];
	$F1_LINE_SIZE.value  = DEFAULT_VALUES['F1_LINE_SIZE'];
	$F2_LINE_SIZE.value  = DEFAULT_VALUES['F2_LINE_SIZE'];
	$RIM_SHOW.checked    = DEFAULT_VALUES['RIM_SHOW'];
	$F1_SHOW.checked     = DEFAULT_VALUES['F1_SHOW'];
	$F2_SHOW.checked     = DEFAULT_VALUES['F2_SHOW'];

	$HOLES_RIM_COLOR.value  = DEFAULT_VALUES['HOLES_RIM_COLOR'];
	$HOLES_RIM_SIZE.value   = DEFAULT_VALUES['HOLES_RIM_SIZE'];
	$HOLES_RIM_SHOW.checked = DEFAULT_VALUES['HOLES_RIM_SHOW'];

	$HOLES_F1_COLOR.value  = DEFAULT_VALUES['HOLES_F1_COLOR'];
	$HOLES_F1_SIZE.value   = DEFAULT_VALUES['HOLES_F1_SIZE'];
	$HOLES_F1_SHOW.checked = DEFAULT_VALUES['HOLES_F1_SHOW'];

	$HOLES_F2_COLOR.value  = DEFAULT_VALUES['HOLES_F2_COLOR'];
	$HOLES_F2_SIZE.value   = DEFAULT_VALUES['HOLES_F2_SIZE'];
	$HOLES_F2_SHOW.checked = DEFAULT_VALUES['HOLES_F2_SHOW'];
	
	$HOLES_SHOW_ALL.checked = ($HOLES_RIM_SHOW.checked || $HOLES_F1_SHOW.checked || $HOLES_F2_SHOW.checked);
}//end Load_DEFAULT_VALUES_Rim_etc() { //*************************************/




function Load_DEFAULT_VALUES_Scale_Rotate() { //*******************************/
	$ROTATE_WHEEL_step.value   = DEFAULT_VALUES.ROTATE_WHEEL_step;
	$ROTATE_WHEEL_text.value   = DEFAULT_VALUES.ROTATE_WHEEL_text;
	$ROTATE_WHEEL_slider.value = $ROTATE_WHEEL_text.value;
	$ROTATE_WHEEL_slider.setAttribute('step', $ROTATE_WHEEL_step.value);
	$G_WHEEL.setAttribute('transform', " rotate(" + $ROTATE_WHEEL_text.value + ")");
	$SCALE_step.value   = DEFAULT_VALUES.SCALE_step;
	$SCALE_text.value   = DEFAULT_VALUES.SCALE_text;
	$SCALE_slider.value = $SCALE_text.value
	$SCALE_slider.setAttribute('step', $SCALE_step.value);
}//end Load_DEFAULT_VALUES_Scale_Rotate() //***********************************/




function Round(number, places) { //********************************************/
	if (isNaN(places)) { places = 0; }
	else               { places = Math.floor(places); }
	if (places > 13) { places = 13 } //Avoid scientific notation (sn).  ex:  1.0e-14.  Javascript uses sn after 13 digits.
	number = parseFloat(number);
	number = number.toFixed(20);//Avoid numbers in sn. //MS Edge craps out atfter toFixed(20).  FF works 'til (30).
	//Now use exponetial notation to avoid the 1.005 issue... try it: alert(1.005*10)  or,  alert(Math.round(1.005*100)/100)
	//Some numbers may be of form: 1.1234567890123456e-14, and this function won't work with such numbers. Yet...
	var rounded = Number( Math.round( number + 'e' + places ) + 'e-' + places );
	if (isNaN(rounded)) { rounded = 0; }
	return  rounded;
}//end Round() //**************************************************************/




function Scroll_Blur(event){ //************************************************/
	//Permit "clearing" focus, and some keyboard navigation while in <input>'s.

	Normalize_Event(event);
	var key = event.key_code;
	
	var ESC = 27, AU = 38, AD = 40, PU = 33, PD = 34;

	var rotate_wheel_slider = (event.target == $ROTATE_WHEEL_slider);
	var scale_slider        = (event.target == $SCALE_slider);
	if ((rotate_wheel_slider || scale_slider) && (key == AU || key == AD || key == PU || key == PD)) { return; }

	//ESC "cancels" current renaming of wheel & reverts back to current name.
	if ((event.target.id == $WHEEL_NAME.id) && (key == ESC)) { $WHEEL_NAME.value = $WHEEL_NAME.current; }

	//remove focus from input/select to allow keyboard arrows/pageup/pagedown/etc page scrolling.
	if (key == ESC) { D.activeElement.blur(); return; }

	if (event.target.tagName == "INPUT") {
		//Arrow down scrolls the page up, towards the bottom of the page, and vice-versa.
		if      (key == AU) { window.scrollBy(0, -38); }
		else if (key == AD) { window.scrollBy(0,  38); }
		else if (key == PU) { window.scrollBy(0,-400); }
		else if (key == PD) { window.scrollBy(0, 400); }
	}
}//end Scroll_Blur() //********************************************************/




function Build_Select_Wheel_List() { //****************************************/
	
	var max_wheels = parseInt($MAX_WHEELS.value);

	var current_wheel = localStorage.getItem(LS_CURRENT_WHEEL) * 1; //1, 2, 3, ...
	if (isNaN(current_wheel)) { current_wheel = 1; } else
	if (current_wheel < 1)    { current_wheel = 1; } else
	if (current_wheel > max_wheels) { current_wheel = max_wheels; localStorage.setItem(LS_CURRENT_WHEEL, current_wheel); }

	$CURRENT_WHEEL.innerHTML = ""; //Clear any current <option>s

	var mark = ""; //Indicates options with saved settings. Either " :: ", or " :: User Supplied Wheel Name".
	var option_list = "";

	for (var wheel = 1; wheel <= max_wheels; wheel++) {
		
		var settings = Parse_Settings(localStorage.getItem(LS_VALUES_PREFIX + wheel));
		
		//If wheel settings exist, get "WHEEL_NAME" & show in <option> text.
		if (settings == null) { mark = "" }
		else {	
			//Make sure WHEEL_NAME is not missing.
			if ( !('WHEEL_NAME' in settings) ) {
				settings['WHEEL_NAME'] = '';
				localStorage.setItem(LS_VALUES_PREFIX + wheel, JSON.stringify(settings));
			}
			
			for (var id in settings) {
				var value = settings[id];
				if (id == "WHEEL_NAME") { mark = SSI + value; break; } //I don't care - deal with it.
			}
		}
		
		option_list += "<option value='"+wheel+"'>" + Pad10(wheel) + mark + "</option>";
	}

	$CURRENT_WHEEL.innerHTML   = option_list;
	$CURRENT_WHEEL.value       = current_wheel;
	$CURRENT_WHEEL.prior_value = current_wheel;
}//end Build_Select_Wheel_List() //********************************************/




function Advanced_Build_Notes_btn() { //***************************************/

	var $Notes = $SHOW_HIDE_NOTES; //[Notes] button at bottom of page
	
	//If notes are hidden, show them...
	if ($Notes.value == "none") { Show_Hide_Options($SHOW_HIDE_NOTES, $NOTES, "inline-block"); }
	
	$NOTES_ADVANCED_BUILD_INFO.scrollIntoView();
}//end Advanced_Build_Notes_btn() //*******************************************/




function Show_Hide_Options(button, target, mode) { //**************************/
	//Toggle button.value, and Show or Hide target,

	if (button.value == "none") { button.value     = mode;   } //inline-block, etc...
	else 						{ button.value     = "none"; }

	target.style["display"] = button.value;

	Scroll_Into_View(target, button.offsetHeight + 10);

	Save_Settings("display");
}//end Show_Hide_Options() //**************************************************/




function Bracing_Angle(f, adj) { //********************************************/
	//tan(bracing angle) = (FtC +/- OSB) / (rR - y1 - rSH)
	
	if (!adj) { adj = 0 } //Consider whether spokes laced elbows out or in. (+/- ~2.5mm)

	var rR = $ERD.value/2;			//radius of Rim
	var rF = $PCD[f].value/2;		//radius of Flange
	var ftc= $FTC[f].value*1 + adj;	//flange to center + elbows laced in or out...
	var osb= $OSB[f].value*1;		//offset spoke bed (off-center)
	var rSH= $SHD.value/2;			//radius of Spoke Hole (spoke hole diameter/2)
	var aR = 360/$NR.value*1;		//angle between holes in Rim
	var aF = 360/$NF[f].value*1;	//angle between holes in flange
	var lo = $LACE_OPT.value*1; 	//lacing option, 1 or -1. For standard lacings, doesn't matter.
	

	//"angle" to hole zero. For standard wheels = 0, but not for triplets.
	if (($NR.value % $NF[f].value) == 0) { var a0 = 0; } else { var a0  = aR - aF/2; }

	var af     = ($SX[f].value * aF) + a0 * lo; //angle to hole in flange  spoke.
	var af_rad = af/180 * Math.PI; 		 //af in radians
	var y1     = rF * Math.cos(af_rad);  // x1^2 + y1^2 = rF^2
	var tan_aB = (ftc + osb) / (rR - y1 - rSH);//tangent of Bracing angle
	var aB_rad = Math.atan(tan_aB);		 //Bracing angle (in radians)
	var aB    = aB_rad * 180 / Math.PI;	 //Bracing angle (in degrees)

	return aB;
}//end Bracing_Angle() { //****************************************************/




function Update_Advanced_Info(save) { //***************************************/
	//Data for spoke 1 of each flange only. 
	//May or may not be valid for other spokes in wheels with more than one spoke length per side.

	$SPOKE_RATIO[1].value = '';
	$SPOKE_RATIO[2].value = '';

	if ($NF[1].value == 0) { var spoke_ratio = ""; }
	else 				   { var spoke_ratio = parseFloat($NF[2].value / $NF[1].value).toFixed(2); }

	if ($NR.value != 0 && $NF[1].value != 0) { $SPOKE_RATIO[1].value = 1; }
	$SPOKE_RATIO[2].value = spoke_ratio;

	//For determining brace angles when spokes laced Elbows In/Elbows out, vs flange Center (altertnating).
	//(Flange Width + Spoke Diameter at Bend)/2
	var brace_adj = $FW.value/2 + $SDB.value/2;

	var aB1 = Bracing_Angle(1, brace_adj * $ELBOWS[1].value);
	var aB2 = Bracing_Angle(2, brace_adj * $ELBOWS[2].value);

	if ((aB1 <= 0) || isNaN(aB1)) {
		var bracing_ratio = 0;
		$BRACE_ANGLE[1].value = "";
		$TENSION_RATIO[1].value = "";
	}
	else {
		var bracing_ratio = aB2/aB1;
		$BRACE_ANGLE[1].value = aB1.toFixed(2);
		$TENSION_RATIO[1].value = (bracing_ratio * spoke_ratio * 100).toFixed(1);
	}

	if ((aB2 <= 0) || isNaN(aB2)) {
		$BRACE_ANGLE[2].value = "";
		$TENSION_RATIO[2].value = "";
	}
	else {
		$BRACE_ANGLE[2].value = aB2.toFixed(2);
		$TENSION_RATIO[2].value = 100; //By definition
	}

	var sl_1   = Calc_Spoke_Length(1, 1, 4);
	var sl_1io = Calc_Spoke_Length(1, 1, 4, brace_adj * $ELBOWS[1].value);

	var sl_2   = Calc_Spoke_Length(2, 1, 4)
	var sl_2io = Calc_Spoke_Length(2, 1, 4, brace_adj * $ELBOWS[2].value)

	$SL_ADJ[1].value = Round((sl_1io - sl_1), 2);
	$SL_ADJ[2].value = Round((sl_2io - sl_2), 2);

	$TENSION[1].value = Round($TENSION[2].value * $TENSION_RATIO[1].value / 100);

	if (save) { Save_Settings("wheel"); }
}//end Update_Advanced_Info() { //*********************************************/




function Build_NR_Options(wheel_type, max, new_value) { //*********************/
	var skip = 4; //"standard"
	if (wheel_type == "triplet") { skip = 3 } else 
	if (wheel_type == "custom" ) { skip = 1 }
	
	var options = "";
	for (var x = max; x >= 0; x -= skip) { options += "<option value="+x+">"+x+"</option>\n" }

	$NR.innerHTML = options;
	$NR.value = new_value;
}//end Build_NR_Options(wheel_type) { //***************************************/




function Build_SX_Options(wheel_type, f, max, value) { //**********************/

	value = value*1;

	var options = ""

	if (wheel_type != "custom") { max = Math.floor(max/4); }

	for (var x = max; x >= 0; x--) { options += "<option value="+x+">"+x+"</option>\n"; }

	if (max == 0)    { value = 0       } else
	if (value > max) { value = max - 1 }

	$SX[f].innerHTML = options;
	$SX[f].value = value;
}//end Build_SX_Options() { //*************************************************/




function Init_NR_SX() { //*****************************************************/
	Build_NR_Options("custom", MAX[$NR.id], 0);
	Build_SX_Options("custom", 1, MAX[$NR.id], 0);
	Build_SX_Options("custom", 2, MAX[$NR.id], 0);
}//end Init_NR_SX() //*********************************************************/




/****************************************************************************../
	Geometery & trig used to calculate paired-hole angles & distances.
	------------------------------------------------------------------
	Prof. Sohcahtoa says sin(Î¸) = opposite side over hypotenuse.
	So, for our case, sin(Î¸/2) = (d/2) / (PCD/2),
	Where Î¸ is the angle formed by two lines originating at the center of the PCD,
	and exending thru the paired-holes.

        X  axial center of hub
       /Î¸\
      / | \
     /  |  \  hypotenuse = PCD/2
    /   |   \ 
   /    |    \
  O-----+-----O  Paired Holes  (Actual paired-holes are much closer together,)
  |     |<d/2>|                (relatively speaking.                         )
  |<----d---->| 
/******************************************************************************/



function Calc_PD_from_PA($phd, $pha, $pcd_or_erd) { //*************************/
	//Calculate the c-t-c distance between paired-holes, from the angle bwtween them.
	//Also uses flange or rim diameter (PCD or ERD).
	var radians = $pha.value * Math.PI / 180;
	var distance = Math.sin(radians/2) * $pcd_or_erd.value;
	$phd.value = Round(distance,2);
	return distance;
}//end Calc_PD_from_PA() //****************************************************/



function Calc_PA_from_PD($pa, $pd, $pcd_or_erd) { //***************************/
	//Calculate the angle between paired-holes, from the distance between them (c-t-c).
	//Also uses flange or rim diameter (PCD or ERD).
	//sin(Î¸/2) = (d/2) / (PCD/2)
	//      Î¸  = 2 * asin(d/PCD)
	var radians = 2 * Math.asin($pd.value / $pcd_or_erd.value);
	var degrees = radians * (180 / Math.PI);
	$pa.value = Round(degrees,2);
	return degrees;
}//end Calc_PA_from_PD(side) //************************************************/




function Calc_Spoke_Length(flange, spoke, round_to, elbows) { //************/
	//Calculate actual spoke length in 3-d space, including flange-to-center measurement..
	//elbows = +/- offset from flange centerline to spoke centerline (elbows out/in)

	var spoke_id = SPOKE_ID_PREFIX + flange + '_' + spoke;

	if (!E(spoke_id)) { return '' }
	
	if (!round_to) { round_to = 1 } //decimal places.
	
	if (!elbows) { elbows = 0 }

	//Get spoke ends
	var x1 = E(spoke_id).getAttribute('x1');
	var y1 = E(spoke_id).getAttribute('y1');
	var x2 = E(spoke_id).getAttribute('x2');
	var y2 = E(spoke_id).getAttribute('y2');
	
	var dx = x2 - x1;
	var dy = y2 - y1;

	var ftc = $FTC[flange].value*1; //Final spoke length requires Flange to Center
	var osb = $OSB[flange].value*1; //and OSB...
	var w = ftc + osb + elbows;

	var S = Math.sqrt(w*w + dx*dx + dy*dy) - $SHD.value/2;

	return Round(S, round_to);
}//end Calc_Spoke_Length() //**************************************************/




function Calc_Spoke_Lengths(side, validate, $changed, integer, allow_neg) { //**/
	//Calc spoke lengths for both sides. Used by Build_Wheel() & onchange of OSB & SHD.

	//If no rim and no flangees, can't build any spokes, as they'd be 0 length...
	if (($NR.value*1 < 1) || ($ERD.value == 0 && $PCD[1].value == 0 && $PCD[2].value == 0)) { return false; }

	if (validate) {
		if (!Validate_Input($changed, integer, allow_neg)) { return false }
		$changed.prior_value = $changed.value; //Also set in onfocus events and in Build_Wheel().
	}

	//Based on spoke 1...
	Update_Advanced_Info(validate); //if (validate == true) also saves settings

	if (side == 1 || side == 2) { Output_Spoke_Lengths(side); }
	else {
		Output_Spoke_Lengths(1);
		Output_Spoke_Lengths(2);
	}
}//end Calc_Spoke_Lengths() //*************************************************/




function Output_Spoke_Lengths(side) { //***************************************/

	var spoke_lengths   = [];
	spoke_lengths[side] = [];

	var nf = $NF[side].value * 1; //Number of holes in flange = number of spokes this flange.

	//Calc spoke lenghts...
	for (var spoke = 1; spoke <= nf; spoke++) { spoke_lengths[side][spoke] = Calc_Spoke_Length(side, spoke, 1); }

	var spokes_1_2_diff = (nf > 1 && spoke_lengths[side][1] != spoke_lengths[side][2]); //at least two diff spoke sizes.
	var spokes_1_3_diff = (nf > 2 && spoke_lengths[side][1] != spoke_lengths[side][3]); //at least three diff spoke sizes.

	//If no rim or flange holes, no spoke...
	if (typeof spoke_lengths[side][1] != 'undefined') {
		$SL[side].innerHTML = spoke_lengths[side][1]; //SPOKE_LENGTH[flange][hole] (counting from 1)
	}

	//Output spoke lengths...
	//More than one spoke length per side? (Only checks first three spokes per side.)
	if (spokes_1_3_diff) { //Three or more diff lengths, so show 'em all.
		for (var spoke = 2; spoke <= nf; spoke++) { $SL[side].innerHTML += "<br>" + spoke_lengths[side][spoke]; }
	}
	else if (spokes_1_2_diff) { //Only two diff lengths.
		$SL[side].innerHTML += "<br>" + spoke_lengths[side][2];
	}
}//end Output_Spoke_Lengths() //***********************************************/




function Spoke_Length_Calculator(f) { //***************************************/
	//Tradtional method for basic wheel lacings. Not currently used within except for dev.
	//Not valid for some paired hole, some skip hole, and maybe other configurations.
	//That is, this function only calcs one length, based on spoke 1 (laced to holes 1 in rim & hub),
	//and some lacing patterns produce two spoke lengths per side (or more for really esoteric patterns).

	var ftc = $FTC[f].value*1; //Final spoke length requires Flange to Center
	var osb = $OSB[f].value*1; //and OSB...
	var w = ftc + osb;

	var aR  = 360/$NR.value;    //angle between holes in Rim.
	var aF  = 360/$NF[f].value; //angle between holes in Flange.

	//"zero cross" adjustment angle for triplets. Fails for some skip-hole configs, so I've read. Don't know why.
	//Valid if flange1 spokes + flange2 spokes == rim holes.
	if (($NR.value % $NF[f].value) == 0) { var a0 = 0 } else { var a0  = aR - aF/2; }

	var rR  = $ERD   .value/2;  //radius of Rim
	var rF  = $PCD[f].value/2;  //radius of Flange
	var aF1 = $SX[f].value*aF + $LACE_OPT.value*a0; //angle to spoke hole in flange from "vertical".
	var aF1_rad = aF1/180 * Math.PI; //aF1 in radians
	var cos_aF1 = Round(Math.cos( aF1_rad ), 4);

	var S = Math.sqrt(w*w + rR*rR + rF*rF - 2*rR*rF*cos_aF1) - $SHD.value/2;

	return Round(S, 1);
}//end Spoke_Length_Calculator() { //******************************************/




function Create_Spoke_Holes($hole_group, base_id, N, scale, shd, side, offset) { //***/
	//Create & position N spoke holes in <g id=group>, with radius of shd/2 (shd="spoke hole diameter")
	if (typeof offset == "undefined") { offset = 0 }

	var A = 360/N; //angle between holes
	var a_current = offset;	//angle to current hole from 0

	var cx, cy;		//coordinates for hole
	var odd = true;	//for alternating classes
	var holes = "";

	//Paired-Hole Rim & Hub specific stuff
	var phh      = ($WHEEL_TYPE.value == "phh" || $WHEEL_TYPE.value == "phh_phr");
	var phr      = ($WHEEL_TYPE.value == "phr");
	var phh_phr  = ($WHEEL_TYPE.value == "phh_phr");
	var custom   = ($WHEEL_TYPE.value == "custom");
	var ph_angle = 0; //Used for ph hubs & ph rims.
	if (phh || custom) {
		if ($hole_group != $HOLES_RIM) { var ph_angle = (parseFloat($PHHA[side].value) - A); }
	}
	if (phr || phh_phr || custom) {
		if ($hole_group == $HOLES_RIM) { var ph_angle = (parseFloat($PHRA.value) - A); }
	}

	//Create the holes...
	for (var sh = 1; sh <= N; sh++) {
		var full_id = base_id + sh;
		var classes = base_id;
		
		cx = Math.sin( (a_current/180) * Math.PI) * scale;
		cy = Math.cos( (a_current/180) * Math.PI) * scale;
		
		holes += '<circle id=' + full_id + ' class="' + base_id + '" r="' + (shd/2) + '" cx="' + cx +'" cy="' + cy + '" />' + "\n";
		
		a_current += (A + ph_angle); //Spoke hole 1 is first hole at or after 0 degrees.
		ph_angle *= -1;  //For alternating spoke directions...
	}

	$hole_group.innerHTML = $hole_group.innerHTML + holes;
}//end Create_Spoke_Holes() //*************************************************/




function Generate_Spoke_Hole_Info_Click_Events() { //**************************/
	var hole_classes = "." + RIM_HOLES + ", ." + HUB_HOLES[1] + ", ." + HUB_HOLES[2];
	var spoke_holes = D.querySelectorAll(hole_classes);
	
	for (item = 0; item < spoke_holes.length; item++) {
		var id = spoke_holes[item].id;
		//In HTML, SVG, etc, screen coordinates start in the upper left, so y increases down.
		//So, to produce natural coordinates (y increases up), y is set to -y below.
		//Also, avoid scientific notation when values get below 1x10-13. ex: "1.1234567890123456e-14"
		//So, round to "only" 1x10-13 places so numbers are represented "normally", ie: .0000000000001
		var x =   Math.round(spoke_holes[item].getAttribute("cx") * 1000000000000) / 1000000000000;
		var y = - Math.round(spoke_holes[item].getAttribute("cy") * 1000000000000) / 1000000000000;
		var r =   Math.round(Math.sqrt(x*x + y*y) * 1000000000000 ) / 1000000000000;
		var radians = Math.asin( y / r );
		var degrees = Round(radians * 180.0 / Math.PI, 3);
		var attribute_list = "id = " + id + "<br>x = " + Round(x,2) + "<br>y = " + Round(y,2) + "<br>angle = " + degrees + "&deg;";
		attribute_list += "<br>" + MSGS.data1;
		(function($spoke_hole, attribute_list) { 
			$spoke_hole.onclick = function() { Show_Message(false, attribute_list); $PRIOR_FOCUS = ""; }
		})(spoke_holes[item], attribute_list);
	}
}//end Generate_Spoke_Hole_Info_Click_Events() //******************************/




function Add_Spoke(group, flange, hub_hole, rim_hole) { //*********************/

	if (typeof $SPOKE_COLOR[group].value == "undefined") { $SPOKE_COLOR[group].value = "black" }

	var hub_hole_id = HUB_HOLES[flange] + hub_hole;
	var rim_hole_id	= RIM_HOLES + rim_hole;

	//Shouldn't happen anymore, but when it does anyway...
	if (E(hub_hole_id) == null || E(rim_hole_id) == null) {
		var msg  = "No Rim or Flange hole. Can't add spoke.<br>";
			msg += "Rim Holes: " + $NR.value + "<br>";
			msg += "Flange 1 Holes: " + $NF[1].value + "<br>";
			msg += "Flange 2 Holes: " + $NF[2].value + "<br>";
		    msg += "rim_hole_id: " + rim_hole_id + "<br>";
			msg += "hub_hole_id: " + hub_hole_id;
		Show_Message('', msg);
		return false;
	}

	var x1 = E(hub_hole_id).getAttribute('cx');
	var y1 = E(hub_hole_id).getAttribute('cy');
	var x2 = E(rim_hole_id).getAttribute('cx');
	var y2 = E(rim_hole_id).getAttribute('cy');

	var spoke_id = SPOKE_ID_PREFIX + flange + "_" + hub_hole;
	var classes = SPOKE_BASE_CLASS + ' ' + SPOKE_GROUP_PREFIX + group; //ex: 'SC2_spoke SC2_group1'
	var coords = ' x1="' + x1 +  '" y1="' + y1 +  '" x2="' + x2 +  '" y2="' + y2 +  '" ';
	var style = ' style="stroke:' + $SPOKE_COLOR[group].value + '"';

	var spoke = '<line id="' + spoke_id + '" class="' + classes+ '" ' + coords + style + '/>' + "\n";
	$SPOKES[flange].innerHTML += spoke;

}//end Add_Spoke() //**********************************************************/




function Lacing_Modifier(f) { //*************************************************/
	/****************************************************../
	tl;dr: It's complicated...  :) 

	"Full" Explanation:
	In a triplet wheel, with a given spoke count & cross (just whether they're even/odd),
	there are two lace patterns possible: "Type 1" and "Type 2".  In wheels with standard 
	lace patterns (2x, 3x, etc), the two pattern types end up just being mirror images of 
	one another. 

	Well, those three options: even/odd spoke count, even/odd spoke cross, and lace type,
	presents us with a three body quatum paradoxical muonicly gravitational relativistic 
	generational equatorial anti-matter plasmatic teseract.  And the effort to solve it 
	cost me many hours & much pounding of my head against a cinder block wall.
	Yes, many brain cells died to bring us this informtaiton...

	Anyway, for a consistent display of the wheel (spokes don't keep changing direction),
	and to determine the matching rim hole for a given flange hole, a modifier is needed,
	either 1 or -1, depending on the desired lacing type & other two conditions.
	But it's not always the same. And sometimes it's different, except when it's not...

	Anyanyway, all 8 possible combinations (3 "bits": count, cross, type) and their resultant modifers are
	summerized in the table below. 

	 NR SX T|          NR: Even or Odd Number of holes in the Rim
	 -------+--        SX: Even or Odd Spoke Cross
	 E  E  1|          T : Triplet/Lacing Type (1 or 2)
	 O  E  1| M        M : Resultant Modifier (1 or -1)
	 E  O  2| 1
	 O  O  2|
	 -------+--     \ | /    | | |
	 E  O  1|        \|/     | | |   (The "middle spoke" is on the opposite flange.)
	 O  O  1| M       X      | | |  
	 E  E  2|-1      /|\     | | |  
	 O  E  2|       Type 1   Type 2 

	Now, in basic spoke calc math, it's much simpler, because all that matters is spoke cross - we
	don't care about the voodoo involved in determining matching spoke holes in space.  But here,
	holes matter. And space.  And time.  I think. Maybe. I guess.  I don't know.  But it works now!  :)

	Finally, in this program, this option is presented as "Lacing Option".  Also, it really only matters
	on the side with more spokes (ex: the 16 spoke side of an 8:16 triplet), because the side with 8
	spokes is laced radially.
	/******************************************************/


	var NRE = ($NR.value    % 2  == 0); // Even number of rim holes?
	var SXE = ($SX[f].value % 2  == 0); // Even Spoke cross?
	var T1  = ($LACE_OPT.value   == 1); // Triplet/Lacing Type 1?

	if ( (NRE && SXE && T1) || (!NRE && SXE && T1) || (NRE && !SXE && !T1) || (!NRE && !SXE && !T1) )
		 { return  1 }
	else { return -1 }
}//end Lacing_Modifier() //******************************************************/




function Custom_Odd_NF(nf) { //************************************************/
	//Check if odd number of flange holes. Used while in "custom" mode.
	
	if ( (($WHEEL_TYPE.value == "custom") && (nf%2 != 0)) ) { return true; }
	return false;
}//end Custom_Odd_NF() { //****************************************************/




function Create_Spoke_Groups(g1, g2, nr, nf, sx, f) { //***********************/
	sx = Math.floor(sx);

	if ((nr < 1) && (nf < 1)) { return } //can't lace a spoke with no rim or flange holes...
	//if (nf < 1) { return } //can't lace a spoke with no flange holes...

	var gn = g1; //Used to toggle between g1 & g2
	var d  = 1;  //Direction. ie: leading or trailing spokes.

	if (Custom_Odd_NF(nf) && f == 2 ) { d = -1 }

	var r_skip = nr/nf; //Normally 2, but can be 3 (flange 1), then 3/2 (flange 2) for triplets.
	var r_hole = 0; //index to matching rim hole for a given hub hole.

	//Flange 1 hole 1 aligns to rim hole 1.  Flange 2 hole 1 aligns to rim hole 2 (generally, if NF[1] <= NF[2])...
	if (f == 2) { var f_skip = r_skip/2 } else { var f_skip = 0 }

	var prima_lacing = ($PRIMA_LACING.checked && $WHEEL_TYPE.value == 'custom');

	for (var h_hole = 1; h_hole <= nf; h_hole += 1) {
		
		r_hole = (h_hole-1 + sx*d*Lacing_Modifier(f)) * r_skip + 1 + f_skip
		r_hole = Round(r_hole) //Needed for triplets. I don't like it, but can't figure out another way...
		
		if (prima_lacing) { //swap holes...
			if (f == 1 && d == -1) { r_hole++ } else
			if (f == 2 && d == -1) { r_hole-- }
		}
		
		//The while loop is needed for custom mode,
		//with Cross == NR, and NF[1]+NF[2] >= NR.  Or, if Cross == NR-1, & NR <= 2...
		while (r_hole > nr) { r_hole -= nr; }
		if (r_hole <  1) {r_hole += nr;}
		Add_Spoke(gn, f, h_hole, r_hole);
		
		if (gn == g2) { gn = g1 } else { gn = g2 }
		
		//toggle direction, aka leading/trailing spokes.
		if (!Custom_Odd_NF(nf)) { d = -d; }
		//else { all spokes on side with odd spoke count laced same direction.}
	}
}//end Create_Spoke_Groups() //************************************************/




function Make_Rim(save) { //***************************************************/
	//Adjust displayed rim radius so that with "deep" rims, (stroke-width > SPOKES_RECESSED),
	//spoke ends stay near the inner radius, not in the middle of the "rim".
	//This produces a slightly more realistic looking rim/wheel.
	//     ---------------------------              ---------------------------
	// This                             instead of     *         *         *
	//     ---*---------*---------*---              ---|---------|---------|---
	//        |         |         |                    |         |         |
	//        |         |         |                    |         |         |
	if ($ERD.value == 0) { return false; }
	var rim_width = $RIM_LINE_SIZE.value;
	var recess = SPOKES_RECESSED; //Amount spoke is "recessed" into rim, similar to a real wheel.
	if (rim_width < (recess*2)) { var rim_radius = $ERD.value/2; }
	else               { var rim_radius = $ERD.value/2 + rim_width/2 - recess; }
	$RIM.setAttribute('r', rim_radius);
	$RIM.style['stroke'] = $RIM_COLOR.value;
	$RIM.style['stroke-width'] = rim_width;

	if (save) { Save_Settings("wheel"); }
}//end Make_Rim() { //*********************************************************/




function Setup_Wheel(erd, nr, nf1, nf2, pcd1, pcd2, sx1, sx2, shdr, shdf1, shdf2) { /***/
	//shd[r,f1,f2], as used here, and in Create_Spoke_Holes(), only affects
	//the displayed spoke hole size, and not spoke length calcs.

	var AR  = 360/nr;  //Angle between holes in Rim.
	var AF1 = 360/nf1; //Angle between holes in Flange 1.
	var AF2 = 360/nf2; //Angle between holes in Flange 2.
	var frot1 = 0;     //Only used with ph hubs.
	var frot2 = AF2/2; //Normal angle between left & right hub flange holes.

	var phh     = ($WHEEL_TYPE.value == "phh" || $WHEEL_TYPE.value == "phh_phr");
	var phr     = ($WHEEL_TYPE.value == "phr");
	var phh_phr = ($WHEEL_TYPE.value == "phh_phr");
	var custom  = ($WHEEL_TYPE.value == "custom");

	//Paired-Hole Hub & Flange Rotation setup...
	var offset_phha1 = 0; //standard or triplets
	var offset_phha2 = 0;
	if (phh || custom) {
		offset_phha1 = (AF1 - parseFloat($PHHA[1].value))/2;
		offset_phha2 = (AF2 - parseFloat($PHHA[2].value))/2;
		frot1 = parseFloat($ROTF.value) / 2;
		frot2 = frot2 - frot1;
	}

	//Paired-Hole Rim & Rim Rotation setup...
	var offset_phra = 0; //standard or triplets
	if ( (nr > 0) && (phr || phh_phr || custom) ) {
		offset_phra = (AR - parseFloat($PHRA.value))/2;
	}

	//Rim Rotation setup...
	var rrot = 0;
	if (custom) {
		rrot = parseFloat($ROTR.value);
		if (isNaN(rrot)) { $ROTR.value = rrot = 0; Save_Settings("wheel"); }
	}

	//Draw basic flange circles...
	$FLANGE1.setAttribute('r', pcd1/2); //erd & pcd's are diameters, but SVG <circle>'s require radii...
	$FLANGE2.setAttribute('r', pcd2/2); //

	Create_Spoke_Holes( $HOLES_RIM    , RIM_HOLES   , nr , erd/2 , shdr , 0, offset_phra + rrot);
	Create_Spoke_Holes( $FLANGE1_HOLES, HUB_HOLES[1], nf1, pcd1/2, shdf1, 1, (offset_phha1 + frot1));
	Create_Spoke_Holes( $FLANGE2_HOLES, HUB_HOLES[2], nf2, pcd2/2, shdf2, 2, (offset_phha2 + frot2));

	Generate_Spoke_Hole_Info_Click_Events();

	if (nr > 0) {
		if (nf1 > 0) { Create_Spoke_Groups(1, 2, nr, nf1, sx1, 1); } //Side 1
		if (nf2 > 0) { Create_Spoke_Groups(3, 4, nr, nf2, sx2, 2); } //Side 2
	}

	Set_Styles_Spokes();
	Set_Styles_Rim_etc(); //Also calls Make_Rim()...
}//end Setup_Wheel() /*********************************************************/




function Set_Styles_Spokes() { //****************************************/
	for (var group = 1; group <= 4; group++) {
		Set_Style_by_Class( SPOKE_GROUP_PREFIX + group, "stroke-width", $SPOKE_LINE_SIZE[group].value);
		Set_Style_by_Class( SPOKE_GROUP_PREFIX + group, "stroke"      , $SPOKE_COLOR[group].value);
		Show_Hide_Class( SPOKE_GROUP_PREFIX + group, $SPOKE_SHOW[group].checked);
	}

	Set_Style_by_Class( AXIS_CLASS, 'stroke-width', $AXES_LINE_SIZE.value );
	Set_Style_by_Class( AXIS_CLASS, "stroke", $AXES_COLOR.value );
	Show_Hide_Class( AXIS_CLASS, $AXES_SHOW.checked );
}//end Set_Styles_Spokes() { //******************************************/




function Set_Styles_Rim_etc() { //***************************************/

	Make_Rim(); //Rim line size affects displayed rim radius.

	$FLANGE1.style['stroke'] = $F1_COLOR.value;
	$FLANGE2.style['stroke'] = $F2_COLOR.value;
	$FLANGE1.style['stroke-width'] = $F1_LINE_SIZE.value*1;
	$FLANGE2.style['stroke-width'] = $F2_LINE_SIZE.value*1;

	Set_Style_by_Class(RIM_HOLES   , "fill", $HOLES_RIM_COLOR.value);
	Set_Style_by_Class(HUB_HOLES[1], "fill", $HOLES_F1_COLOR.value);
	Set_Style_by_Class(HUB_HOLES[2], "fill", $HOLES_F2_COLOR.value);

	Set_Attribute_by_Class( RIM_HOLES   , 'r', $HOLES_RIM_SIZE.value/2);
	Set_Attribute_by_Class( HUB_HOLES[1], 'r', $HOLES_F1_SIZE.value/2); //set *radius* of holes (this.value/2)
	Set_Attribute_by_Class( HUB_HOLES[2], 'r', $HOLES_F2_SIZE.value/2); //set *radius* of holes (this.value/2)

	Show_Hide_Class(RIM_HOLES   , $HOLES_RIM_SHOW.checked);
	Show_Hide_Class(HUB_HOLES[1], $HOLES_F1_SHOW.checked);
	Show_Hide_Class(HUB_HOLES[2], $HOLES_F2_SHOW.checked);

	Show_Hide($RIM    , $RIM_SHOW.checked);
	Show_Hide($FLANGE1, $F1_SHOW.checked);
	Show_Hide($FLANGE2, $F2_SHOW.checked);
}//end Set_Styles_Rim_etc() { //*****************************************/




function Clear_Wheel(all) { //*************************************************/
	//Clear built (displayed) wheel, not wheel settings, in prep for a re-build with current/new settings.

	if (all){
		$RIM    .setAttribute('r', 0);
		$FLANGE1.setAttribute('r', 0);
		$FLANGE2.setAttribute('r', 0);
	}
	
	if (all || ($WHEEL_TYPE.value != "custom")) {
		$FLANGE1_HOLES.innerHTML = "";
		$FLANGE2_HOLES.innerHTML = "";
	}

	$HOLES_RIM.innerHTML = "";
	$SPOKES[1].innerHTML = "";
	$SPOKES[2].innerHTML = "";
	$SL[1].innerHTML = ''; //side 1, odd spokes
	$SL[2].innerHTML = ''; //side 2, odd spokes
	$SL_ADJ[1].value = ""; //Spoke lengths adjusted for elbows in/out.
	$SL_ADJ[2].value = ""; //
	$SPOKE_RATIO[1].value = '';
	$SPOKE_RATIO[2].value = '';
	$BRACE_ANGLE[1].value = '';
	$BRACE_ANGLE[2].value = '';
	$TENSION_RATIO[1].value = '';
	$TENSION_RATIO[2].value = '';
	$TENSION[1].value = ''; //[1] is a user setting, and is cleared in Clear_Settings().
}//end Clear_Wheel() //********************************************************/




function Build_Wheel(save) { //************************************************/

	if (save) { Save_Settings("wheel"); }

	Clear_Wheel(true);

	//If no rim and no flangees, can't build any spokes, as they'd be 0 length...
	if ($ERD.value == 0 && $PCD[1].value == 0 && $PCD[2].value == 0) { return false; }

	//Setup_Wheel(ERD, NR, NF1, NF2, PCD1, PCD2, SX1, SX2, SHD-R, SHD-F1, SHD-F2) //Here, SHD's are display values, not acutal.
	Setup_Wheel( $ERD.value*1, $NR.value*1, $NF[1].value*1, $NF[2].value*1,
				 $PCD[1].value*1, $PCD[2].value*1, $SX[1].value*1, $SX[2].value*1,
				 $HOLES_RIM_SIZE.value*1, $HOLES_F1_SIZE.value*1, $HOLES_F2_SIZE.value*1
				);

	Calc_Spoke_Lengths(); //and Update_Advanced_Info();
}//end Build_Wheel() //********************************************************/




function Show_Message($input, msg, init, width) {//*****************************/
	//$input: input element with invalid input.

	if ($input) { //Position $MSG_BOX just below $input.
		var coords = $input.getBoundingClientRect();
		$MSG_BOX.style['top']  = Round(coords.top)  + window.pageYOffset + "px";
	}

	if ((typeof msg) == 'undefined') { msg = "" }

	if ((typeof $input == "object") && ($input.tagName == "INPUT") && (init != "init")) {
		msg = MSGS['invalid'] + ' "' + $input.value + '"<br>' + msg;
	}
	
	if (width) { $MSG_BOX.style.width = width; }
	else       { $MSG_BOX.style.width = ''   ; }

	$MESSAGE_DIV.innerHTML = msg;
	$MSG_BOX.style['visibility'] = "visible"; 

	if (init == "init") {
		//Set a couple styles just for init. Reset in Close_Message().
		$MSG_BOX.style['text-align'] = "left";
		$MSG_BOX.style['top']  = (window.pageYOffset + 50) + "px";
		$MSG_BOX.style['left'] = (window.pageXOffset + 50) + "px";
		$CLOSE_MSG.style['visibility'] = "hidden";
		$ACCEPT_MSG.style['display']   = "";
		$ACCEPT_MSG.focus();
	}
	else {
		$CLOSE_MSG.style['visibility'] = "";
		$ACCEPT_MSG.style['display'] = "none"; 
		//setTimeout needed when changing wheel "Type", if there's a msg. I don't know why.
		setTimeout(function() { $CLOSE_MSG.focus() },55);
	}
}//end Show_Message() //*******************************************************/




function Close_Message() { //**************************************************/
	$MSG_BOX.style['visibility'] = "hidden";
	$MESSAGE_DIV.innerHTML = "";
	if ($PRIOR_FOCUS) { $PRIOR_FOCUS.focus(); }
	$MSG_BOX.style['text-align'] = ""; //Restore values to style sheet from those 
	$MSG_BOX.style['top']        = ""; //used for the init msg/disclaimer.
	$MSG_BOX.style['left']       = "";
}//end Close_Message() { //****************************************************/




function Set_SX() { //*********************************************************/
	//Set practical default cross values for most flange hole counts, even impractical ones.
	//User can change SX manually if desired.

	if ($WHEEL_TYPE.value == "custom") { return; }

	if ($NF[2].value*1 <  4) { $SX[2].value = 0 } else
	if ($NF[2].value*1 < 10) { $SX[2].value = 1 } else
	if ($NF[2].value*1 < 16) { $SX[2].value = 2 } else
	if ($NF[2].value*1 < 20) { $SX[2].value = 3 } else
	if ($NF[2].value*1 < 26) { $SX[2].value = 4 } else
	if ($NF[2].value*1 < 36) { $SX[2].value = 5 } else
							 { $SX[2].value = 6 }
	
	if ($WHEEL_TYPE.value == "triplet") { $SX[1].value = 0; }
	else                                { $SX[1].value = $SX[2].value; }
}//end Set_SX() { //***********************************************************/




function Set_NF(NR) { //*******************************************************/
	//Set cooresponding NF's required for a given NR.
	//Do not call while *in* "custom" mode.
	NR = NR * 1;

	$NF[1].prior_value = $NF[1].value;
	$NF[2].prior_value = $NF[2].value;

	if ($WHEEL_TYPE.value == "custom") { return; }

	if ($WHEEL_TYPE.value == "triplet") {
		$NF[1].value = NR / 3;
		$NF[2].value = $NF[1].value * 2;
	} else {
		$NF[1].value = NR / 2;
		$NF[2].value = NR / 2;
	}

	//For Standard & Triplet modes
	$NF[1].disabled = true;
	$NF[2].disabled = true;
}//end Set_NF() { //***********************************************************/




function SX_Enable_Disable(f) { //*********************************************/
	//Generally, spoke cross must be 0 if NF is odd.

	if ($WHEEL_TYPE.value == "custom") { return }

	if ($NF[f].value%2 == 0)	{ //even hole count
		$SX[f].disabled = false;
	}
	else {						  //odd
		$SX[f].disabled = true;
		$SX[f].value = 0;
	}
}//end SX_Enable_Disable() { //************************************************/




function Validate_NR() { //****************************************************/
	//Acutal validation of NR is no longer needed (NR is now a <select>), but some other checks are.

	Set_NF($NR.value);

	Build_SX_Options($WHEEL_TYPE.value, 1, $NF[1].value, $SX[1].value);
	Build_SX_Options($WHEEL_TYPE.value, 2, $NF[2].value, $SX[2].value);

	Set_SX();

	//If NF is odd, cross can only be 0. (Except in "custom" mode.)
	SX_Enable_Disable(1);

	//In paired hole hubs, SX must be the same, so spokes don't cross over paired holes.
	if ($WHEEL_TYPE.value == 'phh') { $SX[2].disabled = true; }
	else                            { SX_Enable_Disable(2);   }

	if ($NR.value*1 > 0) { return true } //Build_Wheel() on return

	//Else if NR==0, clear the spokes, rim holes, & various spoke length results.
	$NR.prior_value = $NR.value;

	Clear_Wheel(); //all except the rim & flanges, and the flange holes if in custom mode.

	Save_Settings("wheel");

	return false; //No spokes, so can't Build_Wheel().

}//end Validate_NR() { //******************************************************/




function Validate_NF(f) { //***************************************************/
	var error = false;

	if (isNaN($NF[f].value)) { $NF[f].value = $NF[f].prior_value; return false; }

	if ($NF[f].value*1 > MAX[$NF[f].id]) {
		var msg = MSGS['max_fl'] + MAX[$NF[f].id] + ".<br>";
		error = true;
	}

	//##### Figure out how to make this not needed (improve how flange-rim holes are matched up).
	if ( $NF[1].value*1 > $NF[2].value*1) { //Things mess up...
		if (f==1) { var msg = MSGS['nf1_2']; }
		else 	  { var msg = MSGS['nf2_1']; }
		error = true;
	}

	if (error) {
		Show_Message($NF[f], msg);
		$NF[f].value = $NF[f].prior_value;
		return false;
	}

	Build_SX_Options($WHEEL_TYPE.value, f, $NF[f].value, $SX[f].value);
	SX_Enable_Disable(f);

	$NF[f].prior_value = $NF[f].value;
	return true;
}//end Validate_NF() //********************************************************/



function Validate_PH_Angle($pha, $nr_or_nf, min, max, allow_neg) { //**********/
	//min & max are relative to angle of even spaced holes.

	if (Validate_Input($pha, false, allow_neg)) {
		var angle = parseFloat($pha.value);
		var min_angle = 360 / parseFloat($nr_or_nf.value) * min;
		var max_angle = 360 / parseFloat($nr_or_nf.value) * max;
		if (angle < min_angle) { $pha.value = min_angle; } else
		if (angle > max_angle) { $pha.value = max_angle; }
		return true;
	}
	return false;
}//end Validate_PH_Angle() //**************************************************/




function Validate_PH_Distance($phd, $nr_or_nf, $pcd_or_erd, allow_neg) { //****/
	//Distances that produce angles larger than 1/2 of the angles for evenly spaced holes
	//just mirrors effects up to that point, but in phh's, also crosses the spokes of paired holes in PHH. Which is bad.

	var pcd_or_erd = parseFloat($pcd_or_erd.value);

	//Validate_Input($phd, integer, allow neg)
	if (Validate_Input($phd, false, allow_neg)) {
		if (pcd_or_erd < 0) { var neg = -1; } else { var neg = 1; }
		
		if ($WHEEL_TYPE.value == "custom") { if (parseFloat($phd.value) > pcd_or_erd) { $phd.value = pcd_or_erd; }}
		else {
			var distance      = parseFloat($phd.value);
			var even_radians  = 2 * Math.PI / parseFloat($nr_or_nf.value);;
			var evenly_spaced = Math.sin(even_radians/2) * pcd_or_erd;
			if (Math.abs(distance) > evenly_spaced) { $phd.value = evenly_spaced * neg; }
		}
		return true;
	}
	return false;
}//end Validate_PH_Distance() //***********************************************/




function Validate_Input($input, integer, allow_neg, low_value, high_value) { //**/
	var error = false;

	$input.value = $input.value.trim();
	var input = $input.value; 

	if (input == "") { value = 0; } 
	else {
		if (integer) { input = parseInt(input); }
		else 		 { input = parseFloat(input); }
	}

	if (isNaN(input)) { error = true; } else 
	if ((typeof  low_value != 'undefined') && (input <  low_value)) { error = true; } else
	if ((typeof high_value != 'undefined') && (input > high_value)) { error = true; } else
	if (!allow_neg && (input < 0)) { error = true; }

	if (error) {
		if (isNaN(parseFloat($input.prior_value))) { $input.prior_value = ""; }
		$input.value = $input.prior_value;
		return false;
	}

	$input.value       = input;
	$input.prior_value = $input.value;
	return true;
}//end Validate_Input() { //***************************************************/




function Draw_Axis() { //******************************************************/
	//Create xy axis                                           _______
	//Draws each x & y axis in two parts, starting from 0,    |   |   |
	//and extending out to the edge of the view box.          |---+---|
	//Visually, this creates a static axis from 0.            |___|___|
	//Otherwise, when starting from edges, the dashes at (0,0) vary depending on zoom level.
	//    (Well, they did with the original zoom method.)
	var viewport_H = $WHEEL_CONTAINER.clientHeight; //Visible height of container's content, inside borders & excluding scrollbars.
	var view_box = $SVG_WHEEL.getAttribute('viewBox')

	if (view_box) { //            viewBox.split(" ") =              [0]            [1]       [2]     [3]
		     var view_box_size = view_box.split(" ")[3]; // [horizontal_offset,  v_offset,  width,  height]
	} else { var view_box_size = viewport_H; }
	
	var scale = (view_box_size / viewport_H) / ($SCALE_text.value / 100);
	var max_XY = view_box_size/2;
	var axis_line_width = $AXES_LINE_SIZE.value * scale;
	var axis_dash = 4 * scale;             //##### Abstract out the 4?

	var $axis = [$X_axis1, $X_axis2, $Y_axis1, $Y_axis2];
	var x1    = [       0,        0,        0,        0]; //   _______     _______     _______     _______
	var y1    = [       0,        0,        0,        0]; //  |       |   |       |   |       |   |   |   |
	var x2    = [  max_XY,  -max_XY,        0,        0]; //  |    ---|   |---    |   |       |   |       |
	var y2    = [       0,        0,   max_XY,  -max_XY]; //  |_______|   |_______|   |___|___|   |_______|

	for (var seg = 0; seg < 4; seg++) {
		$axis[seg].setAttribute('x1', x1[seg]);
		$axis[seg].setAttribute('y1', y1[seg]);
		$axis[seg].setAttribute('x2', x2[seg]);
		$axis[seg].setAttribute('y2', y2[seg]);
		
		//So the axis line thickness and dashes remains visually the same, regardless of zoom.
		$axis[seg].style.strokeWidth = axis_line_width;
		$axis[seg].style.strokeDasharray = axis_dash + "," + axis_dash;
	}
}//end Draw_Axis() //**********************************************************/




function Set_Scale() { //******************************************************/
	//Percentage to set the wheel's width & height. From 20 to 2000.
	var level = $SCALE_text.value * 1;

	//Vertically center wheel when scale is < 100 using marginTop.
	//(Horizontal center accomplished via css...)
	//At 100 (%),wheel height == container height.
	//Scale "level" is a percentage to set the wheel's width & height. 100% is the container's clientHeight.
	//$WHEEL_CONTAINER's height (including scrollbars & borders) is set in css to 665 (as of v2.15).
	//So, theoretically, the computed height (below) should be 665...
    var height = parseInt(window.getComputedStyle($WHEEL_CONTAINER, null ).getPropertyValue("height"));
	var margin_top = height/2 - (height * (level/100) / 2);
	$SVG_WHEEL.style.marginTop = 0;
	if (level < 100) { $SVG_WHEEL.style.marginTop = margin_top + 'px'; }

	$SVG_WHEEL.style.width  = level + "%";
	$SVG_WHEEL.style.height = level + "%";

	var scroll_H = $WHEEL_CONTAINER.scrollHeight; //Height of container's content.
	var client_H = $WHEEL_CONTAINER.clientHeight; //Visible height of container's content, inside borders & excluding scrollbars.
	$WHEEL_CONTAINER.scrollTop  = (scroll_H / 2) - (client_H / 2);
	$WHEEL_CONTAINER.scrollLeft = (scroll_H / 2) - (client_H / 2);//It's square, so height == width.

	Draw_Axis(client_H);
}//end Set_Scale() //**********************************************************/




function Setup_Viewbox() { //**************************************************/

	var erd  = $ERD.value*1;
	var rim  = $RIM_LINE_SIZE.value*1;
	var pcd1 = $PCD[1].value*1;
	var pcd2 = $PCD[2].value*1;
	if (erd < pcd1 || erd < pcd2) {
		if (pcd1 > pcd2) { erd = pcd1; } else { erd = pcd2; }
	}

	var view_box_size = (erd + rim*2 + 5); //The + 5 adds a small margin between the wheel & edges.

	//Setup viewBox & <svg wheel> sizes.
	var offset = (-view_box_size/2);  // H              V                width                height
	$SVG_WHEEL.setAttribute('viewBox', offset + " " + offset + " " + view_box_size + " " + view_box_size);

	Set_Scale();
}//end Setup_Viewbox() { //****************************************************/




function Show_Hide_Class(classname, show, save, style) { //********************/
	//save must either be 'display', 'wheel', or falsey (undefined/not used).
	//style should be either 'visibility' or 'display'.  Default is 'display' if style != 'visibility'.
	var items = D.getElementsByClassName(classname);
	for (var s = 0; s < items.length; s++) { Show_Hide(items[s], show, false, style) }
	if (save) { Save_Settings(save); }
}//end Show_Hide_Class() //****************************************************/

	


function Show_Hide($what, show, save, style, value) { //***********************/

	if (typeof value == 'undefined') { value = ""; }

	if (style == 'visibility') {
		if (show) { $what.style.visibility = value    }
		else 	  { $what.style.visibility = "hidden" }
	}
	else {
		if (show) { $what.style.display = value  }
		else 	  { $what.style.display = "none" }
	}

	if (save) { Save_Settings("display"); }
}//end Show_Hide() //**********************************************************/




function Scroll_Into_View(target, extra) { //**********************************/
	//Only scroll if target display is !=none, and 
	//if the top of the element is not visible in the window.

	if (target.style['display'] == "none") { return; }

	var rect = target.getBoundingClientRect();

	//window contents scroll down if off the top...
    if (rect.top < extra) { window.scrollBy(0, rect.top - extra); return; }


	var viewable_amount = window.innerHeight - rect.top;
	var min_top_visible = 150; //Scroll this much of element into view, if less than this amount.

	//window contents scroll up if off the bottom...
    if (viewable_amount < min_top_visible) { window.scrollBy(0, min_top_visible - viewable_amount); }

}//end Scroll_Into_View() { //*************************************************/




function Set_Style_by_Class(classname, style, value, save) { //****************/
	var objects = D.getElementsByClassName(classname);
	for (var s = 0; s < objects.length; s++) { objects[s].style[style] = value; }
	if (save) { Save_Settings("wheel"); }
}//end Set_Style_by_Class() //*************************************************/




function Set_Save_Style(element, style, value) { //****************************/
	element.style[style] = value;
	Save_Settings("wheel");
}//end Set_Save_Style() //*****************************************************/




function Set_Attribute_by_Class(classname, attribute, value) { //**************/
	var objects = D.getElementsByClassName( classname );
	for (var x = 0; x < objects.length; x++) { objects[x].setAttribute( attribute, value ); }
}//end Set_Attribute_by_Class() //*********************************************/




function Set_phh_Lace_Opt() { //***********************************************/
	//With phh, the spokes in paired holes must pull away from each other, or the flange could fail.
	//So, set LACE_OPT, based on spoke cross (1, 2, 3, etc...), so that spokes in paired holes do not cross each other.
	//For absurdly low spoke count wheels (<12), this may be unneccessary, but deal with that in custom mode.
	if ($WHEEL_TYPE.value != "custom") { $SX[2].value = $SX[1].value; }
	var sx_even  = ($SX[1].value  % 2) == 0;
	if (sx_even) { $LACE_OPT.value = -1; } //Lace Option 2
	else         { $LACE_OPT.value =  1; } //Lace Option 1
}//end Set_phh_Lace_Opt() //***************************************************/




function Show_Hide_PH_Hub_Rim_Options(phh, phr, eso) { //**********************/

	if (phh || phr) {
		Show_Hide($ADVANCED_SETTINGS, true);
		Show_Hide($PHH_options, phh);
		Show_Hide($PHR_options, phr);
	}
	else { Show_Hide($ADVANCED_SETTINGS, false); }

	Show_Hide($ESO_options, eso); //only in custom mode

}//end Show_Hide_PH_Hub_Rim_Options() //***************************************/




function Set_Wheel_Type_Theme(wheel_type) { //*********************************/
	var items = document.querySelectorAll('.' + _NS_ + 'type_theme');
	for (var i = 0; i < items.length; i++) {
		items[i].classList.remove(_NS_ + "theme_standard");
		items[i].classList.remove(_NS_ + "theme_triplet");
		items[i].classList.remove(_NS_ + "theme_phh");
		items[i].classList.remove(_NS_ + "theme_phr");
		items[i].classList.remove(_NS_ + "theme_phh_phr");
		items[i].classList.remove(_NS_ + "theme_custom");
		items[i].classList.add(_NS_ + "theme_" + wheel_type);
	}
}//end Set_Wheel_Type_Theme() //***********************************************/




function Setup_and_Build(init) { //********************************************/
	$G_WHEEL.setAttribute('transform', " rotate(" + $ROTATE_WHEEL_text.value + ")");
	Setup_Type_and_Build(init);
	Setup_Viewbox();
}//end Setup_and_Build() { //**************************************************/




function Setup_Type_and_Build(init) { //***************************************/
	//Adjust/set NR, NF, & SX as needed for each type(mode).
	var NR = $NR.value*1;
	var NR_inc = 4; //Standard increment for NR options for most wheel types.

	$LACE_OPT.disabled = false; //For all except phh & phh_phr...

	if ($WHEEL_TYPE.value == "standard") {
		Show_Hide_PH_Hub_Rim_Options(false, false, false);
	} else
	if ($WHEEL_TYPE.value == "triplet") {
		var NR_inc = 3;  //NR must be divisible by 3
		Show_Hide_PH_Hub_Rim_Options(false, false, false);
	} else
	if ($WHEEL_TYPE.value == "phh") { //Set_phh_Lace_Opt() AFTER $SX[] in  if (!custom)  below.
		$LACE_OPT.disabled = true;
		Show_Hide_PH_Hub_Rim_Options(true, false, false);
	} else
	if ($WHEEL_TYPE.value == "phr") {
		Show_Hide_PH_Hub_Rim_Options(false, true, false);
	} else
	if ($WHEEL_TYPE.value == "phh_phr") {
		$LACE_OPT.disabled = true;
		Show_Hide_PH_Hub_Rim_Options(true, true, false);
	}


	//Preserve existing values before <option>s options are changed below (via innerHTML).
	var hub_auto_angles = $HUB_AUTO_ANGLES.value;
	var auto_rot = $AUTO_ROT.value;

	if ($WHEEL_TYPE.value != "custom") {
		//Validate NR in case we're switching between modes with different NR increments.
		var nr_mod_n = NR % NR_inc;
		if (nr_mod_n != 0) { NR += (NR_inc - nr_mod_n); } //"round up" if not div/NR_inc.
		
		Set_NF(NR); //Must come before $SX's are set.
		
		Build_SX_Options($WHEEL_TYPE.value, 1, $NF[1].value, $SX[1].value);
		Build_SX_Options($WHEEL_TYPE.value, 2, $NF[2].value, $SX[2].value);
		
		//Keep existing SX on load, but not if switching wheel types.
		if (init != "init") {
			Set_SX();
			SX_Enable_Disable(1);
			SX_Enable_Disable(2);
		}
		
		//Must come after Set_SX().
		//In paired hole hubs, SX must be the same, so spokes don't cross over paired holes.
		if ($WHEEL_TYPE.value == "phh" || $WHEEL_TYPE.value == "phh_phr") {
			Set_phh_Lace_Opt();
			$SX[2].disabled = true;

			$HUB_AUTO_ANGLES.innerHTML = HUB_AUTO_ANGLES_OPTS_COMMON;
			$AUTO_ROT_OPTS.innerHTML = AUTO_ROT_OPTS_COMMON;
		}
	}
	else { //custom...
		var f = 1;
		Build_SX_Options($WHEEL_TYPE.value, f, $NF[f].value, $SX[f].value);
		$NF[f].disabled = false;
		$SX[f].disabled = false;
		
		var f = 2;
		Build_SX_Options($WHEEL_TYPE.value, f, $NF[f].value, $SX[f].value);
		$NF[f].disabled = false;
		$SX[f].disabled = false;
		
		Show_Hide_PH_Hub_Rim_Options(true, true, true);
		
		$HUB_AUTO_ANGLES.innerHTML = HUB_AUTO_ANGLES_OPTS_CUSTOM;
		$AUTO_ROT_OPTS.innerHTML = AUTO_ROT_OPTS_CUSTOM;
	}

	Set_Wheel_Type_Theme($WHEEL_TYPE.value);

	Build_NR_Options($WHEEL_TYPE.value, MAX[$NR.id], NR); //Must come before Set_Auto_Angles() below.

	if ($WHEEL_TYPE.value == "phh" || $WHEEL_TYPE.value == "phh_phr" || $WHEEL_TYPE.value == "custom") {
	
		//$HUB_AUTO_ANGLES.innerHTML & $AUTO_ROT_OPTS.innerHTML may have changed above.
		$HUB_AUTO_ANGLES.value = hub_auto_angles; 
		$AUTO_ROT.value = auto_rot;
		
		if ($HUB_AUTO_ANGLES.selectedIndex < 0) { $HUB_AUTO_ANGLES.value = "off"; } //Default to "Manual" to
		if ($AUTO_ROT.selectedIndex < 0)        { $AUTO_ROT.value = "off";        } //preserve current values.
	
		Set_Auto_Angles_Hub();
		Set_Auto_Angles($RIM_AUTO_ANGLES, $PHRA, $PHRD, $ERD, $NR);
		Set_Auto_Rot();//Must come after Set_Auto_Angles(Rim...)
	}

	var saved_settings = localStorage.getItem(LS_VALUES_PREFIX + $CURRENT_WHEEL.value);

	if (saved_settings || init == "build") { Build_Wheel(); return true; }

	return false;
}//end Setup_Type_and_Build() { //*********************************************/




function Init_Show_Hide_Options(reset) { //************************************/
	//First reset button values
	if (reset) { Load_Clear_or_Get_Settings(DEFAULT_OPTIONS, "load"); }

	$WHEEL_OPTS      .style.display = $SHOW_WHEEL_OPTS.value;
	$FL_to_LN        .style.display = $SHOW_FL_to_LN.value;
	$PHH_OPTS        .style.display = $SHOW_PHH_OPTS.value;
	$PHR_OPTS        .style.display = $SHOW_PHR_OPTS.value;
	$ESO_OPTS        .style.display = $SHOW_ESO_OPTS.value;
	$ADVANCED_INFO   .style.display = $SHOW_HIDE_ADVANCED.value;
	$OTHER_CALCS	 .style.display = $SHOW_HIDE_OTHER.value;
	$NOTES           .style.display = $SHOW_HIDE_NOTES.value;
	$SCALE_ROTATE_OPTIONS.style.display = $SHOW_HIDE_SCALE.value;

	Set_Show_Button_Text($SHOW_WHEEL_OPTS, "+", "&minus;");
	Set_Show_Button_Text($SHOW_FL_to_LN  , "+", "-");
	Set_Show_Button_Text($SHOW_PHH_OPTS  , "+", "-");
	Set_Show_Button_Text($SHOW_PHR_OPTS  , "+", "-");
	Set_Show_Button_Text($SHOW_ESO_OPTS  , "+", "-");
	Set_Show_Button_Text($SHOW_HIDE_SCALE, "+", "&#215;", SCALE_ROTATE_OPEN);
	if ($SHOW_WHEEL_OPTS.value == "none") { $HEADER_OPTS.style.width = ""; }
	else                                  { $HEADER_OPTS.style.width = HEADER_OPTS_WIDTH; }
}//end Init_Show_Hide_Options() //********************************************/




function Reset_Scale_Rotate(save) { //*****************************************/
	Load_DEFAULT_VALUES_Scale_Rotate();
	Set_Scale();
	if (save) { Save_Settings("wheel"); }
}//end Reset_Scale_Rotate() //*************************************************/




function Reset_OPTIONS_SPOKES(save) { //***************************************/
	Load_DEFAULT_VALUES_Spokes();
	Set_Styles_Spokes();
	if (save) { Save_Settings("wheel"); }
	Draw_Axis();
}//end Reset_OPTIONS_SPOKES() //***********************************************/




function Reset_OPTIONS_RIM_ETC(save) { //**************************************/
	Load_DEFAULT_VALUES_Rim_etc();
	Set_Styles_Rim_etc();
	Setup_Viewbox();
	if (save) { Save_Settings("wheel"); }
}//end Reset_OPTIONS_RIM_ETC() //**********************************************/




function Set_Auto_Angles($auto_angles, $pha, $phd, $pcd_or_erd, $nf_or_nr) {//*/

	var auto_angles = $auto_angles.value;
	var spoke_holes = parseInt($nf_or_nr.value);

	//'off' is "Manual".  Nothing changes when changing to off/Manual.
	if (auto_angles == 'off' ) { ; } else
	if (spoke_holes > 0) { $pha.value = (360 / spoke_holes) * auto_angles; }
	else { $pha.value = 0 }

	Calc_PD_from_PA($phd, $pha, $pcd_or_erd);
}//end Set_Auto_Angles() //****************************************************/




function Set_Auto_Angles_Hub() { //********************************************/
	if ($WHEEL_TYPE.value == "custom") {
		$PHHA[2].disabled = false;
		$PHHD[2].disabled = false;
	}
	else { 
		$PHHA[2].disabled = true ;
		$PHHD[2].disabled = true ;
		$PHHA[2].value = $PHHA[1].value;
		Calc_PD_from_PA($PHHD[2], $PHHA[2], $PCD[2]);
	}

	Set_Auto_Angles($HUB_AUTO_ANGLES, $PHHA[1], $PHHD[1], $PCD[1], $NF[1]);
	Set_Auto_Angles($HUB_AUTO_ANGLES, $PHHA[2], $PHHD[2], $PCD[2], $NF[2]);
}//end Set_Auto_Angles_Hub() //************************************************/




function Set_Auto_Rot() { //***************************************************/
	//Set_Auto_Rot() should only be available in phh, phr, or custom modes.

	var NR  = $NR.value*1;
	$PHR_FROT_DIVIDER.innerHTML = '<hr class=SC2_hr2>';


	//"Linked to PH Rim" Auto-Rotation option only available ...
	if (($WHEEL_TYPE.value == "phh_phr") || ($WHEEL_TYPE.value == "custom")) {
		$AUTO_ROT_LINKED.disabled = false;
	}
	else {
		$AUTO_ROT_LINKED.disabled = true;
		if ($AUTO_ROT.value == "auto") { $AUTO_ROT.value = "off"; } //Set to "Manual" to preserve existing PH value.
		$PHR_FROT_DIVIDER.innerHTML = '<hr class=SC2_hr2>';
	}


	if ($AUTO_ROT.value == "off")  {
		//Nothing changes when AUTO_ROT is changed to off/manual.
		var rotf = $ROTF.value;
	}
	else if ($AUTO_ROT.value == "auto") {
		Validate_Input($PHRA, false, true);
		if (NR < 1) { var rotf = 0; }
		else        { var rotf = (360/NR - $PHRA.value); }
		$PHR_FROT_DIVIDER.innerHTML = '&#x1f517;';
	}
	else { //0, .25, .50, .75, 1.0, ...etc
		if (NR > 0) { var n_holes = NR;           }
		else        { var n_holes = $NF[2].value; }
		
		if (n_holes > 0) { var rotf = (360/n_holes) * 2 * $AUTO_ROT.value; }
		else             { var rotf = DEFAULT_VALUES.ROTF; }
	} 

	$ROTF.value =  rotf;
}//end Set_Auto_Rot() //*******************************************************/




function Set_Auto_option_from_Angle(angle, $auto_list, x2) { //****************/
	//Set $auto_list select option based on angle. If none match, Set to "Manual".
	var opt_count = $auto_list.options.length;
	var even = 360 / $NR.value * x2;
	var found = false;
	for (var x = 0; x < opt_count; x++) {
		if ((even * $auto_list.options[x].value) == angle) {
			$auto_list.selectedIndex = x;
			found = true;
			break;
		}
	}

	if (!found) { $auto_list.value = 'off'; } //Manual
}//end Set_Auto_option_from_Angle() //*****************************************/




function Calc_Flange_Offset($unknown, $known, side) { //***********************/
	//$known is the value that may have changed, and must be valid.
	Validate_Input($known);

	var OLD = parseFloat($OLD.value);

	if (OLD > 0) { $unknown.value = Round((OLD / 2) - $known.value*1, 2); }
	else         { $unknown.value = 0; }
	
	if (side == 1 || side == 2) { Calc_Spoke_Lengths(side); Save_Settings("wheel"); }
}//end Calc_Flange_Offset()  //************************************************/




function Enable_Disable_FTL() { //*********************************************/
	//If $OLD is 0 or blank, clear & disable Flange-To-Locknut inputs.

	var OLD = parseFloat($OLD.value);

	if (OLD > 0) {
		$FTL[1].disabled = false;
		$FTL[2].disabled = false;
		return true;
	} else {
		$FTL[1].value = 0;
		$FTL[2].value = 0;
		$FTL[1].disabled = true;
		$FTL[2].disabled = true;
		return false;
	}
}//end Enable_Disable_FTL() //*************************************************/




function Set_Show_Button_Text($btn, open, close, alt_class) { //***************/
	if ($btn.value == "none") {
		$btn.innerHTML = open; //"+" "&raquo;" ">>"
		if (alt_class) { $btn.classList.remove(alt_class) }
	}
	else {
		$btn.innerHTML = close; //"-" "&#215;"  "x"
		if (alt_class) { $btn.classList.add(alt_class) }
	}
}//end Set_Show_Button_Text() //***********************************************/




function Show_Side_Checked(side) { //******************************************/
	if (side == 1) { var g1 = 1, g2 = 2; } //g just means 'group'
	else           { var g1 = 3, g2 = 4; } // There are two spoke groups be side, leading & trailing. 
	$SHOW_SIDE[side].checked = false;
	if ($SPOKE_SHOW[g1].checked || $SPOKE_SHOW[g2].checked) { $SHOW_SIDE[side].checked = true }
}//end Show_Side_Checked() //**************************************************/




function Show_All_Holes_Checked() { //*****************************************/
	$HOLES_SHOW_ALL.checked = false;
	if ($HOLES_RIM_SHOW.checked || $HOLES_F1_SHOW.checked || $HOLES_F2_SHOW.checked) { $HOLES_SHOW_ALL.checked = true }
}//end Show_All_Holes_Checked() //*********************************************/




function Build_Load_Sample_List() { //**********************************************/
	var wheels  = SAMPLE_WHEELS.wheels;
	var options = "";

	for (var key in wheels) {
		options += "<option value="+key+"> &nbsp; &nbsp;" + wheels[key].WHEEL_NAME + "</option>\n"; 
	}

	$SAMPLE_WHEEL_LIST.innerHTML = options;
	
	var size = $SAMPLE_WHEEL_LIST.options.length;
	if (size > 30) { $SAMPLE_WHEEL_LIST.setAttribute('size', 30); }
	else           { $SAMPLE_WHEEL_LIST.setAttribute('size', $SAMPLE_WHEEL_LIST.options.length); }
}//end Build_Load_Sample_List() //**************************************************/




function Close_Load_Sample(event) { //*****************************************/
	Normalize_Event(event);
	if(event.key_code == 13 || event.key_code == 27 || event.type == "click") {
		setTimeout(function(){ //Needed for Edge. I don't know why.
			Set_Modal_Mode(false, $LIST_CONTAINER);
			$LIST_CONTAINER.style.display = "none";
			Enable_Disable_Undo_Clear();
			$LOAD_SAMPLE.focus();
		}, 1);
	}
}//end Close_Load_Sample() //**************************************************/




function Set_Modal_Mode(enable, $modal_window) { //****************************/
	//Used for Import/Export, when loading a sample wheel, and for Disclaimer messege.
	//When (enable == true),  show $modal_window, and "disable" & "dim out" The Wheel Maker.
	//  ie: "disable" inputs & <a>'s so that only buttons (etc) in the $modal_window can take focus.
	//Undo all that when !enable.

	if (enable) {
		var display  = "block";
		var tabindex = "-1";
		$IMPORT_INPUT.selectionStart = 0; //Only needed with Import window, but don't care...
	}
	else {
		var display  = "none";
		var tabindex = "";
	}

	//Show/hide our "modal" window
	if ($modal_window) { $modal_window.style.display = display; }

	//Show/hide a cover page to disable/enable click events
	Show_Hide($DISABLE_PAGE, true, false, 'display', display);

	//Disable/enable keyboard/tabbing
	var tags_to_disable = ['A', 'INPUT', 'SELECT', 'BUTTON'];
	for (var t=0; t < tags_to_disable.length; t++) {
		var elements = document.getElementsByTagName(tags_to_disable[t]);
		for (var i = 0; i < elements.length; i++) { elements[i].tabIndex = tabindex; }
	}

	//But keep these tabbable, 'cause we need 'em...
	var dont_disable = [$PERFORM_IMPORT, $IMPORT_SAMPLE_SET, $PRESERVE_INDEX, $IMPORT_INDEX, $X_IMPORT, $X_EXPORT, $CLOSE_IMPORT, $COPY_TO_CLIPBOARD, $CLOSE_EXPORT, $CLOSE_MSG, $X_CLOSE_LOAD_SAMPLE, $SAMPLE_WHEEL_LIST];
	for (var dd = 0; dd < dont_disable.length; dd++) { dont_disable[dd].tabIndex = ""; }

	if (enable) { window.scroll(0,0); }
	else if ($modal_window == $LIST_CONTAINER) {;} //focus() handled by Close_Load_Sample().
	else { $CURRENT_WHEEL.focus(); }
}//end Set_Modal_Mode() //*****************************************************/




function Auto_Size_Input() { //************************************************/
	//Auto-size input textarea (vertically) to fit contents, so that visible contents 
	//are controlled by only one scrollbar - the browser window scrollbar (not two, with the textarea "nested").
	//Minium height is 5 lines (21px * 5 = 105, plus 2px needed to prevent scrollbars that only move those 2px.)
	//The 107 min height should match the css height defined in <style>.
	$IMPORT_INPUT.style.height = 'auto';
	var new_height = $IMPORT_INPUT.scrollHeight;
	if (new_height < 107) { new_height = 105; } //+2 added below.
	$IMPORT_INPUT.style.height = (new_height + 2) + 'px'; //The +2 prevents a scrollbar that only moves those 2px.
}//end Auto_Size_Input() //****************************************************/




function Change_Wheel() { //***************************************************/
	var max_wheels = parseInt($MAX_WHEELS.value);
	var prior_wheel = localStorage.getItem(LS_CURRENT_WHEEL) * 1; //1, 2, 3, etc...
	if (isNaN(prior_wheel)) { prior_wheel = 1; }
	if (prior_wheel < 1)    { prior_wheel = 1; }
	if (prior_wheel > max_wheels) { prior_wheel = max_wheels; }
	$CURRENT_WHEEL.prior_value = prior_wheel;
	
	localStorage.setItem(LS_CURRENT_WHEEL, $CURRENT_WHEEL.value);
	
	var current_wheel_found = ((LS_VALUES_PREFIX + $CURRENT_WHEEL.value      ) in localStorage);
	var prior_wheel_found   = ((LS_VALUES_PREFIX + $CURRENT_WHEEL.prior_value) in localStorage);
	
	if(current_wheel_found) {
		//Temp <select> lists until any saved settings loaded. NR & SX will then be rebuilt in Setup_Type_and_Build().
		Init_NR_SX();
		Load_Settings(LS_VALUES_PREFIX + $CURRENT_WHEEL.value);
		Validate_Wheel_Settings('', true);
		Setup_Type_and_Build();
	} else if (($AUTO_COPY.checked) && prior_wheel_found) { //copy prior wheel to new wheel
		Save_Settings("wheel", 'copy');//saves current settings to new 
	} else {
		Clear_Settings();
		Enable_Disable_Undo_Clear();
	}
	
	$G_WHEEL.setAttribute('transform', " rotate(" + $ROTATE_WHEEL_text.value + ")");
	Setup_Viewbox();
}//end Change_Wheel() //*******************************************************/




function Drag_Wheel(e) { //****************************************************/
	var x1 = $SVG_WHEEL.clientX;
	var y1 = $SVG_WHEEL.clientY;
	var x2 = e.clientX;
	var y2 = e.clientY;
	var dx = (x2 - x1);
	var dy = (y2 - y1);
	$SVG_WHEEL.clientX = x2;
	$SVG_WHEEL.clientY = y2;
	$WHEEL_CONTAINER.scrollLeft -= dx;
	$WHEEL_CONTAINER.scrollTop  -= dy;
}//end Drag_Wheel(e) //********************************************************/




function Save_Undo() { //******************************************************/
	//Only save undo if wheel has settings to undo (in localStorage).
	var saved_settings = localStorage.getItem(LS_VALUES_PREFIX + $CURRENT_WHEEL.value);
	if (saved_settings) { Save_Settings("undo"); }
}//end Save_Undo() //***********************************************************/




function Import_Index_Enable_Disable() { //************************************/
	if ($PRESERVE_INDEX.checked) {
		$IMPORT_INDEX_LABEL.classList.add(_NS_ + "disabled");
		$IMPORT_INDEX.disabled = true;
	}
	else {
		$IMPORT_INDEX_LABEL.classList.remove(_NS_ + "disabled");
		$IMPORT_INDEX.disabled = false;
	}
	
	$IMPORT_INDEX.value = 1; //Default for $PERFORM_IMPORT.
}//end Import_Index_Enable_Disable() //****************************************/




function Wheel_or_Display_Settings(button, new_value, show_or_hide, Wheel_or_Display) {
	button.value = new_value;
	Show_Hide($DISPLAY_SETTINGS, show_or_hide);
	Show_Hide($WHEEL_SETTINGS_container, !show_or_hide);
	$WHEEL_OR_DISPLAY.innerHTML = "Show " + Wheel_or_Display + " Settings";
}//end Wheel_or_Display_Settings() //******************************************/




function Step_Up_Down_Repeater(scale_or_rotate, $button, $slider, $text, min_max, up_down, step) {

	var new_value = Step_Up_Down($slider, $text, min_max, up_down, step);
	
	if (scale_or_rotate == "scale") { Set_Scale(); }
	else { $G_WHEEL.setAttribute('transform', " rotate(" + new_value + ")"); }
	
	$button.timeout = setTimeout(function() { //Delay start of repeat....
		$button.interval = setInterval(function() {   
			var new_value = Step_Up_Down($slider, $text, min_max, up_down, step);
			if (scale_or_rotate == "scale") { Set_Scale(); }
			else { $G_WHEEL.setAttribute('transform', " rotate(" + new_value + ")"); }
		}, 50);
	}, 500);
}//end Setup_up_Down_Repeater()




function Step_Up_Down($slider, $text, min_max, up, step) {
	//up is 1 for up, -1 for down.
	var limit = $slider.getAttribute(min_max);
	var new_value = ($slider.value * 1) + up*step;
	if (up == 1) { if (new_value > limit) { new_value = limit; } }
	else         { if (new_value < limit) { new_value = limit; } }
	$slider.value = new_value;
	$text.value   = new_value;
	Save_Settings("wheel");
	return new_value;
}//end Setup_up_Down()




function Check_if_Disclaimer_Accepted(target) { //*****************************/
	//Disclaimer - check cookies to see if already accepted.
	//Why? I don't know, it was really late, and seemed like a good idea at the time...
	
	$ACCEPT_MSG.value = "false"; //initialize [I Accept] button value.
	var COOKIES = D.cookie.split("; ");
	for (var x = 0; x < COOKIES.length; x++) {
		COOKIES[x] = COOKIES[x].split("=");
		if (COOKIES[x][0] == $ACCEPT_MSG.id) {
			if (COOKIES[x][1] == "true") { $ACCEPT_MSG.value = "true"; }
			break; //There can be only one...
		}
	}

	//Set inital focus or show disclaimer
	if (!$ACCEPT_MSG.ENABLED || $ACCEPT_MSG.value == "true") { target.focus(); }
	else {
		Set_Modal_Mode(true);
		$ACCEPT_MSG.disabled = false;
		Show_Message(target, MSGS['notice'] + $RESPONSIBILITY.innerHTML, 'init');
	}
}//end Check_if_Disclaimer_Accepted() //***************************************/




function Assign_Events() { //**************************************************/

	D.addEventListener("keydown", function(event){Scroll_Blur(event)} );

	var save = true; //Just for clarity below, as some functions have an option to save settings.

	//Save current value (as .prior_value) onfocus for <input type=text>s in case of error in new value.
	var settings = [$WHEEL_TYPE, $PHHA[1], $PHHA[2], $PHHD[1], $PHHD[2], $PHRA, $PHRD, $ROTF, $ERD, $NR, $NF[1], $NF[2], $PCD[1], $PCD[2], $FTC[1], $FTC[2], $OSB[1], $OSB[2], $SHD, $FW, $SDB, $MAX_WHEELS, $TENSION[2], $SCALE_text, $SPOKE_LINE_SIZE[1], $SPOKE_LINE_SIZE[2], $SPOKE_LINE_SIZE[3], $SPOKE_LINE_SIZE[4], $RIM_LINE_SIZE, $F1_LINE_SIZE, $F2_LINE_SIZE, $AXES_LINE_SIZE, $HOLES_RIM_SIZE, $ROTATE_WHEEL_text, $IMPORT_INDEX];
	for (var x = 0; x < settings.length; x++) {
		settings[x].addEventListener("focus", function() {
			if ($ACCEPT_MSG.ENABLED && $ACCEPT_MSG.value != "true") { $ACCEPT_MSG.focus(); }
			$PRIOR_FOCUS = this;
			this.prior_value = this.value; //also set in Build_Wheel() and in Calc_Spoke_Lengths().
		});
	}

	
	D.addEventListener("mouseup",  function(e){ D.removeEventListener('mousemove', Drag_Wheel); });
	$SVG_WHEEL.addEventListener("mousedown", function(e){
		$SVG_WHEEL.clientX = e.clientX;
		$SVG_WHEEL.clientY = e.clientY;
		D.addEventListener('mousemove', Drag_Wheel);
		e.preventDefault();
	});


	$WHEEL_OR_DISPLAY.addEventListener("click", function() {
		if (this.value == "wheel") { Wheel_or_Display_Settings(this, "display", true , "Wheel")  ; }
		else                       { Wheel_or_Display_Settings(this, "wheel"  , false, "Display"); }
	});


	$CURRENT_WHEEL.addEventListener("change", function() { Change_Wheel(); });

	$CURRENT_WHEEL.addEventListener("keypress", function(event) {
		Normalize_Event(event);
		//Yes, both blur() & focus() are needed...
		if(event.key_code == 13) {
			D.activeElement.blur();
			$WHEEL_NAME.style['visibility'] = "visible";
			$WHEEL_NAME.focus();
		}
	});


	$WHEEL_NAME.addEventListener("keypress", function(event) {
		Normalize_Event(event);
		//Yes, both blur() & focus() are needed...
		if(event.key_code == 13) {
			D.activeElement.blur();
			$CURRENT_WHEEL.focus();
		}
	});


	$WHEEL_NAME.addEventListener("blur" , function(event) {
		$WHEEL_NAME.style['visibility'] = "hidden";
		$CURRENT_WHEEL.focus();
	});


	$WHEEL_NAME.addEventListener("change", function() {
		this.value   = this.value.trim();
		this.current = this.value;
		var current_wheel = $CURRENT_WHEEL.value;
		var option = $CURRENT_WHEEL.options[current_wheel - 1]; //$CURRENT_WHEEL.value counts from 1, select.options[] from 0.
		option.innerHTML = Pad10(current_wheel) + SSI + $WHEEL_NAME.value;
		Save_Settings("wheel", 'name');
	});

	$RENAME_WHEEL.addEventListener("click", function() {
		$WHEEL_NAME.style['visibility'] = "visible";
		$WHEEL_NAME.focus();
	});

	
	$SHOW_WHEEL_OPTS.addEventListener("click", function() {
		Show_Hide_Options(this, $WHEEL_OPTS, 'inline-block');
		Set_Show_Button_Text($SHOW_WHEEL_OPTS, "+", "&minus;");
		if ($SHOW_WHEEL_OPTS.value == "none") { $HEADER_OPTS.style.width = ""; }
		else                                  { $HEADER_OPTS.style.width = HEADER_OPTS_WIDTH; }
	});


	$MAX_WHEELS.addEventListener("change", function() {
		Validate_Input(this, true, 0, 1, MAX_MAX_WHEELS);
		Save_Settings("display");
		var current_wheel = $CURRENT_WHEEL.value;
		Build_Select_Wheel_List();
		$CURRENT_WHEEL.value = this.value;
		Change_Wheel(); 
		Enable_Disable_Undo_Clear();
	});


	$LOAD_SAMPLE.addEventListener("click", function(){
		SAVE_UNDO = true; //used onchange of $SAMPLE_WHEEL_LIST.
		Set_Modal_Mode(true, $LIST_CONTAINER);
		$LIST_CONTAINER.style.display = ""; //default of block or inline-block.
		$X_CLOSE_LOAD_SAMPLE.focus();
		$SAMPLE_WHEEL_LIST.selectedIndex = 0; //Needed for Edge.
		$SAMPLE_WHEEL_LIST.selectedIndex = -1;
	});
	

	$X_CLOSE_LOAD_SAMPLE.addEventListener("click"  , function(event){ Close_Load_Sample(event); });
	$X_CLOSE_LOAD_SAMPLE.addEventListener("keydown", function(event){ Close_Load_Sample(event);
		if (event.key_code == 40) { $SAMPLE_WHEEL_LIST.focus(); } //arrow down
	});
	
	$SAMPLE_WHEEL_LIST.addEventListener("keydown"  , function(event){ Close_Load_Sample(event); });
	$SAMPLE_WHEEL_LIST.addEventListener("change"   , function(event){
		//Save_Undo() only on first change after $LOAD_SAMPLE clicked,
		//so that the undo is only for the wheel prior to samples.
		//That is, don't Save_Undo() for the samples as we scroll thru the list.
		if (SAVE_UNDO) { Save_Undo(); SAVE_UNDO = false; }
		var option = this.options[this.selectedIndex];
		Load_Samples(option.value);  //runs Setup_Type_and_Build("build")
	});


	$CLEAR_SETTINGS.addEventListener("click", function() {
		Save_Undo();
		Clear_Settings();
		Enable_Disable_Undo_Clear(); //Must come after Save_Undo() 
		//Timeout needed due to one in Enable_Disable_Undo_Clear() to ensure [Undo] is not disabled, and able to receive focus().
		setTimeout(function(){ $UNDO_SAMPLE_CLEAR.focus() },10);
	});


	$UNDO_SAMPLE_CLEAR.addEventListener("click", function(){
		Enable_Disable_Undo_Clear();
		if (localStorage.getItem(LS_UNDO) == null) { return }
		Init_NR_SX();
		Load_Settings(LS_UNDO);
		Save_Settings("wheel", "imported");
		Setup_and_Build();
		localStorage.removeItem(LS_UNDO);
		setTimeout(function(){ $CLEAR_SETTINGS.focus() },10); //Timeout needed due to one in Enable_Disable_Undo_Clear().
	});


	$WHEEL_TYPE.addEventListener("change", function() {
		//Don't save if no current settings and only Type was changed.
		if (Setup_Type_and_Build()) { Save_Settings("wheel"); }
		this.prior_value = this.value;
	});


	$ERD.addEventListener("change", function() {
		if (Validate_Input(this)) {
			Calc_PD_from_PA($PHRD, $PHRA, this);
			Build_Wheel(save);
			Setup_Viewbox(); }
		}
	);

	$NR.addEventListener("change", function() {
		if (Validate_NR()) {
			var phh    = ($WHEEL_TYPE.value == "phh" || $WHEEL_TYPE.value == "phh_phr");
			var custom = ($WHEEL_TYPE.value == "custom");
			if (phh || custom) { Set_phh_Lace_Opt(); }
			Set_Auto_Angles_Hub();
			Set_Auto_Angles($RIM_AUTO_ANGLES, $PHRA, $PHRD, $ERD, $NR);
			Set_Auto_Rot();
			Build_Wheel(true);
		}
	});

	$NF[1].addEventListener("change", function() {
		//$NF's are only available in custom mode...
		if (Validate_NF(1)) {
			Set_Auto_Angles_Hub();
			Build_Wheel(true);
		}
	});

	$NF[2].addEventListener("change", function() {
		//$NF's are only available in custom mode...
		if (Validate_NF(2)) {
			Set_Auto_Angles_Hub();
			Build_Wheel(true);
		}
	});

	$PCD[1].addEventListener("change", function() {
		Validate_Input($PCD[1]);
		Calc_PD_from_PA($PHHD[1], $PHHA[1], $PCD[1]);
		Build_Wheel(save);
		Setup_Viewbox();
	});
	$PCD[2].addEventListener("change", function() {
		Validate_Input($PCD[2]);
		Calc_PD_from_PA($PHHD[2], $PHHA[2], $PCD[2]);
		Build_Wheel(save);
		Setup_Viewbox();
	});

	$FTC[1].addEventListener("change", function() { Calc_Flange_Offset($FTL[1], this, 1); });
	$FTC[2].addEventListener("change", function() { Calc_Flange_Offset($FTL[2], this, 2); });
	$FTL[1].addEventListener("change", function() { Calc_Flange_Offset($FTC[1], this, 1); });
	$FTL[2].addEventListener("change", function() { Calc_Flange_Offset($FTC[2], this, 2); });

	$SHOW_FL_to_LN.addEventListener("click", function() {
		Show_Hide_Options(this, $FL_to_LN, 'block');
		Set_Show_Button_Text($SHOW_FL_to_LN, "+", "-");
	});

	$OLD.addEventListener("change", function() {
		Validate_Input(this);
		if (Enable_Disable_FTL()) {
			for (var side = 1; side <= 2; side++) {
				if ($FTC[side].value*1 > 0) { Calc_Flange_Offset($FTL[side], $FTC[side], 1); } else 
				if ($FTL[side].value*1 > 0) { Calc_Flange_Offset($FTC[side], $FTL[side], 2); }
			}
		}
		Calc_Spoke_Lengths();
	});


	$SX[1].addEventListener("change", function() {
		var phh    = ($WHEEL_TYPE.value == "phh" || $WHEEL_TYPE.value == "phh_phr");
		var custom = ($WHEEL_TYPE.value == "custom");
		if (phh || custom) { Set_phh_Lace_Opt(); }
		Build_Wheel(save);
	});

	$SX[2].addEventListener("change", function() { Build_Wheel(save); });

	$LACE_OPT.addEventListener("change", function() { Build_Wheel(save); });


	$HUB_AUTO_ANGLES.addEventListener("change", function() {
		Set_Auto_Angles_Hub();
		Build_Wheel(true);
	});

	$PHHA[1].addEventListener("change", function() {
		Validate_PH_Angle(this, $NF[1], 0, 2*1);
		Calc_PD_from_PA($PHHD[1], this, $PCD[1]);
		if ($WHEEL_TYPE.value != "custom") {
			$PHHA[2].value = this.value;	
			Calc_PD_from_PA($PHHD[2], $PHHA[2], $PCD[2]);
			Set_Auto_option_from_Angle(this.value, $HUB_AUTO_ANGLES, 2);
		} else { $HUB_AUTO_ANGLES.value = 'off'; }
		Build_Wheel(true);
	});

	$PHHA[2].addEventListener("change", function() {
		//Only available in custom mode.
		Validate_PH_Angle(this, $NF[2], 0, 2*1);
		Calc_PD_from_PA($PHHD[2], this, $PCD[2]);
		$HUB_AUTO_ANGLES.value = 'off';
		Build_Wheel(true);
	});

	$PHHD[1].addEventListener("change", function() {
		Validate_PH_Distance(this, $NF[1], $PCD[1])
		Calc_PA_from_PD($PHHA[1], this, $PCD[1]);
		if ($WHEEL_TYPE.value != "custom") {
			$PHHA[2].value = $PHHA[1].value;
			Calc_PD_from_PA($PHHD[2], $PHHA[2], $PCD[2]);
			Set_Auto_option_from_Angle($PHHA[1].value, $HUB_AUTO_ANGLES, 2);
		} else { $HUB_AUTO_ANGLES.value = 'off'; }
		Build_Wheel(true);
	});

	$PHHD[2].addEventListener("change", function() {
		Validate_PH_Distance(this, $NF[2], $PCD[2])
		Calc_PA_from_PD($PHHA[2], this, $PCD[2]);
		$HUB_AUTO_ANGLES.value = 'off';
		Build_Wheel(true);
	});



	$AUTO_ROT.addEventListener("change", function() {
		Set_Auto_Rot();
		Build_Wheel(true);
	});

	$ROTF.addEventListener("change", function() {
		Validate_PH_Angle(this, $NR, -.5*2, 1.5*2, true); //true allows -neg angles.
		Set_Auto_option_from_Angle(this.value, $AUTO_ROT, 2);
		Set_Auto_Rot(); //Must come after Set_Auto_option_from_Angle().
		Build_Wheel(true);
	});



	$RIM_AUTO_ANGLES.addEventListener("change", function() {
		Set_Auto_Angles($RIM_AUTO_ANGLES, $PHRA, $PHRD, $ERD, $NR);
		Set_Auto_Rot();//Must come after Set_Auto_Angles(Rim...)
		Build_Wheel(true);
	});

	$PHRA.addEventListener("change", function() {
		Validate_PH_Angle(this, $NR, -2*2, 2*2, true); //true allows -neg angles.
		Calc_PD_from_PA($PHRD, $PHRA, $ERD);
		Set_Auto_option_from_Angle(this.value, $RIM_AUTO_ANGLES, 1);
		Set_Auto_Rot(); //Must come after Set_Auto_option_from_Angle().
		Build_Wheel(true);
	});

	$PHRD.addEventListener("change", function() {
		Validate_PH_Distance(this, $NR, $ERD, true);//true allows -neg distances.
		Calc_PA_from_PD($PHRA, $PHRD, $ERD);
		Set_Auto_option_from_Angle($PHRA.value, $RIM_AUTO_ANGLES, 1);
		Set_Auto_Rot(); //Must come after Set_Auto_option_from_Angle().
		Build_Wheel(true);
	});


	$ROTR.addEventListener("change", function() {
		Validate_PH_Angle(this, $NR, -$NR.value, $NR.value, true); //true allows -neg angles.
		Build_Wheel(true);
	});


	$SHOW_PHH_OPTS.addEventListener("click", function(){
		Show_Hide_Options($SHOW_PHH_OPTS, $PHH_OPTS , "table-row");
		Set_Show_Button_Text($SHOW_PHH_OPTS, "+", "-");
	});

	$SHOW_PHR_OPTS.addEventListener("click", function(){
		Show_Hide_Options($SHOW_PHR_OPTS, $PHR_OPTS , "table-row");
		Set_Show_Button_Text($SHOW_PHR_OPTS, "+", "-");
	});

	$SHOW_ESO_OPTS.addEventListener("click", function(){
		Show_Hide_Options($SHOW_ESO_OPTS, $ESO_OPTS , "table-row");
		Set_Show_Button_Text($SHOW_ESO_OPTS, "+", "-");
	});


	$PRIMA_LACING.addEventListener("click", function() {Build_Wheel(save)});


	// Only need to recalc final spoke lengths. OSB & SHD are ignored in display calculations for <line> endpoints.
	$OSB[1].addEventListener("change", function() {
		Validate_Input(this, 0, 1);
		if ($OSB_linked.checked) { $OSB[2].value = -this.value; }
		Calc_Spoke_Lengths(0, false, this, 0, 1);
	});
	$OSB[2].addEventListener("change", function() {
		Validate_Input(this, 0, 1);
		if ($OSB_linked.checked) { $OSB[1].value = -this.value; }
		Calc_Spoke_Lengths(0, false, this, 0, 1);
	});
	
	$OSB_linked.addEventListener("click", function(){ Save_Settings("wheel"); });

	$SHD.addEventListener("change", function() { Calc_Spoke_Lengths(0, true, this, 0, 0); });

	$FW 	   .addEventListener("change", function() { if (Validate_Input(this)) { Update_Advanced_Info(save); } });
	$SDB	   .addEventListener("change", function() { if (Validate_Input(this)) { Update_Advanced_Info(save); } });
	$ELBOWS[1] .addEventListener("change", function() { Update_Advanced_Info(save); });
	$ELBOWS[2] .addEventListener("change", function() { Update_Advanced_Info(save); });
	$TENSION[2].addEventListener("change", function() {
		if (!Validate_Input(this)) { return false; }
		$TENSION[1].value = Round(this.value * $TENSION_RATIO[1].value / 100);
		Save_Settings("wheel");
	});


	$SHOW_HIDE_ADVANCED.addEventListener("click", function() { Show_Hide_Options(this, $ADVANCED_INFO, "inline-block"); });
	$SHOW_HIDE_NOTES   .addEventListener("click", function() { Show_Hide_Options(this, $NOTES		 , "inline-block"); });
	$SHOW_HIDE_OTHER   .addEventListener("click", function() { Show_Hide_Options(this, $OTHER_CALCS	 , "inline-block"); });
	$SEE_NOTES         .addEventListener("click", function() { Advanced_Build_Notes_btn();} );
	$SHOW_HIDE_SCALE   .addEventListener("click", function() {
		Show_Hide_Options(this, $SCALE_ROTATE_OPTIONS, "inline-block");
		Set_Show_Button_Text($SHOW_HIDE_SCALE, "+", "&#215;", SCALE_ROTATE_OPEN);
	});


	$SHOW_SIDE[1].addEventListener("click", function() {
		$SPOKE_SHOW[1].checked = this.checked;
		$SPOKE_SHOW[2].checked = this.checked;
		Show_Hide_Class( SPOKE_GROUP_PREFIX + 1, this.checked, 'wheel');
		Show_Hide_Class( SPOKE_GROUP_PREFIX + 2, this.checked, 'wheel');
	} );

	$SHOW_SIDE[2].addEventListener("click", function() {
		$SPOKE_SHOW[3].checked = this.checked;
		$SPOKE_SHOW[4].checked = this.checked;
		Show_Hide_Class( SPOKE_GROUP_PREFIX + 3, this.checked, 'wheel');
		Show_Hide_Class( SPOKE_GROUP_PREFIX + 4, this.checked, 'wheel');
	} );

	for (var group = 1; group <= 4; group++) {
		(function(g) {
			$SPOKE_COLOR[g]    .addEventListener("change", function() { Set_Style_by_Class( SPOKE_GROUP_PREFIX + g, "stroke", this.value, save); });
			$SPOKE_LINE_SIZE[g].addEventListener("change", function() {
				if (Validate_Input(this)) { Set_Style_by_Class( SPOKE_GROUP_PREFIX + g, "stroke-width", this.value, save); }
			});
			$SPOKE_SHOW[g]     .addEventListener("change", function() {
				Show_Hide_Class( SPOKE_GROUP_PREFIX + g, this.checked, 'wheel');
				if (g == 1 || g == 2) { Show_Side_Checked(1); } else { Show_Side_Checked(2); }
			});
		})(group);
	}

	$RIM_COLOR    .addEventListener("change", function() { Set_Save_Style($RIM,     'stroke', this.value); });
	$RIM_LINE_SIZE.addEventListener("change", function() { if (Validate_Input(this)) { Make_Rim(save); Setup_Viewbox(); } });
	$RIM_SHOW     .addEventListener("change", function() { Show_Hide($RIM    , this.checked, save) });

	$F1_COLOR     .addEventListener("change", function() { Set_Save_Style($FLANGE1, 'stroke', this.value); });
	$F1_LINE_SIZE .addEventListener("change", function() { if (Validate_Input(this)) { Set_Save_Style($FLANGE1, 'stroke-width', this.value); } });
	$F1_SHOW      .addEventListener("change", function() { Show_Hide($FLANGE1, this.checked, save) });

	$F2_COLOR     .addEventListener("change", function() { Set_Save_Style($FLANGE2, 'stroke', this.value); });
	$F2_LINE_SIZE .addEventListener("change", function() { if (Validate_Input(this)) { Set_Save_Style($FLANGE2, 'stroke-width', this.value); } });
	$F2_SHOW      .addEventListener("change", function() { Show_Hide($FLANGE2, this.checked, save) });

	$AXES_COLOR    .addEventListener("change", function() { Set_Style_by_Class( AXIS_CLASS, "stroke", this.value, save); });
	$AXES_LINE_SIZE.addEventListener("change", function() { if (Validate_Input(this)) { 
		Set_Style_by_Class(AXIS_CLASS, 'stroke-width', this.value, save);
		Draw_Axis();
	} });
	$AXES_SHOW     .addEventListener("change", function() { Show_Hide_Class( AXIS_CLASS, this.checked, 'wheel'); });


	$HOLES_SHOW_ALL.addEventListener("change", function() {
		$HOLES_RIM_SHOW.checked = this.checked;
		$HOLES_F1_SHOW.checked  = this.checked;
		$HOLES_F2_SHOW.checked  = this.checked;
		Show_Hide_Class( RIM_HOLES   , this.checked, 'wheel');
		Show_Hide_Class( HUB_HOLES[1], this.checked, 'wheel');
		Show_Hide_Class( HUB_HOLES[2], this.checked, 'wheel');
	});

	$HOLES_RIM_COLOR.addEventListener("change", function() { Set_Style_by_Class( RIM_HOLES, "fill" , this.value, save); });
	$HOLES_RIM_SHOW .addEventListener("change", function() {
		Show_Hide_Class( RIM_HOLES, this.checked, 'wheel');
		Show_All_Holes_Checked();
	});
	
	$HOLES_RIM_SIZE.addEventListener("change", function() { //$HOLES_RIM_SIZE is diameter
		if (!Validate_Input(this)) { return false; }
		Set_Attribute_by_Class(RIM_HOLES, 'r', this.value/2); //set *radius* of holes (this.value/2)
		Save_Settings("wheel");
	});

	$HOLES_F1_COLOR.addEventListener("change", function() { Set_Style_by_Class( HUB_HOLES[1], "fill" , this.value, save); });
	$HOLES_F1_SHOW .addEventListener("change", function() {
		Show_Hide_Class( HUB_HOLES[1], this.checked, 'wheel');
		Show_All_Holes_Checked();
		});
	
	$HOLES_F1_SIZE.addEventListener("change", function() { //$HOLES_F1_SIZE is diameter
		if (!Validate_Input(this)) { return false; }
		Set_Attribute_by_Class( HUB_HOLES[1], 'r', this.value/2); //set *radius* of holes (this.value/2)
		Save_Settings("wheel");
	});

	$HOLES_F2_COLOR.addEventListener("change", function() { Set_Style_by_Class( HUB_HOLES[2], "fill" , this.value, save); });
	$HOLES_F2_SHOW .addEventListener("change", function() {
		Show_Hide_Class( HUB_HOLES[2], this.checked, 'wheel');
		Show_All_Holes_Checked();
	});
	
	$HOLES_F2_SIZE.addEventListener("change", function() { //$HOLES_F2_SIZE is diameter
		if (!Validate_Input(this)) { return false; }
		Set_Attribute_by_Class( HUB_HOLES[2], 'r', this.value/2); //set *radius* of holes (this.value/2)
		Save_Settings("wheel");
	});


	$ROTATE_WHEEL_text.addEventListener("change", function(){
		Validate_Input(this); // make sure number & >= 0;
		if (this.value > 360) { this.value = 360; }
		$ROTATE_WHEEL_slider.value = this.value;
		$G_WHEEL.setAttribute('transform', " rotate(" + this.value + ")");
		Save_Settings("wheel");
	});

	$ROTATE_WHEEL_step.addEventListener("change", function(){
		Validate_Input(this);
		var step = this.value * 1;
		if (step < .01) { this.value = .1 ; }
		if (step > 360) { this.value = 360; }
		$ROTATE_WHEEL_slider.setAttribute('step', this.value);
		Save_Settings("wheel");
	});

	$ROTATE_WHEEL_slider.addEventListener("change", function(){ Save_Settings("wheel"); });
	$ROTATE_WHEEL_slider.addEventListener("input", function(){
		$ROTATE_WHEEL_text.value = this.value;
		$G_WHEEL.setAttribute('transform', " rotate(" + this.value + ")");
	});

	$ROTATE_WHEEL_down.addEventListener("mousedown", function() {
		Step_Up_Down_Repeater("rotate", $ROTATE_WHEEL_down, $ROTATE_WHEEL_slider, $ROTATE_WHEEL_text, "min", -1, $ROTATE_WHEEL_step.value);
	});

	$ROTATE_WHEEL_down.addEventListener("mouseup", function() {
		clearTimeout(this.timeout);
		clearInterval(this.interval);
	});

	$ROTATE_WHEEL_up.addEventListener("mousedown", function() {
		Step_Up_Down_Repeater("rotate", $ROTATE_WHEEL_up, $ROTATE_WHEEL_slider, $ROTATE_WHEEL_text, "max", 1, $ROTATE_WHEEL_step.value);
	});

	$ROTATE_WHEEL_up.addEventListener("mouseup", function() {
		clearTimeout(this.timeout);
		clearInterval(this.interval);
	});


	$SCALE_text.addEventListener("change", function() {
		if (!Validate_Input(this)) { return false; }
		var scale = this.value * 1;
		var min   = $SCALE_slider.getAttribute("min") * 1;
		var max   = $SCALE_slider.getAttribute("max") * 1;
		if (scale < min) { this.value = min; } else 
		if (scale > max) { this.value = max; }
		$SCALE_slider.value = this.value;
		Set_Scale();
		Save_Settings("wheel");
		this.prior_value = this.value
	});

	$SCALE_step.addEventListener("change", function(){
		Validate_Input(this);
		var step = this.value * 1;
		var max  = $SCALE_slider.getAttribute("max");
		if (step <   1) { this.value =   1; }
		if (step > max) { this.value = max; }
		$SCALE_slider.setAttribute('step', this.value);
		Save_Settings("wheel");
	});

	$SCALE_slider.addEventListener("change", function() { Save_Settings("wheel"); });
	$SCALE_slider.addEventListener("input" , function() { $SCALE_text.value = this.value; Set_Scale(); });

	$SCALE_down.addEventListener("mousedown", function() {
		Step_Up_Down_Repeater("scale", $SCALE_down, $SCALE_slider, $SCALE_text, "min", -1, $SCALE_step.value);
	});

	$SCALE_down.addEventListener("mouseup", function() {
		clearTimeout(this.timeout);
		clearInterval(this.interval);
	});

	$SCALE_up.addEventListener("mousedown", function() {
		Step_Up_Down_Repeater("scale", $SCALE_up, $SCALE_slider, $SCALE_text, "max", 1, $SCALE_step.value);
	});

	$SCALE_up.addEventListener("mouseup", function() {
		clearTimeout(this.timeout);
		clearInterval(this.interval);
	});


	$RESET_SCALE          .addEventListener("click", function() { Reset_Scale_Rotate(true);    });
	$RESET_OPTIONS_SPOKES .addEventListener("click", function() { Reset_OPTIONS_SPOKES(true);  });
	$RESET_OPTIONS_RIM_ETC.addEventListener("click", function() { Reset_OPTIONS_RIM_ETC(true); });


	$CLOSE_MSG.addEventListener("blur" , function() { Close_Message() });
	$CLOSE_MSG.addEventListener("click", function() { Close_Message() });


	$ACCEPT_MSG.addEventListener("click", function() {
		$ACCEPT_MSG.value = "true";
		var expires = new Date(+new Date() + 2592000000); //in 30 days (in milliseconds) Should it be Longer? Shorter?
		var domain = window.location.hostname;
		D.cookie = $ACCEPT_MSG.id + "=true; expires=" + expires.toUTCString() + '; path=/; domain=.' + domain;
		Set_Modal_Mode(false);
		Close_Message();
	});


	$DELETE_ALL_DATA.addEventListener('click', function() {
		//except browser cache, of course...
		
		var DELETE_ALL = confirm(MSGS.clear_all);
		if (!DELETE_ALL) { return; }
		
		var ls_keys = Object.keys(localStorage);
		var match = false;
		for (var x=0; x < ls_keys.length; x++) {
			var match = (ls_keys[x].substr(0,LS_VALUES_PREFIX.length) == LS_VALUES_PREFIX) || //ex: SC2_WHEEL
						(ls_keys[x] == LS_DISPLAY_OPTIONS) ||                                 //ex: SC2_DISPLAY_OPTIONS
						(ls_keys[x] == LS_CURRENT_WHEEL) ||                                   //ex: SC2_CURRENT_WHEEL
						(ls_keys[x] == LS_UNDO);                                              //ex: SC2_UNDO
			if (match) { localStorage.removeItem(ls_keys[x]) }
		}
		
		
		Build_Select_Wheel_List();
		Clear_Settings();
		Enable_Disable_Undo_Clear();
		
		Reset_Scale_Rotate();
		Reset_OPTIONS_SPOKES();
		Reset_OPTIONS_RIM_ETC();
		
		Init_Show_Hide_Options(true);
		
		Wheel_or_Display_Settings($WHEEL_OR_DISPLAY, "wheel", false, "Display");
		
		var domain = window.location.hostname;
		document.cookie = $ACCEPT_MSG.id + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT; domain=.' + domain;
		$ACCEPT_MSG.value = false;
		
		if ($ACCEPT_MSG.ENABLED) { Show_Message('', MSGS['notice'] + $RESPONSIBILITY.innerHTML, 'init'); }
		else                     { $ERD.focus(); }
		
		$CURRENT_WHEEL.value = 1;
	}); //end $DELETE_ALL_DATA on click



	$EXPORT.addEventListener("click", function() {
		var ALL_DATA = {}; //
		ALL_DATA.wheels = {};
		ALL_DATA.display_options = Parse_Settings(localStorage.getItem(LS_DISPLAY_OPTIONS));
		
		var max_wheels = parseInt($MAX_WHEELS.value);
		for (var wheel = 1; wheel <= max_wheels; wheel++ ) {
			var wheel_data = Parse_Settings(localStorage.getItem(LS_VALUES_PREFIX + wheel));
			if (wheel_data) { ALL_DATA.wheels[wheel] = wheel_data; }
		}
		
		$EXPORT_OUTPUT.innerHTML = JSON.stringify(ALL_DATA);
		
		Set_Modal_Mode(true, $EXPORT_CONTAINER);
		
		$COPY_TO_CLIPBOARD.focus();
	});


	$CLOSE_EXPORT.addEventListener("click", function() {
		$EXPORT_OUTPUT.innerHTML = "";
		Set_Modal_Mode(false, $EXPORT_CONTAINER);
	});


	$COPY_TO_CLIPBOARD.addEventListener("click", function() {
		window.getSelection().selectAllChildren( $EXPORT_OUTPUT );
		document.execCommand("copy");
	});


	$IMPORT.addEventListener("click", function() {
		Set_Modal_Mode(true, $IMPORT_CONTAINER);
		$PRESERVE_INDEX.checked = true;
		Import_Index_Enable_Disable();
		Auto_Size_Input();
		$IMPORT_INPUT.focus();
		setTimeout(function() {window.scroll(0,0);} ,10);
	});


	$CLOSE_IMPORT.addEventListener("click", function() { Set_Modal_Mode(false, $IMPORT_CONTAINER); });
	$X_IMPORT.addEventListener("click", function() { Set_Modal_Mode(false, $IMPORT_CONTAINER); });
	$X_EXPORT.addEventListener("click", function() { Set_Modal_Mode(false, $EXPORT_CONTAINER); $EXPORT_OUTPUT.innerHTML = ""; });

	$PRESERVE_INDEX.addEventListener("click", function() { Import_Index_Enable_Disable(); });

	$IMPORT_INDEX.addEventListener("change", function(){ Validate_Input(this, true, false, 1, MAX_MAX_WHEELS); });

	$IMPORT_INPUT.addEventListener('input', function(){ Auto_Size_Input() });


	$IMPORT_SAMPLE_SET.addEventListener("click", function(){
		$IMPORT_INPUT.value = JSON.stringify(SAMPLE_WHEELS);
		Auto_Size_Input();
	});


	$PERFORM_IMPORT.addEventListener("click", function() {
		//Some basic validation done by Validate_Wheel_Settings(). Could probably use more.
		//{ "wheels":{"1":{...}, ...}, "display_options":{...} }
		var max_wheels_before = $MAX_WHEELS.value*1;
		var imported_data = Parse_Settings($IMPORT_INPUT.value);
		if (imported_data == null) { Show_Message($IMPORT_INPUT, MSGS.import_invalid); return; }

		var wheel_indexes = Object.keys(imported_data.wheels); //From/for the wheel select list.  [ 1 :: Wheel Name ]
		var wheel_count   = wheel_indexes.length;

		if ($PRESERVE_INDEX.checked) {
			var new_index = 0;
			var last_index = wheel_indexes[wheel_count-1];
		}
		else {
			var new_index = $IMPORT_INDEX.value*1 - 1;
			var last_index = new_index + wheel_count;
			var max_import_index = MAX_MAX_WHEELS - wheel_count + 1;
		}

		if (last_index > MAX_MAX_WHEELS) {
			var msg  = MSGS.cannot_exceed   + (MAX_MAX_WHEELS+1) + ".<br>";
				msg += MSGS.imported_wheels + wheel_count + '<br>';
				msg += MSGS.beginning_index + $IMPORT_INDEX.value + '<br>';
				msg += MSGS.total           + (wheel_count + $IMPORT_INDEX.value*1) + "<br>";
			    msg += MSGS.decrease        + max_import_index;
			Show_Message('', msg);
			return;
		}

		//Needs to come before $MAX_WHEELS it checked/adjusted below...
		Init_Display_NR_SX(imported_data.display_options, true);

		if (last_index > $MAX_WHEELS.value*1) { $MAX_WHEELS.value = last_index; }

		Build_Select_Wheel_List(); 

		//The meat of the import...
		for (var saved_index in imported_data.wheels) {
			if ($PRESERVE_INDEX.checked) { new_index = saved_index; }
			else                         { new_index++; }

			$CURRENT_WHEEL.value = new_index;
			var imported_settings   = Load_Settings(imported_data.wheels[saved_index], "imported");

			$WHEEL_NAME.value   = $WHEEL_NAME.value.trim();
			$WHEEL_NAME.current = $WHEEL_NAME.value;

			Validate_Wheel_Settings('imported', true); //Also saves settings and updates <option>'s innerHTML...
		}

		localStorage.setItem(LS_CURRENT_WHEEL, new_index);
		Enable_Disable_Undo_Clear();

		Setup_and_Build("init");
		Set_Modal_Mode(false, $IMPORT_CONTAINER);
		
		var msg = MSGS.import_complete;
		if (max_wheels_before > $MAX_WHEELS.value*1) { 
			msg += MSGS.import_adjust_max;
			msg += MSGS.before_import + max_wheels_before + '<br>';
			msg += MSGS.after_import  + $MAX_WHEELS.value + '<br>';
		}

		$PRIOR_FOCUS = $CURRENT_WHEEL;
		Show_Message('', msg);
		
	});//end $PERFORM_IMPORT click

}//end Assign_Events() //******************************************************/




function Init_Display_NR_SX(display_options, imported) { //********************/

	Load_Settings(DEFAULT_OPTIONS, true); //first load defaults

	Load_Settings(display_options, imported);

	if (imported) { Save_Settings("display"); }
	else {
		//Reduce the visually jarring, if brief,  jumping around of page elements during page load.
		$CONTAINER.style['visibility'] = "visible";
		$CONTAINER.style.opacity = '1';
	}

	Init_Show_Hide_Options();

	//Temp <select> lists until any saved settings loaded. NR & SX will then be rebuilt in Setup_Type_and_Build().
	Init_NR_SX();

	Enable_Disable_FTL();

	//Init with all options. Setup_Type_and_Build() will change to COMMON if needed.
	$HUB_AUTO_ANGLES.innerHTML = HUB_AUTO_ANGLES_OPTS_CUSTOM;
	$AUTO_ROT_OPTS.innerHTML = AUTO_ROT_OPTS_CUSTOM;

	Reset_OPTIONS_SPOKES();
	Reset_OPTIONS_RIM_ETC();
}//end Init_Display_NR_SX() //*************************************************/




function Add_Contact_Info() { //***********************************************/
	//A probably futile attempt to protect contact info from bots.  Uses html, css, & js obfuscation.
	var $ADMIN_LINK = E_('admin_link');
	var issues = 'mai' + 'lto' + ':d' + 'spokecalculat' + 'or.ne' + 't';
	issues = issues.replace(":d", ":d@");
	$ADMIN_LINK.innerHTML = "d&#064;" + "spokecalculat" + "or&#046;ne" + "<span style='display:none;'>XXXXX</span>" + "t";
	$ADMIN_LINK.addEventListener("mouseover", function(){ this.href = issues; });
	$ADMIN_LINK.addEventListener("focus"    , function(){ this.href = issues; });
}//end Add_Contact_Info() //***************************************************/




function Init() { //***********************************************************/

	Assign_Events();
	
	$COPY_LICENSE.innerHTML += $LICENSE.innerHTML;

	//These options are not saved. Always load page with Wheel Settings visable & enabled.
	$DISPLAY_SETTINGS.style.display = "none";
	$LIST_CONTAINER.style.display = "none";

	Load_DEFAULT_VALUES_Spokes();
	Load_DEFAULT_VALUES_Rim_etc();
	Load_DEFAULT_VALUES_Scale_Rotate();

	$FW .value = DEFAULT_VALUES.FW;
	$SDB.value = DEFAULT_VALUES.SDB;

	Init_Display_NR_SX(LS_DISPLAY_OPTIONS);

	Build_Load_Sample_List();

	Build_Select_Wheel_List();

	Enable_Disable_Undo_Clear();

	var saved_settings_found = Load_Settings(LS_VALUES_PREFIX + $CURRENT_WHEEL.value);

	if (saved_settings_found) { Validate_Wheel_Settings(); }

	Setup_and_Build("init");

	$WHEEL_NAME.current = $WHEEL_NAME.value;

	Add_Contact_Info();

	//##### Enable disclaimer msg on first load & resets?
	$ACCEPT_MSG.ENABLED = false; //##### true; //#####
	//##### Check_if_Disclaimer_Accepted($ERD); //(option) is where to set focus after accepted.
	$ERD.focus();
	$PRIOR_FOCUS = D.activeElement;

	$SC2_VERSION.innerHTML = VERSION;
}//end Init() //***************************************************************/




window.addEventListener("load", function() { Init() } );
//*****************************************************************************/
})();</script>
